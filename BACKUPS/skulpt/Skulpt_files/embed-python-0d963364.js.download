!function(a,b,c,d){"use strict";function e(a){return("string"==typeof a||a instanceof String)&&(a=a.replace(/^['\\/"]+|(;\s?})+|['\\/"]+$/g,"")),a}var f=function(b){for(var c=b.length,d=a("head");c--;)0===d.has("."+b[c]).length&&d.append('<meta class="'+b[c]+'" />')};f(["foundation-mq-small","foundation-mq-small-only","foundation-mq-medium","foundation-mq-medium-only","foundation-mq-large","foundation-mq-large-only","foundation-mq-xlarge","foundation-mq-xlarge-only","foundation-mq-xxlarge","foundation-data-attribute-namespace"]),a(function(){"undefined"!=typeof FastClick&&"undefined"!=typeof c.body&&FastClick.attach(c.body)});var g=function(b,d){if("string"==typeof b){if(d){var e;if(d.jquery){if(e=d[0],!e)return d}else e=d;return a(e.querySelectorAll(b))}return a(c.querySelectorAll(b))}return a(b,d)},h=function(a){var b=[];return a||b.push("data"),this.namespace.length>0&&b.push(this.namespace),b.push(this.name),b.join("-")},i=function(a){for(var b=a.split("-"),c=b.length,d=[];c--;)0!==c?d.push(b[c]):this.namespace.length>0?d.push(this.namespace,b[c]):d.push(b[c]);return d.reverse().join("-")},j=function(b,c){var d=this,e=!g(this).data(this.attr_name(!0));return g(this.scope).is("["+this.attr_name()+"]")?(g(this.scope).data(this.attr_name(!0)+"-init",a.extend({},this.settings,c||b,this.data_options(g(this.scope)))),e&&this.events(this.scope)):g("["+this.attr_name()+"]",this.scope).each(function(){var e=!g(this).data(d.attr_name(!0)+"-init");g(this).data(d.attr_name(!0)+"-init",a.extend({},d.settings,c||b,d.data_options(g(this)))),e&&d.events(this)}),"string"==typeof b?this[b].call(this,c):void 0},k=function(a,b){function c(){b(a[0])}function d(){if(this.one("load",c),/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var a=this.attr("src"),b=a.match(/\?/)?"&":"?";b+="random="+(new Date).getTime(),this.attr("src",a+b)}}return a.attr("src")?void(a[0].complete||4===a[0].readyState?c():d.call(a)):void c()};b.matchMedia=b.matchMedia||function(a){var b,c=a.documentElement,d=c.firstElementChild||c.firstChild,e=a.createElement("body"),f=a.createElement("div");return f.id="mq-test-1",f.style.cssText="position:absolute;top:-100em",e.style.background="none",e.appendChild(f),function(a){return f.innerHTML='&shy;<style media="'+a+'"> #mq-test-1 { width: 42px; }</style>',c.insertBefore(e,d),b=42===f.offsetWidth,c.removeChild(e),{matches:b,media:a}}}(c),function(a){function c(){d&&(g(c),i&&jQuery.fx.tick())}for(var d,e=0,f=["webkit","moz"],g=b.requestAnimationFrame,h=b.cancelAnimationFrame,i="undefined"!=typeof jQuery.fx;e<f.length&&!g;e++)g=b[f[e]+"RequestAnimationFrame"],h=h||b[f[e]+"CancelAnimationFrame"]||b[f[e]+"CancelRequestAnimationFrame"];g?(b.requestAnimationFrame=g,b.cancelAnimationFrame=h,i&&(jQuery.fx.timer=function(a){a()&&jQuery.timers.push(a)&&!d&&(d=!0,c())},jQuery.fx.stop=function(){d=!1})):(b.requestAnimationFrame=function(a){var c=(new Date).getTime(),d=Math.max(0,16-(c-e)),f=b.setTimeout(function(){a(c+d)},d);return e=c+d,f},b.cancelAnimationFrame=function(a){clearTimeout(a)})}(jQuery),b.Foundation={name:"Foundation",version:"5.5.0",media_queries:{small:g(".foundation-mq-small").css("font-family").replace(/^[\/\\'"]+|(;\s?})+|[\/\\'"]+$/g,""),"small-only":g(".foundation-mq-small-only").css("font-family").replace(/^[\/\\'"]+|(;\s?})+|[\/\\'"]+$/g,""),medium:g(".foundation-mq-medium").css("font-family").replace(/^[\/\\'"]+|(;\s?})+|[\/\\'"]+$/g,""),"medium-only":g(".foundation-mq-medium-only").css("font-family").replace(/^[\/\\'"]+|(;\s?})+|[\/\\'"]+$/g,""),large:g(".foundation-mq-large").css("font-family").replace(/^[\/\\'"]+|(;\s?})+|[\/\\'"]+$/g,""),"large-only":g(".foundation-mq-large-only").css("font-family").replace(/^[\/\\'"]+|(;\s?})+|[\/\\'"]+$/g,""),xlarge:g(".foundation-mq-xlarge").css("font-family").replace(/^[\/\\'"]+|(;\s?})+|[\/\\'"]+$/g,""),"xlarge-only":g(".foundation-mq-xlarge-only").css("font-family").replace(/^[\/\\'"]+|(;\s?})+|[\/\\'"]+$/g,""),xxlarge:g(".foundation-mq-xxlarge").css("font-family").replace(/^[\/\\'"]+|(;\s?})+|[\/\\'"]+$/g,"")},stylesheet:a("<style></style>").appendTo("head")[0].sheet,global:{namespace:d},init:function(a,c,d,e,f){var h=[a,d,e,f],i=[];if(this.rtl=/rtl/i.test(g("html").attr("dir")),this.scope=a||this.scope,this.set_namespace(),c&&"string"==typeof c&&!/reflow/i.test(c))this.libs.hasOwnProperty(c)&&i.push(this.init_lib(c,h));else for(var j in this.libs)i.push(this.init_lib(j,c));return g(b).load(function(){g(b).trigger("resize.fndtn.clearing").trigger("resize.fndtn.dropdown").trigger("resize.fndtn.equalizer").trigger("resize.fndtn.interchange").trigger("resize.fndtn.joyride").trigger("resize.fndtn.magellan").trigger("resize.fndtn.topbar").trigger("resize.fndtn.slider")}),a},init_lib:function(b,c){return this.libs.hasOwnProperty(b)?(this.patch(this.libs[b]),c&&c.hasOwnProperty(b)?("undefined"!=typeof this.libs[b].settings?a.extend(!0,this.libs[b].settings,c[b]):"undefined"!=typeof this.libs[b].defaults&&a.extend(!0,this.libs[b].defaults,c[b]),this.libs[b].init.apply(this.libs[b],[this.scope,c[b]])):(c=c instanceof Array?c:new Array(c),this.libs[b].init.apply(this.libs[b],c))):function(){}},patch:function(a){a.scope=this.scope,a.namespace=this.global.namespace,a.rtl=this.rtl,a.data_options=this.utils.data_options,a.attr_name=h,a.add_namespace=i,a.bindings=j,a.S=this.utils.S},inherit:function(a,b){for(var c=b.split(" "),d=c.length;d--;)this.utils.hasOwnProperty(c[d])&&(a[c[d]]=this.utils[c[d]])},set_namespace:function(){var b=this.global.namespace===d?a(".foundation-data-attribute-namespace").css("font-family"):this.global.namespace;this.global.namespace=b===d||/false/i.test(b)?"":b},libs:{},utils:{S:g,throttle:function(a,b){var c=null;return function(){var d=this,e=arguments;null==c&&(c=setTimeout(function(){a.apply(d,e),c=null},b))}},debounce:function(a,b,c){var d,e;return function(){var f=this,g=arguments,h=function(){d=null,c||(e=a.apply(f,g))},i=c&&!d;return clearTimeout(d),d=setTimeout(h,b),i&&(e=a.apply(f,g)),e}},data_options:function(b,c){function d(a){return!isNaN(a-0)&&null!==a&&""!==a&&a!==!1&&a!==!0}function e(b){return"string"==typeof b?a.trim(b):b}c=c||"options";var f,g,h,i={},j=function(a){var b=Foundation.global.namespace;return b.length>0?a.data(b+"-"+c):a.data(c)},k=j(b);if("object"==typeof k)return k;for(h=(k||":").split(";"),f=h.length;f--;)g=h[f].split(":"),g=[g[0],g.slice(1).join(":")],/true/i.test(g[1])&&(g[1]=!0),/false/i.test(g[1])&&(g[1]=!1),d(g[1])&&(-1===g[1].indexOf(".")?g[1]=parseInt(g[1],10):g[1]=parseFloat(g[1])),2===g.length&&g[0].length>0&&(i[e(g[0])]=e(g[1]));return i},register_media:function(b,c){Foundation.media_queries[b]===d&&(a("head").append('<meta class="'+c+'"/>'),Foundation.media_queries[b]=e(a("."+c).css("font-family")))},add_custom_rule:function(a,b){if(b===d&&Foundation.stylesheet)Foundation.stylesheet.insertRule(a,Foundation.stylesheet.cssRules.length);else{var c=Foundation.media_queries[b];c!==d&&Foundation.stylesheet.insertRule("@media "+Foundation.media_queries[b]+"{ "+a+" }")}},image_loaded:function(a,b){var c=this,d=a.length;0===d&&b(a),a.each(function(){k(c.S(this),function(){d-=1,0===d&&b(a)})})},random_str:function(){return this.fidx||(this.fidx=0),this.prefix=this.prefix||[this.name||"F",(+new Date).toString(36)].join("-"),this.prefix+(this.fidx++).toString(36)},match:function(a){return b.matchMedia(a).matches},is_small_up:function(){return this.match(Foundation.media_queries.small)},is_medium_up:function(){return this.match(Foundation.media_queries.medium)},is_large_up:function(){return this.match(Foundation.media_queries.large)},is_xlarge_up:function(){return this.match(Foundation.media_queries.xlarge)},is_xxlarge_up:function(){return this.match(Foundation.media_queries.xxlarge)},is_small_only:function(){return!(this.is_medium_up()||this.is_large_up()||this.is_xlarge_up()||this.is_xxlarge_up())},is_medium_only:function(){return this.is_medium_up()&&!this.is_large_up()&&!this.is_xlarge_up()&&!this.is_xxlarge_up()},is_large_only:function(){return this.is_medium_up()&&this.is_large_up()&&!this.is_xlarge_up()&&!this.is_xxlarge_up()},is_xlarge_only:function(){return this.is_medium_up()&&this.is_large_up()&&this.is_xlarge_up()&&!this.is_xxlarge_up()},is_xxlarge_only:function(){return this.is_medium_up()&&this.is_large_up()&&this.is_xlarge_up()&&this.is_xxlarge_up()}}},a.fn.foundation=function(){var a=Array.prototype.slice.call(arguments,0);return this.each(function(){return Foundation.init.apply(Foundation,[this].concat(a)),this})}}(jQuery,window,window.document),function(a,b,c,d){"use strict";Foundation.libs.accordion={name:"accordion",version:"5.5.0",settings:{content_class:"content",active_class:"active",multi_expand:!1,toggleable:!0,callback:function(){}},init:function(a,b,c){this.bindings(b,c)},events:function(){var b=this,c=this.S;c(this.scope).off(".fndtn.accordion").on("click.fndtn.accordion","["+this.attr_name()+"] > .accordion-navigation > a",function(d){var e=c(this).closest("["+b.attr_name()+"]"),f=b.attr_name()+"="+e.attr(b.attr_name()),g=e.data(b.attr_name(!0)+"-init")||b.settings,h=c("#"+this.href.split("#")[1]),i=a("> .accordion-navigation",e),j=i.children("."+g.content_class),k=j.filter("."+g.active_class);return d.preventDefault(),e.attr(b.attr_name())&&(j=j.add("["+f+"] dd > ."+g.content_class),i=i.add("["+f+"] .accordion-navigation")),g.toggleable&&h.is(k)?(h.parent(".accordion-navigation").toggleClass(g.active_class,!1),h.toggleClass(g.active_class,!1),g.callback(h),h.triggerHandler("toggled",[e]),void e.triggerHandler("toggled",[h])):(g.multi_expand||(j.removeClass(g.active_class),i.removeClass(g.active_class)),h.addClass(g.active_class).parent().addClass(g.active_class),g.callback(h),h.triggerHandler("toggled",[e]),void e.triggerHandler("toggled",[h]))})},off:function(){},reflow:function(){}}}(jQuery,window,window.document),function(a,b,c,d){"use strict";Foundation.libs.alert={name:"alert",version:"5.5.0",settings:{callback:function(){}},init:function(a,b,c){this.bindings(b,c)},events:function(){var b=this,c=this.S;a(this.scope).off(".alert").on("click.fndtn.alert","["+this.attr_name()+"] .close",function(a){var d=c(this).closest("["+b.attr_name()+"]"),e=d.data(b.attr_name(!0)+"-init")||b.settings;a.preventDefault(),Modernizr.csstransitions?(d.addClass("alert-close"),d.on("transitionend webkitTransitionEnd oTransitionEnd",function(a){c(this).trigger("close").trigger("close.fndtn.alert").remove(),e.callback()})):d.fadeOut(300,function(){c(this).trigger("close").trigger("close.fndtn.alert").remove(),e.callback()})})},reflow:function(){}}}(jQuery,window,window.document),function(a,b,c,d){"use strict";Foundation.libs.dropdown={name:"dropdown",version:"5.5.0",settings:{active_class:"open",disabled_class:"disabled",mega_class:"mega",align:"bottom",is_hover:!1,hover_timeout:150,opened:function(){},closed:function(){}},init:function(b,c,d){Foundation.inherit(this,"throttle"),a.extend(!0,this.settings,c,d),this.bindings(c,d)},events:function(c){var d=this,e=d.S;e(this.scope).off(".dropdown").on("click.fndtn.dropdown","["+this.attr_name()+"]",function(b){var c=e(this).data(d.attr_name(!0)+"-init")||d.settings;c.is_hover&&!Modernizr.touch||(b.preventDefault(),e(this).parent("[data-reveal-id]")&&b.stopPropagation(),d.toggle(a(this)))}).on("mouseenter.fndtn.dropdown","["+this.attr_name()+"], ["+this.attr_name()+"-content]",function(a){var b,c,f=e(this);clearTimeout(d.timeout),f.data(d.data_attr())?(b=e("#"+f.data(d.data_attr())),c=f):(b=f,c=e("["+d.attr_name()+'="'+b.attr("id")+'"]'));var g=c.data(d.attr_name(!0)+"-init")||d.settings;e(a.currentTarget).data(d.data_attr())&&g.is_hover&&d.closeall.call(d),g.is_hover&&d.open.apply(d,[b,c])}).on("mouseleave.fndtn.dropdown","["+this.attr_name()+"], ["+this.attr_name()+"-content]",function(a){var b,c=e(this);if(c.data(d.data_attr()))b=c.data(d.data_attr(!0)+"-init")||d.settings;else var f=e("["+d.attr_name()+'="'+e(this).attr("id")+'"]'),b=f.data(d.attr_name(!0)+"-init")||d.settings;d.timeout=setTimeout(function(){c.data(d.data_attr())?b.is_hover&&d.close.call(d,e("#"+c.data(d.data_attr()))):b.is_hover&&d.close.call(d,c)}.bind(this),b.hover_timeout)}).on("click.fndtn.dropdown",function(b){var c=e(b.target).closest("["+d.attr_name()+"-content]"),f=c.find("a");return f.length>0&&"false"!==c.attr("aria-autoclose")&&d.close.call(d,e("["+d.attr_name()+"-content]")),e(b.target).closest("["+d.attr_name()+"]").length>0?void 0:!e(b.target).data("revealId")&&c.length>0&&(e(b.target).is("["+d.attr_name()+"-content]")||a.contains(c.first()[0],b.target))?void b.stopPropagation():void d.close.call(d,e("["+d.attr_name()+"-content]"))}).on("opened.fndtn.dropdown","["+d.attr_name()+"-content]",function(){d.settings.opened.call(this)}).on("closed.fndtn.dropdown","["+d.attr_name()+"-content]",function(){d.settings.closed.call(this)}),e(b).off(".dropdown").on("resize.fndtn.dropdown",d.throttle(function(){d.resize.call(d)},50)),this.resize()},close:function(b){var c=this;b.each(function(){var d=a("["+c.attr_name()+"="+b[0].id+"]")||a("aria-controls="+b[0].id+"]");d.attr("aria-expanded","false"),c.S(this).hasClass(c.settings.active_class)&&(c.S(this).css(Foundation.rtl?"right":"left","-99999px").attr("aria-hidden","true").removeClass(c.settings.active_class).prev("["+c.attr_name()+"]").removeClass(c.settings.active_class).removeData("target"),c.S(this).trigger("closed").trigger("closed.fndtn.dropdown",[b]))}),b.removeClass("f-open-"+this.attr_name(!0))},closeall:function(){var b=this;a.each(b.S(".f-open-"+this.attr_name(!0)),function(){b.close.call(b,b.S(this))})},open:function(a,b){this.css(a.addClass(this.settings.active_class),b),a.prev("["+this.attr_name()+"]").addClass(this.settings.active_class),a.data("target",b.get(0)).trigger("opened").trigger("opened.fndtn.dropdown",[a,b]),a.attr("aria-hidden","false"),b.attr("aria-expanded","true"),a.focus(),a.addClass("f-open-"+this.attr_name(!0))},data_attr:function(){return this.namespace.length>0?this.namespace+"-"+this.name:this.name},toggle:function(a){if(!a.hasClass(this.settings.disabled_class)){var b=this.S("#"+a.data(this.data_attr()));0!==b.length&&(this.close.call(this,this.S("["+this.attr_name()+"-content]").not(b)),b.hasClass(this.settings.active_class)?(this.close.call(this,b),b.data("target")!==a.get(0)&&this.open.call(this,b,a)):this.open.call(this,b,a))}},resize:function(){var a=this.S("["+this.attr_name()+"-content].open"),b=this.S("["+this.attr_name()+'="'+a.attr("id")+'"]');a.length&&b.length&&this.css(a,b)},css:function(a,b){var c=Math.max((b.width()-a.width())/2,8),d=b.data(this.attr_name(!0)+"-init")||this.settings;if(this.clear_idx(),this.small()){var e=this.dirs.bottom.call(a,b,d);a.attr("style","").removeClass("drop-left drop-right drop-top").css({position:"absolute",width:"95%","max-width":"none",top:e.top}),a.css(Foundation.rtl?"right":"left",c)}else this.style(a,b,d);return a},style:function(b,c,d){var e=a.extend({position:"absolute"},this.dirs[d.align].call(b,c,d));b.attr("style","").css(e)},dirs:{_base:function(a){var d=this.offsetParent(),e=d.offset(),f=a.offset();f.top-=e.top,f.left-=e.left,f.missRight=!1,f.missTop=!1,f.missLeft=!1,f.leftRightFlag=!1;var g;g=c.getElementsByClassName("row")[0]?c.getElementsByClassName("row")[0].clientWidth:b.outerWidth;var h=(b.outerWidth-g)/2,i=g;return this.hasClass("mega")||(a.offset().top<=this.outerHeight()&&(f.missTop=!0,i=b.outerWidth-h,f.leftRightFlag=!0),a.offset().left+this.outerWidth()>a.offset().left+h&&a.offset().left-h>this.outerWidth()&&(f.missRight=!0,f.missLeft=!1),a.offset().left-this.outerWidth()<=0&&(f.missLeft=!0,f.missRight=!1)),f},top:function(a,b){var c=Foundation.libs.dropdown,d=c.dirs._base.call(this,a);return this.addClass("drop-top"),1==d.missTop&&(d.top=d.top+a.outerHeight()+this.outerHeight(),this.removeClass("drop-top")),1==d.missRight&&(d.left=d.left-this.outerWidth()+a.outerWidth()),(a.outerWidth()<this.outerWidth()||c.small()||this.hasClass(b.mega_menu))&&c.adjust_pip(this,a,b,d),Foundation.rtl?{left:d.left-this.outerWidth()+a.outerWidth(),top:d.top-this.outerHeight()}:{left:d.left,top:d.top-this.outerHeight()}},bottom:function(a,b){var c=Foundation.libs.dropdown,d=c.dirs._base.call(this,a);return 1==d.missRight&&(d.left=d.left-this.outerWidth()+a.outerWidth()),(a.outerWidth()<this.outerWidth()||c.small()||this.hasClass(b.mega_menu))&&c.adjust_pip(this,a,b,d),c.rtl?{left:d.left-this.outerWidth()+a.outerWidth(),top:d.top+a.outerHeight()}:{left:d.left,top:d.top+a.outerHeight()}},left:function(a,b){var c=Foundation.libs.dropdown.dirs._base.call(this,a);return this.addClass("drop-left"),1==c.missLeft&&(c.left=c.left+this.outerWidth(),c.top=c.top+a.outerHeight(),this.removeClass("drop-left")),{left:c.left-this.outerWidth(),top:c.top}},right:function(a,b){var c=Foundation.libs.dropdown.dirs._base.call(this,a);this.addClass("drop-right"),1==c.missRight?(c.left=c.left-this.outerWidth(),c.top=c.top+a.outerHeight(),this.removeClass("drop-right")):c.triggeredRight=!0;var d=Foundation.libs.dropdown;return(a.outerWidth()<this.outerWidth()||d.small()||this.hasClass(b.mega_menu))&&d.adjust_pip(this,a,b,c),{left:c.left+a.outerWidth(),top:c.top}}},adjust_pip:function(a,b,c,d){var e=Foundation.stylesheet,f=8;a.hasClass(c.mega_class)?f=d.left+b.outerWidth()/2-8:this.small()&&(f+=d.left-8),this.rule_idx=e.cssRules.length;var g=".f-dropdown.open:before",h=".f-dropdown.open:after",i="left: "+f+"px;",j="left: "+(f-1)+"px;";1==d.missRight&&(f=a.outerWidth()-23,g=".f-dropdown.open:before",h=".f-dropdown.open:after",i="left: "+f+"px;",j="left: "+(f-1)+"px;"),1==d.triggeredRight&&(g=".f-dropdown.open:before",h=".f-dropdown.open:after",i="left:-12px;",j="left:-14px;"),e.insertRule?(e.insertRule([g,"{",i,"}"].join(" "),this.rule_idx),e.insertRule([h,"{",j,"}"].join(" "),this.rule_idx+1)):(e.addRule(g,i,this.rule_idx),e.addRule(h,j,this.rule_idx+1))},clear_idx:function(){var a=Foundation.stylesheet;"undefined"!=typeof this.rule_idx&&(a.deleteRule(this.rule_idx),a.deleteRule(this.rule_idx),delete this.rule_idx)},small:function(){return matchMedia(Foundation.media_queries.small).matches&&!matchMedia(Foundation.media_queries.medium).matches},off:function(){this.S(this.scope).off(".fndtn.dropdown"),this.S("html, body").off(".fndtn.dropdown"),this.S(b).off(".fndtn.dropdown"),this.S("[data-dropdown-content]").off(".fndtn.dropdown")},reflow:function(){}}}(jQuery,window,window.document),function(a,b,c,d){"use strict";Foundation.libs.offcanvas={name:"offcanvas",version:"5.5.0",settings:{open_method:"move",close_on_click:!1},init:function(a,b,c){this.bindings(b,c)},events:function(){var b=this,c=b.S,d="",e="",f="";"move"===this.settings.open_method?(d="move-",e="right",f="left"):"overlap_single"===this.settings.open_method?(d="offcanvas-overlap-",e="right",f="left"):"overlap"===this.settings.open_method&&(d="offcanvas-overlap"),c(this.scope).off(".offcanvas").on("click.fndtn.offcanvas",".left-off-canvas-toggle",function(f){b.click_toggle_class(f,d+e),"overlap"!==b.settings.open_method&&c(".left-submenu").removeClass(d+e),a(".left-off-canvas-toggle").attr("aria-expanded","true")}).on("click.fndtn.offcanvas",".left-off-canvas-menu a",function(f){var g=b.get_settings(f),h=c(this).parent();!g.close_on_click||h.hasClass("has-submenu")||h.hasClass("back")?c(this).parent().hasClass("has-submenu")?(f.preventDefault(),c(this).siblings(".left-submenu").toggleClass(d+e)):h.hasClass("back")&&(f.preventDefault(),h.parent().removeClass(d+e)):(b.hide.call(b,d+e,b.get_wrapper(f)),h.parent().removeClass(d+e)),a(".left-off-canvas-toggle").attr("aria-expanded","true")}).on("click.fndtn.offcanvas",".right-off-canvas-toggle",function(e){b.click_toggle_class(e,d+f),"overlap"!==b.settings.open_method&&c(".right-submenu").removeClass(d+f),a(".right-off-canvas-toggle").attr("aria-expanded","true")}).on("click.fndtn.offcanvas",".right-off-canvas-menu a",function(e){var g=b.get_settings(e),h=c(this).parent();!g.close_on_click||h.hasClass("has-submenu")||h.hasClass("back")?c(this).parent().hasClass("has-submenu")?(e.preventDefault(),c(this).siblings(".right-submenu").toggleClass(d+f)):h.hasClass("back")&&(e.preventDefault(),h.parent().removeClass(d+f)):(b.hide.call(b,d+f,b.get_wrapper(e)),h.parent().removeClass(d+f)),a(".right-off-canvas-toggle").attr("aria-expanded","true")}).on("click.fndtn.offcanvas",".exit-off-canvas",function(g){b.click_remove_class(g,d+f),c(".right-submenu").removeClass(d+f),e&&(b.click_remove_class(g,d+e),c(".left-submenu").removeClass(d+f)),a(".right-off-canvas-toggle").attr("aria-expanded","true")}).on("click.fndtn.offcanvas",".exit-off-canvas",function(c){b.click_remove_class(c,d+f),a(".left-off-canvas-toggle").attr("aria-expanded","false"),e&&(b.click_remove_class(c,d+e),a(".right-off-canvas-toggle").attr("aria-expanded","false"))})},toggle:function(a,b){b=b||this.get_wrapper(),b.is("."+a)?this.hide(a,b):this.show(a,b)},show:function(a,b){b=b||this.get_wrapper(),b.trigger("open").trigger("open.fndtn.offcanvas"),b.addClass(a)},hide:function(a,b){b=b||this.get_wrapper(),b.trigger("close").trigger("close.fndtn.offcanvas"),b.removeClass(a)},click_toggle_class:function(a,b){a.preventDefault();var c=this.get_wrapper(a);this.toggle(b,c)},click_remove_class:function(a,b){a.preventDefault();var c=this.get_wrapper(a);this.hide(b,c)},get_settings:function(a){var b=this.S(a.target).closest("["+this.attr_name()+"]");return b.data(this.attr_name(!0)+"-init")||this.settings},get_wrapper:function(a){var b=this.S(a?a.target:this.scope).closest(".off-canvas-wrap");return 0===b.length&&(b=this.S(".off-canvas-wrap")),b},reflow:function(){}}}(jQuery,window,window.document),function(a,b,c,d){"use strict";function e(a){var b=/fade/i.test(a),c=/pop/i.test(a);return{animate:b||c,pop:c,fade:b}}Foundation.libs.reveal={name:"reveal",version:"5.5.0",locked:!1,settings:{animation:"fadeAndPop",animation_speed:250,close_on_background_click:!0,close_on_esc:!0,dismiss_modal_class:"close-reveal-modal",bg_class:"reveal-modal-bg",bg_root_element:"body",root_element:"body",open:function(){},opened:function(){},close:function(){},closed:function(){},bg:a(".reveal-modal-bg"),css:{open:{opacity:0,visibility:"visible",display:"block"},close:{opacity:1,visibility:"hidden",display:"none"}}},init:function(b,c,d){a.extend(!0,this.settings,c,d),this.bindings(c,d)},events:function(a){var b=this,d=b.S;return d(this.scope).off(".reveal").on("click.fndtn.reveal","["+this.add_namespace("data-reveal-id")+"]:not([disabled])",function(a){if(a.preventDefault(),!b.locked){var c=d(this),e=c.data(b.data_attr("reveal-ajax"));if(b.locked=!0,"undefined"==typeof e)b.open.call(b,c);else{var f=e===!0?c.attr("href"):e;b.open.call(b,c,{url:f})}}}),d(c).on("click.fndtn.reveal",this.close_targets(),function(a){if(a.preventDefault(),!b.locked){var c=d("["+b.attr_name()+"].open").data(b.attr_name(!0)+"-init")||b.settings,e=d(a.target)[0]===d("."+c.bg_class)[0];if(e){if(!c.close_on_background_click)return;a.stopPropagation()}b.locked=!0,b.close.call(b,e?d("["+b.attr_name()+"].open"):d(this).closest("["+b.attr_name()+"]"))}}),d("["+b.attr_name()+"]",this.scope).length>0?d(this.scope).on("open.fndtn.reveal",this.settings.open).on("opened.fndtn.reveal",this.settings.opened).on("opened.fndtn.reveal",this.open_video).on("close.fndtn.reveal",this.settings.close).on("closed.fndtn.reveal",this.settings.closed).on("closed.fndtn.reveal",this.close_video):d(this.scope).on("open.fndtn.reveal","["+b.attr_name()+"]",this.settings.open).on("opened.fndtn.reveal","["+b.attr_name()+"]",this.settings.opened).on("opened.fndtn.reveal","["+b.attr_name()+"]",this.open_video).on("close.fndtn.reveal","["+b.attr_name()+"]",this.settings.close).on("closed.fndtn.reveal","["+b.attr_name()+"]",this.settings.closed).on("closed.fndtn.reveal","["+b.attr_name()+"]",this.close_video),!0},key_up_on:function(a){var b=this;return b.S("body").off("keyup.fndtn.reveal").on("keyup.fndtn.reveal",function(a){var c=b.S("["+b.attr_name()+"].open"),d=c.data(b.attr_name(!0)+"-init")||b.settings;d&&27===a.which&&d.close_on_esc&&!b.locked&&b.close.call(b,c)}),!0},key_up_off:function(a){return this.S("body").off("keyup.fndtn.reveal"),!0},open:function(c,d){var e,f=this;c?"undefined"!=typeof c.selector?e=f.S("#"+c.data(f.data_attr("reveal-id"))).first():(e=f.S(this.scope),d=c):e=f.S(this.scope);var g=e.data(f.attr_name(!0)+"-init");if(g=g||this.settings,e.hasClass("open")&&c.attr("data-reveal-id")==e.attr("id"))return f.close(e);if(!e.hasClass("open")){var h=f.S("["+f.attr_name()+"].open");if("undefined"==typeof e.data("css-top")&&e.data("css-top",parseInt(e.css("top"),10)).data("offset",this.cache_offset(e)),this.key_up_on(e),e.trigger("open").trigger("open.fndtn.reveal"),h.length<1&&this.toggle_bg(e,!0),"string"==typeof d&&(d={url:d}),"undefined"!=typeof d&&d.url){var i="undefined"!=typeof d.success?d.success:null;a.extend(d,{success:function(b,c,d){if(a.isFunction(i)){var j=i(b,c,d);"string"==typeof j&&(b=j)}e.html(b),f.S(e).foundation("section","reflow"),f.S(e).children().foundation(),h.length>0&&f.hide(h,g.css.close),f.show(e,g.css.open)}}),a.ajax(d)}else h.length>0&&this.hide(h,g.css.close),this.show(e,g.css.open)}f.S(b).trigger("resize")},close:function(a){var a=a&&a.length?a:this.S(this.scope),b=this.S("["+this.attr_name()+"].open"),c=a.data(this.attr_name(!0)+"-init")||this.settings;b.length>0&&(this.locked=!0,this.key_up_off(a),a.trigger("close").trigger("close.fndtn.reveal"),this.toggle_bg(a,!1),this.hide(b,c.css.close,c))},close_targets:function(){var a="."+this.settings.dismiss_modal_class;return this.settings.close_on_background_click?a+", ."+this.settings.bg_class:a},toggle_bg:function(b,c,e){var f=b.data(this.attr_name(!0)+"-init")||this.settings,g=f.bg_root_element;0===this.S("."+this.settings.bg_class).length&&(this.settings.bg=a("<div />",{"class":this.settings.bg_class}).appendTo(g).hide());var h=this.settings.bg.filter(":visible").length>0;e!=h&&((e==d?h:!e)?this.hide(this.settings.bg):this.show(this.settings.bg))},show:function(b,c){if(c){var d=b.data(this.attr_name(!0)+"-init")||this.settings,f=d.root_element;if(0===b.parent(f).length){var g=b.wrap('<div style="display: none;" />').parent();b.on("closed.fndtn.reveal.wrapped",function(){b.detach().appendTo(g),b.unwrap().unbind("closed.fndtn.reveal.wrapped")}),b.detach().appendTo(f)}var h=e(d.animation);if(h.animate||(this.locked=!1),h.pop){c.top=a(f).scrollTop()-b.data("offset")+"px";var i={top:a(f).scrollTop()+b.data("css-top")+"px",opacity:1};return setTimeout(function(){return b.css(c).animate(i,d.animation_speed,"linear",function(){this.locked=!1,b.trigger("opened").trigger("opened.fndtn.reveal")}.bind(this)).addClass("open")}.bind(this),d.animation_speed/2)}if(h.fade){c.top=a(f).scrollTop()+b.data("css-top")+"px";var i={opacity:1};return setTimeout(function(){return b.css(c).animate(i,d.animation_speed,"linear",function(){this.locked=!1,b.trigger("opened").trigger("opened.fndtn.reveal")}.bind(this)).addClass("open")}.bind(this),d.animation_speed/2)}return b.css(c).show().css({opacity:1}).addClass("open").trigger("opened").trigger("opened.fndtn.reveal")}var d=this.settings;return e(d.animation).fade?b.fadeIn(d.animation_speed/2):(this.locked=!1,b.show())},hide:function(b,c){if(c){var d=b.data(this.attr_name(!0)+"-init")||this.settings,f=d.root_element,g=e(d.animation);if(g.animate||(this.locked=!1),g.pop){var h={top:-a(f).scrollTop()-b.data("offset")+"px",opacity:0};return setTimeout(function(){return b.animate(h,d.animation_speed,"linear",function(){this.locked=!1,b.css(c).trigger("closed").trigger("closed.fndtn.reveal")}.bind(this)).removeClass("open")}.bind(this),d.animation_speed/2)}if(g.fade){var h={opacity:0};return setTimeout(function(){return b.animate(h,d.animation_speed,"linear",function(){this.locked=!1,b.css(c).trigger("closed").trigger("closed.fndtn.reveal")}.bind(this)).removeClass("open")}.bind(this),d.animation_speed/2)}return b.hide().css(c).removeClass("open").trigger("closed").trigger("closed.fndtn.reveal")}var d=this.settings;return e(d.animation).fade?b.fadeOut(d.animation_speed/2):b.hide()},close_video:function(b){var c=a(".flex-video",b.target),d=a("iframe",c);d.length>0&&(d.attr("data-src",d[0].src),d.attr("src",d.attr("src")),c.hide())},open_video:function(b){var c=a(".flex-video",b.target),e=c.find("iframe");if(e.length>0){var f=e.attr("data-src");if("string"==typeof f)e[0].src=e.attr("data-src");else{var g=e[0].src;e[0].src=d,e[0].src=g}c.show()}},data_attr:function(a){return this.namespace.length>0?this.namespace+"-"+a:a},cache_offset:function(a){var b=a.show().height()+parseInt(a.css("top"),10);return a.hide(),b},off:function(){a(this.scope).off(".fndtn.reveal")},reflow:function(){}}}(jQuery,window,window.document),function(a,b,c,d){"use strict";Foundation.libs.tooltip={name:"tooltip",version:"5.5.0",settings:{additional_inheritable_classes:[],tooltip_class:".tooltip",append_to:"body",touch_close_text:"Tap To Close",disable_for_touch:!1,hover_delay:200,show_on:"all",tip_template:function(a,b){return'<span data-selector="'+a+'" id="'+a+'" class="'+Foundation.libs.tooltip.settings.tooltip_class.substring(1)+'" role="tooltip">'+b+'<span class="nub"></span></span>'}},cache:{},init:function(a,b,c){Foundation.inherit(this,"random_str"),this.bindings(b,c)},should_show:function(b,c){var d=a.extend({},this.settings,this.data_options(b));return"all"===d.show_on?!0:this.small()&&"small"===d.show_on?!0:this.medium()&&"medium"===d.show_on?!0:!(!this.large()||"large"!==d.show_on)},medium:function(){return matchMedia(Foundation.media_queries.medium).matches},large:function(){return matchMedia(Foundation.media_queries.large).matches},events:function(b){var c=this,d=c.S;c.create(this.S(b)),a(this.scope).off(".tooltip").on("mouseenter.fndtn.tooltip mouseleave.fndtn.tooltip touchstart.fndtn.tooltip MSPointerDown.fndtn.tooltip","["+this.attr_name()+"]",function(b){var e=d(this),f=a.extend({},c.settings,c.data_options(e)),g=!1;if(Modernizr.touch&&/touchstart|MSPointerDown/i.test(b.type)&&d(b.target).is("a"))return!1;if(/mouse/i.test(b.type)&&c.ie_touch(b))return!1;if(e.hasClass("open"))Modernizr.touch&&/touchstart|MSPointerDown/i.test(b.type)&&b.preventDefault(),c.hide(e);else{if(f.disable_for_touch&&Modernizr.touch&&/touchstart|MSPointerDown/i.test(b.type))return;!f.disable_for_touch&&Modernizr.touch&&/touchstart|MSPointerDown/i.test(b.type)&&(b.preventDefault(),d(f.tooltip_class+".open").hide(),g=!0),/enter|over/i.test(b.type)?this.timer=setTimeout(function(){c.showTip(e)}.bind(this),c.settings.hover_delay):"mouseout"===b.type||"mouseleave"===b.type?(clearTimeout(this.timer),c.hide(e)):c.showTip(e)}}).on("mouseleave.fndtn.tooltip touchstart.fndtn.tooltip MSPointerDown.fndtn.tooltip","["+this.attr_name()+"].open",function(b){return/mouse/i.test(b.type)&&c.ie_touch(b)?!1:void("touch"==a(this).data("tooltip-open-event-type")&&"mouseleave"==b.type||("mouse"==a(this).data("tooltip-open-event-type")&&/MSPointerDown|touchstart/i.test(b.type)?c.convert_to_touch(a(this)):c.hide(a(this))))}).on("DOMNodeRemoved DOMAttrModified","["+this.attr_name()+"]:not(a)",function(a){c.hide(d(this))})},ie_touch:function(a){return!1},showTip:function(a){var b=this.getTip(a);return this.should_show(a,b)?this.show(a):void 0},getTip:function(b){var c=this.selector(b),d=a.extend({},this.settings,this.data_options(b)),e=null;return c&&(e=this.S('span[data-selector="'+c+'"]'+d.tooltip_class)),"object"==typeof e?e:!1},selector:function(a){var b=a.attr("id"),c=a.attr(this.attr_name())||a.attr("data-selector");return(b&&b.length<1||!b)&&"string"!=typeof c&&(c=this.random_str(6),a.attr("data-selector",c).attr("aria-describedby",c)),b&&b.length>0?b:c},create:function(c){var d=this,e=a.extend({},this.settings,this.data_options(c)),f=this.settings.tip_template;"string"==typeof e.tip_template&&b.hasOwnProperty(e.tip_template)&&(f=b[e.tip_template]);var g=a(f(this.selector(c),a("<div></div>").html(c.attr("title")).html())),h=this.inheritable_classes(c);g.addClass(h).appendTo(e.append_to),Modernizr.touch&&(g.append('<span class="tap-to-close">'+e.touch_close_text+"</span>"),
g.on("touchstart.fndtn.tooltip MSPointerDown.fndtn.tooltip",function(a){d.hide(c)})),c.removeAttr("title").attr("title","")},reposition:function(b,c,d){var e,f,g,h,i;if(c.css("visibility","hidden").show(),e=b.data("width"),f=c.children(".nub"),g=f.outerHeight(),h=f.outerHeight(),this.small()?c.css({width:"100%"}):c.css({width:e?e:"auto"}),i=function(a,b,c,d,e,f){return a.css({top:b?b:"auto",bottom:d?d:"auto",left:e?e:"auto",right:c?c:"auto"}).end()},i(c,b.offset().top+b.outerHeight()+10,"auto","auto",b.offset().left),this.small())i(c,b.offset().top+b.outerHeight()+10,"auto","auto",12.5,a(this.scope).width()),c.addClass("tip-override"),i(f,-g,"auto","auto",b.offset().left);else{var j=b.offset().left;Foundation.rtl&&(f.addClass("rtl"),j=b.offset().left+b.outerWidth()-c.outerWidth()),i(c,b.offset().top+b.outerHeight()+10,"auto","auto",j),c.removeClass("tip-override"),d&&d.indexOf("tip-top")>-1?(Foundation.rtl&&f.addClass("rtl"),i(c,b.offset().top-c.outerHeight(),"auto","auto",j).removeClass("tip-override")):d&&d.indexOf("tip-left")>-1?(i(c,b.offset().top+b.outerHeight()/2-c.outerHeight()/2,"auto","auto",b.offset().left-c.outerWidth()-g).removeClass("tip-override"),f.removeClass("rtl")):d&&d.indexOf("tip-right")>-1&&(i(c,b.offset().top+b.outerHeight()/2-c.outerHeight()/2,"auto","auto",b.offset().left+b.outerWidth()+g).removeClass("tip-override"),f.removeClass("rtl"))}c.css("visibility","visible").hide()},small:function(){return matchMedia(Foundation.media_queries.small).matches&&!matchMedia(Foundation.media_queries.medium).matches},inheritable_classes:function(b){var c=a.extend({},this.settings,this.data_options(b)),d=["tip-top","tip-left","tip-bottom","tip-right","radius","round"].concat(c.additional_inheritable_classes),e=b.attr("class"),f=e?a.map(e.split(" "),function(b,c){return-1!==a.inArray(b,d)?b:void 0}).join(" "):"";return a.trim(f)},convert_to_touch:function(b){var c=this,d=c.getTip(b),e=a.extend({},c.settings,c.data_options(b));0===d.find(".tap-to-close").length&&(d.append('<span class="tap-to-close">'+e.touch_close_text+"</span>"),d.on("click.fndtn.tooltip.tapclose touchstart.fndtn.tooltip.tapclose MSPointerDown.fndtn.tooltip.tapclose",function(a){c.hide(b)})),b.data("tooltip-open-event-type","touch")},show:function(a){var b=this.getTip(a);"touch"==a.data("tooltip-open-event-type")&&this.convert_to_touch(a),this.reposition(a,b,a.attr("class")),a.addClass("open"),b.fadeIn(150)},hide:function(a){var b=this.getTip(a);b.fadeOut(150,function(){b.find(".tap-to-close").remove(),b.off("click.fndtn.tooltip.tapclose MSPointerDown.fndtn.tapclose"),a.removeClass("open")})},off:function(){var b=this;this.S(this.scope).off(".fndtn.tooltip"),this.S(this.settings.tooltip_class).each(function(c){a("["+b.attr_name()+"]").eq(c).attr("title",a(this).text())}).remove()},reflow:function(){}}}(jQuery,window,window.document),function(a){var b,c={},d={};try{b=localStorage}catch(e){}var f;b&&b.getItem?f=b.getItem("__browser_id__"):(f=document.cookie.match(/browser_id=(id\d+\.\d+);/),f&&(f=f[1])),f||(f="id"+Date.now()+Math.random(),b&&b.setItem&&b.setItem("__browser_id__",f)),document.cookie="browser_id="+f,a.TrinketIO={"export":function(a,b){for(var d=a.split("."),e=d.pop(),f=c,g=0;g<d.length;g++)null==f[d[g]]&&(f[d[g]]={}),f=f[d[g]];if(f[e])throw new Error("Module "+a+" has already been defined!");return f[e]=b,b},"import":function(a){for(var b=a.split("."),d=c,e=0;e<b.length;e++)if(d=d[b[e]],null==d)throw new Error("Module "+a+" could not be found!");return d},runtime:function(a,b){return arguments.length>1&&(d[a]=b),d[a]},clearRuntime:function(){d={}}}}(window),function(a){window.trinketConfig={get:function(b){return a[b]},prefix:function(b,c){if("/"!==b.charAt(0)&&(b="/"+b),"undefined"==typeof c){var d=b.match(/\/(\w+)\//);d&&(c=d[1])}return c&&a.prefixes[c]?"/"+a.prefixes[c]+b:"/"+a.cachePrefix+Date.now()+b},getUrl:function(b){return"/"!==b.charAt(0)&&(b="/"+b),a.protocol+"://"+a.apphostname+b},getClassUrl:function(b,c){var d="/"+c;return a.usersubdomains?"//"+b+"."+a.apphostname+d:"/u/"+b+"/classes"+d}}}(window.trinket.config),function(a,b){"use strict";function c(a){return new Function("o",'return "'+a.replace(/["\n\r\u2028\u2029]/g,function(a){return e[a]}).replace(/\{\{([\s\S]+?)\}\}/g,'" + (o["$1"] !== undefined ? o["$1"] : "") + "')+'";')}function d(a,b){return f[a]||(f[a]=c($("#"+a).text()),$("#"+a).remove()),f[a](b||{})}var e={"\n":"\\n",'"':'\\"',"\u2028":"\\u2028","\u2029":"\\u2029"},f={};d.compile=c,b["export"]("utils.template",d)}(window,window.TrinketIO),function(a,b){"use strict";function c(){return+new Date}function d(a){return k+a}function e(a){return l+a}function f(a,b){var d=parseInt(m.getItem(e(a)),10);return!!(d&&d<(b||c()))}function g(a,b,f){if(m&&a){var g=e(a);if(f){var h=1e3*f;m.setItem(g,c()+h)}else m.removeItem(g);return b=JSON.stringify(b),m.setItem(d(a),b)}}function h(a){if(!m||!a)return null;if(f(a))return i(a),null;var b=m.getItem(d(a));if(b)try{return JSON.parse(b)}catch(c){return null}return b}function i(a){m&&a&&(m.removeItem(e(a)),m.removeItem(d(a)))}function j(){if(m){var a,b,d=m.length,e=k,g=c();for(b=0;d>b;b++)a=m.key(b),a&&0===a.indexOf(e)&&(a=a.substr(e.length),f(a,g)&&i(a))}}var k="__trinket__",l="__trinket_expire__",m=function(){try{return a.localStorage.setItem(k,""),a.localStorage.getItem(k),a.localStorage.removeItem(k),a.localStorage}catch(b){return}}();b["export"]("utils.cache",{get:h,set:g,remove:i,purge:j})}(window,window.TrinketIO),$("document").ready(function(){function a(a){return window.location.protocol+"//"+window.location.hostname+a}function b(a){var b,d,e,f=a.split("="),g="",h=!1;if("console"!==this.getType()&&("python3"!==this.getType()&&"python"!==this.getType()||"console"!==this._queryString.runMode)||(h=!0),"code"===f[0]&&f[1])if(g=decodeURIComponent(f[1]),b=/\n----\{(\w[\w\.\-]*)\}----\n/,d=g.split(b),d.length>1){var i=this.getMainFile();if(i){for(g=[{name:i,content:d.shift()}],h&&(g[0].content=c(g[0].content)),e=0;e<d.length;e+=2)g.push({name:d[e],content:"undefined"!=typeof d[e+1]&&d[e+1].length?d[e+1]:""});g=JSON.stringify(g)}}else h&&(g=c(g));return g}function c(a){var b,c,d,e;return/^>>>/.test(a)&&(b=[],c=a.split("\n"),c.forEach(function(a){(d=/^(>>>|\.\.\.) /.exec(a))&&(e=a.substring(4,a.length),"..."===d[1]?b[b.length-1]+="\\n"+e:"undefined"!=typeof e&&e.length&&b.push(e))}),a=b.join("\n")),a}function d(a){if("undefined"==typeof a||null===a)return null;if(a instanceof Array)for(var b=0;b<a.length;b++)a[b]=d(a[b]);else if("object"==typeof a)for(var b in a)a.hasOwnProperty(b)&&(a[b]=d(a[b]));else"string"==typeof a&&(a=_.unescape(a));return a}function e(){var a={};if(window.location.search)for(var b=window.location.search.substr(1).split("&"),c=0;c<b.length;c++){var d=b[c].split("=");d[0]&&"undefined"!=typeof d[1]&&(a[d[0]]=decodeURIComponent(d[1].replace(/\+/g," ")),"true"===a[d[0]]&&(a[d[0]]=!0),"false"===a[d[0]]&&(a[d[0]]=!1))}return a}function f(a,b){b&&n.clearRuntime();var c=Object.keys(a);c.forEach(function(b){n.runtime(b,a[b])})}function g(a,b){return function(c,d,e){var f=d?m(d).serialize():m("#accountForm").serialize(),g=d||"#accountForm";c.stopPropagation(),c.preventDefault(),m.ajax({type:"POST",url:a,data:f,success:m.proxy(b.onLoginComplete,b,g),dataType:"json"}),b.sendInterfaceAnalytics(this,e)}}function h(a,b,c){var d=m.Deferred();return JSZipUtils.getBinaryContent(a,function(a,e){a?d.reject(a):(c.file(b,e,{binary:!0}),d.resolve(e))}),d}function i(c,h){var i,j=this,k=["on","off","trigger","once"];this._$=m(this);for(var o=0;o<k.length;o++){var r=k[o];this[r]=m.proxy(this._$[r],this._$)}if(this.$shareModal=m("#shareModal"),this.$shareUrl=m("#shareUrl"),this.$embedModal=m("#embedModal"),this.$embedCode=m("#embedCode"),this.$emailModal=m("#emailModal"),this.$overlay=m("#content-overlay"),this.$resetModal=m("#confirmResetModal"),this.$upgradeModal=m("#upgradeModal"),this.$draftMessage=m("#draftMessage"),this.$responsiveIndicators=m(".responsive-indicator"),m(document).on("click touchstart",".menu-button",function(a){var b=m(this).data("action"),c="trinket."+b;m(this).hasClass("disabled")||(m(this).trigger(c,{action:b,data:m(this).data("data")}),m(this).data("no-analytics")||j.sendInterfaceAnalytics(this))}),m(document).on("trinket.sharing.share",m.proxy(this.onShareClick,this)),m(document).on("trinket.sharing.embed",m.proxy(this.onEmbedClick,this)),m(document).on("trinket.sharing.email",m.proxy(this.onEmailClick,this)),m(document).on("trinket.group.post",m.proxy(this.onGroupPostClick,this)),m(document).on("trinket.group.submit",m.proxy(this.onGroupSubmitClick,this)),m(document).on("trinket.library.add",m.proxy(this.onSaveClick,this)),m(document).on("trinket.code.save",m.proxy(this.onUpdateClick,this)),m(document).on("trinket.code.fontsize",m.proxy(this.onFontSizeClick,this)),m(document).on("trinket.view.gallery",m.proxy(this.onGalleryClick,this)),m(document).on("trinket.mode.fullscreen",m.proxy(this.onFullScreenClick,this)),m(document).on("trinket.mode.download",m.proxy(this.onDownloadClick,this)),m(document).on("trinket.menu.upgrade",m.proxy(this.onUpgradeClick,this)),m(document).on("trinket.open.link",m.proxy(this.onLinkClick,this)),m(document).on("trinket.code.reset",function(){j.$resetModal.foundation("reveal","open")}),m(document).on("trinket.code.confirm-reset",m.proxy(this.onResetClick,this)),m(document).on("trinket.code.cancel-reset",function(){j.$resetModal.foundation("reveal","close")}),m(document).on("trinket.code.settings",function(){m("#settingsModal").foundation("reveal","open")}),m(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",function(a){var b=m(".trinket-content-wrapper").width(),c=m("#editor").width();c>b&&m("#editor").css("width",.5*b)}),m(document).on("trinket.sharing.social",function(b,c){var d,e,f=!1;if(l&&l.toolbox){!j.isModified()&&j._trinket.id||(d=Date.now(),e=j._trinket.code+j.getType(),m("#user").val()&&(e+=m("#user").val()),j._trinket.id&&(e+=j._trinket.id),e+=d,j._trinket.shortCode=CryptoJS.SHA1(e).toString(CryptoJS.enc.Hex).substring(0,10),f=!0);var g=j.getShareInfo(j._trinket),h=a(g.url);l.toolbox("#addthis",{},{url:h})}if(m(c.data).click(),f){var i={},k=j.serialize(),n=function(){};k.shortCode=j._trinket.shortCode,k._timestamp=d,j._trinket.id?j.fork(j._trinket,k,i,n):j.create(k,i,n)}}),m(document).on("trinket.account.login",g("/api/users/login",this)),m(document).on("trinket.account.create",g("/api/users",this)),m("#brand").click(m.proxy(this.onLogoClick,this)),m("#shareUrl").click(m.proxy(this.onShareFocus,this)),m("#embedCode").click(m.proxy(this.onEmbedFocus,this)),m("#emailModalForm").submit(m.proxy(this.onSendEmailClick,this)),m(document).on("change","input[data-trinket-settings]",m.proxy(this.settingsChange,this)),n.runtime("settingsModified",!1),s.init(),m("#version-toggle").change(function(){m(this).is(":checked")?(j.reset(j._original),j._viewingOriginal(!1),m(".menu-button").not(".allow-original").removeClass("disabled")):(m.extend(!0,j._original,j.serialize()),j.reset(j._original.original),j._viewingOriginal(!0),m(".menu-button").not(".allow-original").addClass("disabled"),m(".revert-remix").removeClass("disabled"))}),this._notification_open=!1,m("#notification-container").click(m.proxy(this.onNotificationClick,this)),l&&l.addEventListener&&l.addEventListener("addthis.menu.share",m.proxy(this.onSocialShare,this)),this._currentMode="",this._updates={},this._original=d(c),this._viewingDraft=!1,this._predraft=m.extend(!0,{},this._original),h){if(this._original_draft=d(h),["code","assets","settings"].forEach(function(a){j._original_draft[a]&&(j._original[a]=j._original_draft[a],j._viewingDraft=!0,"settings"===a&&f(j._original_draft[a]||{}))}),this._viewingDraft){var t=q("draftTextTemplate",{draftText:"Viewing Draft"});this.$draftMessage.html(t),m(".save-it").removeClass("disabled")}}else f(this._original.settings||{});if(this._queryString=e(),window.location.hash){var u=window.location.href,v=b.call(this,u.substr(u.indexOf("#")+1));v&&(this._original.code=v)}this.setTrinket(this._original);try{window.sessionStorage}catch(w){this._queryString.noStorage=!0}this._queryString.noStorage||this._queryString.outputOnly||(i=(this._trinket.id||JSON.stringify(this._trinket))+(document.referrer||document.location),this.guid=CryptoJS.MD5(i).toString(CryptoJS.enc.Hex),this._queryString.autoRestore!==!1&&window.sessionStorage&&window.sessionStorage.getItem(this.guid)?this._trinket.code=window.sessionStorage.getItem(this.guid):(this._previousSession=p.get(this.guid))&&(p.remove(this.guid),j.showRestoreMessage())),this.setUI(),"console"!==this.getType()&&"guest"!==this.getUIType()&&this._original&&this._original.id?m(this).on("trinket.code.change",_.debounce(function(){m(".save-it").removeClass("disabled"),j.updateDraft()},1e3)):m(this).on("trinket.code.change",_.debounce(function(){j.updateSessionCache()},500)),this._queryString.externalInit||this.initialize(this._trinket),this.toggleUI(this.getUIType()),m(document).keydown(function(a){j.hasOverlay&&27===a.keyCode&&j.hideAll()}),m(document).foundation({offcanvas:{close_on_click:!0},dropdown:{active_class:"open"}}),m(".left-off-canvas-toggle, .right-off-canvas-toggle").on("click",function(){}),m(document).on("close.fndtn.alert",function(a){m("body").removeClass("has-status-bar"),m(".trinket-content").css("display","none"),setTimeout(function(){m(".trinket-content").css("display","block")})}),this.setFontSize(this._queryString.font||"1em"),this.startTour(),this.parsedInstructions="",m(document).on("click","#edit-instructions-link",m.proxy(this.onEditInstructionsClick,this)),m(document).on("click","#cancel-edit-instructions",m.proxy(this.onCancelEditInstructionsClick,this)),m(document).on("click","#save-instructions",m.proxy(this.onSaveInstructionsClick,this))}function j(a,b,c,d){var e=q("statusMessageTemplate",{type:d||"success",message:a}),f=m(e);m("body").addClass("has-status-bar").append(f),b&&f.find(".yep").on("click",b),c&&f.find(".nope").on("click",c),m(document).foundation("alert","reflow")}var k,l=window.addthis,m=window.jQuery,n=window.TrinketIO,o=1728e3,p=n["import"]("utils.cache"),q=n["import"]("utils.template"),r=n["import"]("utils.selectText"),s=n["import"]("trinket.share"),t=n["import"]("trinket.roles"),u="undefined"!=typeof trinketMarkdown?trinketMarkdown({}):void 0;p.purge(),m.fn.serializeObject=function(){var a={},b=this.serializeArray();return m.each(b,function(){a[this.name]?(a[this.name].push||(a[this.name]=[a[this.name]]),a[this.name].push(this.value||"")):a[this.name]=this.value||""}),a};m.extend(i.prototype,{showRestoreMessage:function(){var a,b,c,d=this;b='Do you want to restore your last session? <a title="restore the previous session" data-action="code.restore" class="text-link yep"><i class="fa fa-check"></i>&nbsp;Restore</a>&nbsp;&nbsp;or&nbsp;&nbsp;<a class="text-link nope"><i class="fa fa-trash"></i>&nbsp;Discard</a>',c='<i class="fa fa-check-circle-o"></i>&nbsp;Your session has been restored. <a class="text-link yep"><i class="fa fa-thumbs-o-up">&nbsp;</i>Accept</a>&nbsp;&nbsp;or&nbsp;&nbsp;<a class="text-link nope"><i class="fa fa-undo"></i>&nbsp;Undo</a>',j(b,function(){m("#statusMessages .close").click(),a=d._trinket.code,d._trinket.code=d._previousSession,d.reset(d._trinket),m(d).trigger("trinket.code.change"),j(c,function(){m("#statusMessages .close").click()},function(){m("#statusMessages .close").click(),d._trinket.code=a,d.reset(d._trinket),m(d).trigger("trinket.code.change"),d.showRestoreMessage()})},function(){m("#statusMessages .close").click()})},initialize:function(a){throw new Error("initialize is not implemented")},getTour:function(){return[]},startTour:function(){this.tour=this.getTour(),this.tour&&this.tour.length&&this.nextStop()},nextStop:function(){var a,b=this,c=b.tour,d=c?c.shift():null;if(prepareStop=function(c,d){m(c).addClass("attention"),m(document).one("trinket."+d,function(){m(c).removeClass("attention"),0===--a&&b.nextStop()})},d){d instanceof Array||(d=[d]),a=d.length;for(var e=0;e<d.length;e++)prepareStop(d[e].el,d[e].event)}},onFontSizeClick:function(a,b){this.setFontSize(b&&b.data)},onFullScreenClick:function(a,b){var c=document,d=c.documentElement,e=d.requestFullscreen||d.msRequestFullscreen||d.mozRequestFullScreen||d.webkitRequestFullscreen,f=c.exitFullscreen||c.msExitFullscreen||c.mozCancelFullScreen||c.webkitExitFullscreen;try{if(!e||c.fullscreenElement||c.mozFullScreenElement||c.webkitFullscreenElement||c.msFullscreenElement){if(!f)throw new Error("fullscreen unavailable");f.call(c),this.sendInterfaceAnalytics(a.target,{data:"exit"})}else e.call(d),this.sendInterfaceAnalytics(a.target,{data:"enter"})}catch(g){if(confirm("Your browser does not support fullscreen mode. Would you like to open this trinket in a new window?")){var h=window.location.href;if(this.isModified()){var i="code="+window.encodeURIComponent(this.getValue());h=h.indexOf("#")>0?h.replace(h.substr(h.indexOf("#")+1),i):h+"#"+i}window.open(h)}}},onDownloadClick:function(a,b){var c,d,e,f=this.downloadable(),g=this,i=new JSZip,k=[];m.each(f.assets,function(a,b){c=/^data:image/.test(b.url)?b.url:m("#proxy").val()+"/"+b.url,k.push(h(c,b.name,i))}),m.when.apply(m,k).done(function(){for(d in f.files)i.file(d,f.files[d]);e=g.getTrinketIdentifier(),g._trinket&&g._trinket.name&&(e=g._trinket.name+"-"+e),e="Trinket Download-"+e+".zip",new JSZip.external.Promise(function(a,b){if(n.runtime("downloadExtra")){var c=m("#proxy").val()+"/"+n.runtime("downloadExtra");JSZipUtils.getBinaryContent(c,function(c,d){c?b(c):a(d)})}else a()}).then(function(a){return a?i.loadAsync(a):void 0}).then(function(){i.generateAsync({type:"blob"}).then(function(a){saveAs(a,e)},function(a){throw new Error("Could not generate download.")})})}).done(function(){g.sendAnalytics("Interaction",{action:"Click",label:"Download"},{name:"Snippet Download Clicked"})}).fail(function(a){j(a,function(){m("#statusMessages .close").click()},function(){m("#statusMessages .close").click()},"alert")})},onUpgradeClick:function(a,b){var c=this,d=q("upgradeTemplate",{trinket_type:c.getLabel()});this.$upgradeModal.empty().append(d).foundation("reveal","open")},onLinkClick:function(b){b.preventDefault(),window.open(a(m(b.target).data("href")))},setFontSize:function(a){m(".trinket-content-wrapper").children().css("font-size",a||"1em")},setUI:function(){this._userId=m("#user").val(),this._userId?this._trinket&&this._trinket._owner===this._userId?this._ui="owner":this._queryString.inLibrary?this._ui="library":this._ui="user":this._ui="guest"},toggleUI:function(a){var b=this,c=q(a+"MenuTemplate");m("#userMenu").empty().append(c).foundation(),"guest"===a&&(m("#login").click(g("/api/users/login",b)),m("#register").click(g("/api/users",b))),m(".ui-option").addClass("hide").filter("."+a+"-option").removeClass("hide")},getUIType:function(){return this._ui},getUserId:function(){return this._userId},hasPermission:function(){var a=Array.prototype.slice.call(arguments);return t.hasPermission.apply(this,a)},triggerChange:function(){m(document).trigger("trinket.code.change"),this.trigger("trinket.code.change")},onLoginComplete:function(a,b,c,d){var e=this;if(b&&"success"===b.status){var f=m(a+' input[name="email"]').val();window.TrinketIO["import"]("debug.sessions").onLogin(f,b.data),this._ui=b.data.id===this._trinket._owner?"owner":"user",this.toggleUI(this._ui),m(document).trigger("trinket.account.success"),"console"!==this.getType()&&"guest"!==this.getUIType()&&this._original&&this._original.id&&(m(this).off("trinket.code.change"),m(this).on("trinket.code.change",_.debounce(function(){e.updateDraft()},1e3)))}else b&&b.flash&&b.flash.validation?m(a+" .message").addClass("error").text(b.flash.validation.email||b.flash.validation.password):b&&b.flash&&b.flash.duplicates?m(a+" .message").addClass("error").text("This email is already registered, try logging in."):b&&b.message?m(a+" .message").addClass("error").text(b.message):m(a+" .message").addClass("error").text("We were unable to log you in, please try again later.")},updateSessionCache:function(){var a=this,b=a.getValue();if(b===a._original.code)try{window.sessionStorage&&window.sessionStorage.removeItem(a.guid),p.remove(a.guid)}catch(c){}else try{window.sessionStorage&&window.sessionStorage.setItem(a.guid,b),p.set(a.guid,b,o)}catch(c){}},updateDraft:function(){var a=this;"BROADCASTING"!==window.TrinketAPI._receiverBroadcastState&&a.$draftMessage.fadeOut("fast",function(){a.$draftMessage.text("Saving Draft").fadeIn("slow",function(){a._updateDraft()})})},_updateDraft:function(){var a,b=this,c=b.serialize(),d="/api/trinkets/"+b._original.id+"/draft";a={code:c.code,assets:c.assets,settings:c.settings},m.post(d,a).done(function(a){a.success&&(b._viewingDraft=!0,b.$draftMessage.fadeOut("slow",function(){var a=q("draftTextTemplate",{draftText:"Draft Saved"});b.$draftMessage.html(a).fadeIn("slow")}))})},discardDraft:function(a){var b=this,c="/api/drafts/"+b._original.id;m.ajax({url:c,method:"DELETE"}).done(function(c){c.success&&(JSON.stringify(b._trinket.settings)!==JSON.stringify(b._predraft.settings)&&(b.discardDraftSettings(),n.runtime("settingsModified",!1),b._original_draft&&f(b._predraft.settings||{},!0)),m("#confirmDiscardModal").foundation("reveal","close"),b._original=m.extend(!0,{},b._predraft),b.$draftMessage.fadeOut("fast",function(){b.$draftMessage.empty(),b._viewingDraft=!1,m(".save-it").addClass("disabled")})),a()})},discardDraftSettings:function(){},_viewingOriginal:function(a){return void 0!==a&&(this._viewingOriginalFlag=!!a,a?m("body").addClass("viewing-original"):m("body").removeClass("viewing-original")),this._viewingOriginalFlag},onSaveClick:function(){var a=Date.now();m("body").addClass("saving");var b=function(){var c=Date.now()-a;return 750>c?window.setTimeout(b,750-c):void m("body").removeClass("saving")};this._original&&this._original.id?this._viewingOriginal()?this.restore(b):this._original.original?this.save(void 0,b):this.remix(b):this.addToLibrary(b)},keys:function(){return this._keys||(this._keys={code:1,hasError:1,consoleOutput:1,assets:1})},restore:function(a){var b=this,c=q("restoreOriginalModalTemplate",{}),d=m(c);remix=this._original,original=remix.original,m("body").append(d),d.foundation("reveal","open"),d.on("close.fndtn.reveal",function(){a()}),d.find(".button").click(function(){var c,e=m(this).data("action"),f={};if("confirm"===e){d.off("close.fndtn.reveal");for(c in b.keys())f[c]=original[c];m.extend(!0,remix,f),m("#version-toggle").prop("checked",!0).change(),window.setTimeout(function(){b.save(void 0,a),b.updateSessionCache()})}else a();d.foundation("reveal","close"),d.remove()})},remix:function(a){var b=this;b._createCopy({eventAction:"Remix",eventName:"Snippet Remixed"},function(c){m("body").addClass("has-remix"),c.original=b._original,b.setTrinket(c,!0),b.reset(c),"function"==typeof a&&a()})},addToLibrary:function(a){this._createCopy({eventAction:"Copy",eventName:"Snippet Copied to Library"},function(b){var c=q("statusMessageTemplate",{type:"success",message:'A copy of this trinket has been saved for you. View or edit <a class="text-link" href="/library/trinkets/'+b.shortCode+'" target="_blank">your copy here</a>.'}),d=m(c);m("body").addClass("has-status-bar").append(d),d.parent().foundation().trigger("open.fndtn.alert"),a&&"function"==typeof a&&a(b)})},_createCopy:function(a,b){var c=this,d=c.serialize(),e={library:!0},f=c._original&&c._original.id,g=function(d){c.$overlay.addClass("hide"),b&&"function"==typeof b&&b(d),m(".save-it").addClass("disabled"),c.$draftMessage.fadeOut("slow",function(){c.$draftMessage.empty(),c._viewingDraft=!1}),c.sendAnalytics("Interaction",{action:a.action,label:"Library"},{name:a.name})};m("#statusMessages .close").click(),c.$overlay.removeClass("hide"),f&&(d._origin_id=f),"Remix"==a.eventAction&&(d._remix=!0),c._trinket.id?c.fork(c._trinket,d,e,g):c.create(d,e,g)},getTrinket:function(a,b){var c=this;return"function"==typeof a&&(b=a,a=void 0),c.isModified()||!c._trinket.id?c._trinket.id?c.fork(c._trinket,c.serialize(),a,b):c.create(c.serialize(),a,b):setTimeout(function(){b(c._trinket)})},setTrinket:function(a,b){b&&(this._original=a),this._trinket=m.extend(!0,{},a)},isModified:function(){var a=this.getValue(),b=a!==(this._trinket.code||"")||this.settingsModified();return b},settingsModified:function(){return n.runtime("settingsModified")},viewingDraft:function(){return this._viewingDraft},getType:function(){throw new Error("getType is not implemented")},getValue:function(){throw new Error("getValue is not implemented")},getMainFile:function(){return""},getShareType:function(){return m("#shareType").val()||this.getType()},serialize:function(){return{code:this.getValue()}},fork:function(a,b,c,d){var e=this,f="/api/trinkets/"+a.id+"/forks";"function"==typeof c&&(d=c,c=void 0),c&&c.library&&(f+="?library=true"),m.post(f,b).done(function(a){e.setTrinket(a.data),m("#emailToken").val(""),e.postSave().then(function(){"function"==typeof d&&d(e._trinket)})})},create:function(a,b,c){var d=this,e="/api/trinkets";"function"==typeof b&&(c=b,b=void 0),b&&b.library&&(e+="?library=true"),a.lang=this.getType(),m.post(e,a).done(function(a){d.setTrinket(a.data),m("#emailToken").val(""),d.postSave().then(function(){"function"==typeof c&&c(d._trinket)})})},save:function(a,b){var c=this,d=(new Date).getTime();a||(a=this.serialize()),c.$overlay.removeClass("hide"),m.ajax({url:"/api/trinkets/"+c._original.id,data:JSON.stringify(a),type:"PATCH",contentType:"application/json"}).done(function(e){m(".save-it").addClass("disabled"),c.$draftMessage.fadeOut("slow",function(){c.$draftMessage.empty(),c._viewingDraft=!1});var f=(new Date).getTime()-d;for(var g in a)c._trinket[g]=a[g];c._original.original&&(c._trinket.original=c._original.original),c._original=c._trinket,setTimeout(function(){c.$overlay.addClass("hide")},Math.max(0,500-f)),"function"==typeof b&&b(),c.postSave()}).fail(function(a,c,d){"function"==typeof b&&b({responseText:a.responseText,status:c,error:d})})},onResetClick:function(a){var b=this;this.$resetModal.foundation("reveal","close");var c=function(){b.setTrinket(b._original),b.reset(b._trinket),m(document).trigger("trinket.resetted")};this.viewingDraft()?this.discardDraft(c):c();try{window.sessionStorage&&window.sessionStorage.removeItem(this.guid),p.remove(this.guid)}catch(d){}this.sendAnalytics("Interaction",{action:"Click",label:"Reset"},{name:"Snippet Reset Clicked"}),m(".file-name-error").length&&m(".file-name-error").find(".close").trigger("click")},reset:function(a){},focus:function(){},onUpdateClick:function(){this.save(this.serialize())},onShareClick:function(b){var c=this,d=[],e="";b.isDefaultPrevented()||c.getTrinket(function(b){var f=c.getShareInfo(b),g=a(f.url);m("#runOptionLink").data("trinket-shortCode",b.shortCode),m("#runOptionLink").data("trinket-runMode",c.runMode),m("#displayOptionLink").data("trinket-shortCode",b.shortCode),m("#displayOptionLink").data("trinket-runMode",c.runMode),m("#displayOptionLink").val()&&d.push(m("#displayOptionLink").val()+"=true"),m("#runOptionLink").val()&&d.push("runOption="+m("#runOptionLink").val()),c.runMode&&d.push("runMode="+c.runMode),d.length&&(e="?"+d.join("&")),g=g.replace(b.shortCode,b.shortCode+e),l&&l.toolbox&&l.toolbox("#addthis",{},{url:g}),c.$shareUrl.text(g),c.$shareModal.foundation("reveal","open"),c.sendAnalytics("Navigation",{action:"View Modal",label:"share"},{name:"Snippet Modal Viewed",modalType:"share"})})},onEmailClick:function(b){var c=this;b.isDefaultPrevented()||c.getTrinket(function(b){var d=c.getShareInfo(b),e=a(d.url);c.$shareUrl.text(e),c.$emailModal.foundation("reveal","open"),c.sendAnalytics("Navigation",{action:"View Modal",label:"email"},{name:"Snippet Modal Viewed",modalType:"email"})})},getShareInfo:function(a){return{url:"/"+this.getShareType()+"/"+this.getTrinketIdentifier(a)}},onShareFocus:function(a){r.byId("shareUrl"),this.updateMetric("linkShares"),this.sendAnalytics("Shares",{action:"Focus",label:"link"},{name:"Snippet Shared",shareType:"link"})},onEmbedClick:function(b){var c=this,d=[],e="";b.isDefaultPrevented()||c.getTrinket(function(b){var f=c.getEmbedInfo(b),g=a(f.url),h='<iframe src="'+g+'" width="100%" height="'+(f.height||356)+'" frameborder="0" marginwidth="0" marginheight="0" allowfullscreen></iframe>';m("#runOptionEmbed").data("trinket-shortCode",b.shortCode),m("#runOptionEmbed").data("trinket-runMode",c.runMode),m("#displayOptionEmbed").data("trinket-shortCode",b.shortCode),m("#displayOptionEmbed").data("trinket-runMode",c.runMode),m("#displayOptionEmbed").val()&&d.push(m("#displayOptionEmbed").val()+"=true"),m("#runOptionEmbed").val()&&d.push("runOption="+m("#runOptionEmbed").val()),m("#autorunEmbedToggle").is(":checked")&&d.push("start=result"),c.runMode&&d.push("runMode="+c.runMode),d.length&&(e="?"+d.join("&")),h=h.replace(b.shortCode,b.shortCode+e),c.$embedCode.text(h),c.$embedModal.foundation("reveal","open"),c.sendAnalytics("Navigation",{action:"View Modal",label:"embed"},{name:"Snippet Modal Viewed",modalType:"embed"})})},onGroupPostClick:function(a){try{window.parent.groups.post(this.serialize())}catch(b){console.log(b)}},onGroupSubmitClick:function(a){try{window.parent.groups.submit(this.serialize())}catch(b){console.log(b)}},getEmbedInfo:function(a){var b="/"+this.getTrinketIdentifier(a);return{url:"/embed/"+this.getType()+b,height:356}},onEmbedFocus:function(a){r.byId("embedCode"),this.updateMetric("embedShares"),this.sendAnalytics("Shares",{action:"Focus",label:"embed"},{name:"Snippet Shared",shareType:"embed"})},updateMetric:function(a,b){var c=m("body").data("no-metrics");if(a&&!c&&this._trinket&&this._trinket.id){if(b){var d=CryptoJS.MD5(b);b=d.toString(CryptoJS.enc.Hex)}else b=this._trinket.id;if(this._updates[a]||(this._updates[a]={}),!this._updates[a][b]){this._updates[a][b]=!0;var e={};e[a]=!0,m.ajax({type:"PATCH",url:"/api/trinkets/"+this._trinket.id+"/metrics",dataType:"json",data:e})}}},onLogoClick:function(b){var c=this;b.preventDefault(),c.getTrinket(function(b){var d=c.getShareInfo(b);c.sendAnalytics("Navigation",{action:"Click",label:"Logo"},{name:"Snippet Logo Clicked"}),window.open(a(d.url))})},onGalleryClick:function(b){b.preventDefault(),window.open(a("/gallery"))},onNotificationClick:function(a){a.preventDefault();var b=this;this._notification_open?m("#notification-content").animate({"margin-top":"-100%"},400,function(){b._notification_open=!1}):m("#notification-content").animate({"margin-top":0},400,function(){b._notification_open=!0,b.sendAnalytics("Navigation",{action:"Click",label:"Notification"},{name:"Snippet Notification Clicked"})})},onSendEmailClick:function(a){var b=this;if(a.preventDefault(),m("#share-email").val()&&m("#share-yourname").val())m(".close").click(),m("#sendEmail").attr("value","Sending ..."),m("#sendEmail").addClass("disabled"),m.post("/api/trinkets/"+b._trinket.id+"/email",{email:m("#share-email").val(),name:m("#share-yourname").val(),replyTo:m("#share-youremail").val(),token:m("#emailToken").val()}).done(function(a){b.$emailModal.foundation("reveal","close");var c='<div data-alert class="alert-box success"> Your email was sent! Thanks for sharing! <a href="#" class="close">&times;</a></div>';m("#flashMessage").show(),m("#flashContent").html(c),m(document).foundation("alert"),m("#share-email").val(""),m("#sendEmail").attr("value","Send"),m("#sendEmail").removeClass("disabled"),setTimeout(function(){m("#flashMessage .close").trigger("click")},3e3),b.sendAnalytics("Shares",{action:"Send Email"},{name:"Snippet Email Sent"})}).fail(function(a,b,c){var d='<div data-alert class="alert-box warning"> There was a problem sending your email. Please try again later. <a href="#" class="close">&times;</a></div>';m("#emailAlert").show().html(d),m(document).foundation("alert")});else{var c='<div data-alert class="alert-box warning"> Please enter an email address and your name. <a href="#" class="close">&times;</a></div>';m("#emailAlert").show().html(c),m(document).foundation("alert")}},onSocialShare:function(a){
var b=a.data.service;this.sendAnalytics("Shares",{action:"Click Social",label:b},{name:"Snippet Social Clicked",service:b})},getAnalyticsCategory:function(){return"Snippet"},sendInterfaceAnalytics:function(a,b){b||(b={});var c=m(a),d=c.data("action")||b.action,e=c.data("data")||b.data,f=c.closest("[data-interface]").data("interface")||b["interface"],g=c.data("library-override")||!1,h=this.$responsiveIndicators.filter(function(a){return"none"!==m(this).css("display")}).data("size")||"",i=[h,f,d.replace(/\./g,"-")];e&&i.push(e),i=i.join(" ").replace(/[a-zA-Z0-9](?:[^\s\-\._]*)/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1)}),this.sendAnalytics("Interface",{action:i,label:this.getTrinketIdentifier()},g)},sendAnalytics:function(a,b,c){var d,e=this,f=e.getEmbedInfo(e._trinket),g=e._queryString&&e._queryString.inLibrary;b=m.extend({category:"Embedded "+e.getAnalyticsCategory()+" "+a},b,{data:{page:f.url}}),d=["send","event",b.category,b.action],b.label&&d.push(b.label),b.value&&d.push(b.value),b.data&&d.push(b.data),window.ga&&(!g||g&&c)&&window.ga.apply(null,d)},toggleOverlay:function(a){m(a).toggleClass("hide"),m(a).hasClass("hide")?(this.hasOverlay=!1,this.onCloseOverlay()):(this.hasOverlay=!0,this.onOpenOverlay())},closeOverlay:function(a){m(a).addClass("hide"),this.hasOverlay=!1},closeAnyModal:function(){m(".close-reveal-modal").is(":visible")&&m(".close-reveal-modal").click()},closeAnyMessage:function(){m(".close").is(":visible")&&m(".close").click()},draggable:function(a){var b=(m("#dragbar").width(),m("#editor")),c=this;m(document).on("mousedown.dragbar","#dragbar",function(d){d.preventDefault();var e=m(".trinket-content-wrapper").width();m("#content-overlay").show(),c.dragging=!0;var f=m("<div>",{id:"ghostbar",css:{height:b.outerHeight(),top:b.offset().top,left:b.offset().left}}).appendTo("body");m(document).on("mousemove.dragbar",function(b){var c=b.pageX/e,d=(e-b.pageX)/e;c>=.3&&d>=.25&&(f.css("left",b.pageX+2),m("#editor").css("width",b.pageX+2),a&&a())}),m(document).one("mouseup.dragbar",function(a){m("#content-overlay").hide(),c.dragging&&(m("#ghostbar").remove(),m(document).off("mousemove.dragbar"),c.dragging=!1)})})},toggleAll:function(){},onOpenOverlay:function(){},onCloseOverlay:function(){},postSave:function(){function a(){return b.resolve()}var b=m.Deferred(),c=this,d=c._trinket.shortCode;return c.saveClientSnapshot()?(c.captureAndSaveSnapshot(function(b){return b?void m.post("/api/trinkets/"+d+"/snapshot",{snapshotData:b}).done(a):a()}),b):a()},saveClientSnapshot:function(){return!1},isDirty:function(){return this._trinket?!(this.getValue()===this._original.code):!1},destroy:function(){this._trinket=void 0},getTrinketIdentifier:function(a){return a||(a=this._trinket),a.shortCode?a.shortCode:CryptoJS.MD5(a.code).toString(CryptoJS.enc.Hex)},getTrinketIdentifierOrNull:function(){var a=null;return this._trinket&&(a=this._trinket.original?this._trinket.original.shortCode:this._trinket.shortCode),a},logError:function(a){a.lang=this.getType(),window.__experiment_name_errors_id&&("NameError"===a.type&&(window.optimizely=window.optimizely||[],window.optimizely.push(["trackEvent","PythonNameError"])),a.label=(a.label?a.label+" ":"")+window.__experiment_name_errors_id),this._trinket&&this._trinket.shortCode&&(a.shortCode=this._trinket.shortCode),m.post("/api/trinkets/codeerror",a).done(function(){})},triggerRunModeChange:function(){m(document).trigger("trinket.runMode.change",{runMode:this.runMode}),this.trigger("trinket.runMode.change",{runMode:this.runMode})},settingsChange:function(a){var b,c=m(a.target)[0].type;this._trinket.settings=m.extend(!0,{},this._trinket.settings),"checkbox"===c?b=m(a.target).is(":checked"):"range"!==c&&"hidden"!==c||(b=m(a.target).val()),"undefined"!=typeof b&&(this._trinket.settings[a.target.id]=b,n.runtime("settingsModified",!0)),m(a.target).data("settings-action")&&"function"==typeof this[m(a.target).data("settings-action")]&&this[m(a.target).data("settings-action")](),m(a.target).data("skip-trigger")?m(a.target).removeData("skip-trigger"):this.triggerChange()},showOutput:function(){m("#codeOutput").removeClass("hide"),m("#editor").addClass("hide"),this.closeOverlay("#modules"),m("#instructionsContainer").addClass("hide"),m("#outputContainer").removeClass("hide"),m("#codeOutputTab").addClass("active"),m("#instructionsTab").removeClass("active")},showInstructions:function(){m("#codeOutput").removeClass("hide"),m("#editor").addClass("hide"),this.closeOverlay("#modules"),this.parsedInstructions||this.displayInstructions(),m("#outputContainer").addClass("hide"),m("#blocklyCodeContainer").addClass("hide"),m("#instructionsContainer").removeClass("hide"),m("#codeViewTab").removeClass("active"),m("#codeOutputTab").removeClass("active"),m("#instructionsTab").addClass("active")},displayInstructions:function(){var a=this;a._trinket.description||"owner"!==a.getUIType()?a.parsedInstructions=u(a._trinket.description):a.parsedInstructions=q("addInstructionsTemplate"),m("#instructionsOutput").html(a.parsedInstructions),m("#instructionsActions").length&&m("#instructionsActions").removeClass("hide")},onEditInstructionsClick:function(){var a=this;m("#instructionsActions").addClass("hide"),m("#instructionsToolbar").removeClass("hide"),m("#instructionsContainer").addClass("editor"),a.parsedInstructions=q("editInstructionsTemplate"),m("#instructionsOutput").empty(),m("#instructionsContainer").append(a.parsedInstructions);var b=m("#instructionsContainer").height();k=ace.edit("embedded-instructions");var c=b-65;m("#embedded-instructions").height(c+"px"),k.resize(),k.$blockScrolling=1/0,k.setTheme("ace/theme/xcode"),k.getSession().setMode("ace/mode/markdown"),k.getSession().setUseSoftTabs(!0),k.getSession().setTabSize(2),k.setShowPrintMargin(!1),k.setValue(a._trinket.description,-1)},onCancelEditInstructionsClick:function(){var a=this;m("#instructionsContainer").removeClass("editor"),m("#instructionsToolbar").addClass("hide"),m("#instructionsActions").removeClass("hide"),k&&k.destroy(),m("#embedded-instructions").remove(),a.displayInstructions()},onSaveInstructionsClick:function(a){var b=this,c=k.getValue();m("#save-instructions").find("i").removeClass().addClass("fa fa-circle-o-notch fa-spin"),m.ajax({url:"/api/trinkets/"+b._original.id,data:JSON.stringify({description:c}),type:"PATCH",contentType:"application/json"}).done(function(a){setTimeout(function(){m("#save-instructions").find("i").removeClass().addClass("fa fa-save"),b._trinket.description=c,m("#instructionsContainer").removeClass("editor"),m("#instructionsToolbar").addClass("hide"),m("#instructionsActions").removeClass("hide"),k&&k.destroy(),m("#embedded-instructions").remove(),b.displayInstructions()},500)}).fail(function(a,b,c){})}},window.TrinketAPI),window.TrinketApp=new i(window.trinketObject,window.draftObject)}),function(){function a(a,b){var c=window.TrinketIO["import"]("utils.cache"),d=c.get("user-log"),e=document.cookie.match(/session=([^;]+);/);a=a||$("#requestedLogin").val(),b=b||$("#whoami").val(),d||(d={log:[],user:b}),d.log.push({time:Date.now(),user:b||"",requested:a||"",path:window.location.href,referrer:document.referrer,userAgent:navigator.userAgent,sesh:e?e[1]:""}),a&&a!==b||!a&&b&&d.user!==b,d.user=b,d.log.length>10&&(d.log=d.log.slice(d.log.length-10)),c.set("user-log",d)}window.TrinketIO["export"]("debug.sessions",{onLogin:function(b,c){b!==c.username&&b!==c.email||(b=c.username),a(b,c.username)}}),$(function(){a()})}(),function(a,b){"use strict";function c(a){e(document.getElementById(a))}function d(a){$("."+a).click(function(a){e($(a.target)[0])})}function e(b){if(document.selection){var c=document.body.createTextRange();c.moveToElementText(b),c.select()}else if(a.getSelection){var c=document.createRange();c.selectNodeContents(b),a.getSelection().removeAllRanges(),a.getSelection().addRange(c)}}b["export"]("utils.selectText",{byId:c,byClass:d})}(window,window.TrinketIO),function(a,b){function c(){var b={outputOnly:"",toggleCode:"",runOption:"",start:"",runMode:""};$("input:checkbox.autorunToggle").change(function(a){var c,d=$(event.target),e=$(d).val(),f=$("#"+e),g=f.text(),h=$(d).prev().data("trinket-shortCode"),i=[],j="",k=new RegExp(h+'[^"]*"'),l='"';$(d).is(":checked")?b.start="result":b.start="",b.runMode=$(d).prev().data("trinket-runMode")||"";for(var m in b)b[m]&&i.push(m+"="+b[m]);i.length&&(j="?"+i.join("&")),c=g.replace(k,h+j+l),f.text(c)}),$(":input.runOptions").change(function(c){var d,e,f,g=$(event.target),h=$(g).data("type"),i=$(g).val(),j=$("#"+h),k=j.text(),l=$(g).data("trinket-shortCode"),m=[],n="";"shareUrl"===h?(d=new RegExp(l+".*"),e=""):(d=new RegExp(l+'[^"]*"'),e='"'),b.runOption=i,b.runMode=$(g).data("trinket-runMode")||"";for(var o in b)b[o]&&m.push(o+"="+b[o]);m.length&&(n="?"+m.join("&")),f=k.replace(d,l+n+e),j.text(f),"shareUrl"===h&&a.addthis&&a.addthis.toolbox&&a.addthis.toolbox("#addthis",{},{url:f})}),$(":input.displayOptions").change(function(c){var d,e,f,g=$(event.target),h=$(g).data("type"),i=$(g).val(),j=$("#"+h),k=j.text(),l=$(g).data("trinket-shortCode"),m=[],n="";"shareUrl"===h?(d=new RegExp(l+".*"),e=""):(d=new RegExp(l+'[^"]*"'),e='"'),b.outputOnly="",b.toggleCode="",i&&"undefined"!=typeof b[i]&&(b[i]="true"),b.runMode=$(g).data("trinket-runMode")||"";for(var o in b)b[o]&&m.push(o+"="+b[o]);m.length&&(n="?"+m.join("&")),f=k.replace(d,l+n+e),j.text(f),"shareUrl"===h&&a.addthis&&a.addthis.toolbox&&a.addthis.toolbox("#addthis",{},{url:f})})}b["export"]("trinket.share",{init:c})}(window,window.TrinketIO),function(a){function b(){if("undefined"==typeof g&&$("#roles").length&&$("#roles").val().length)try{var a=$("#roles").val().split("+"),b=a[0],c=a.slice(1).join("+"),d=CryptoJS.AES.decrypt(c,b);g=JSON.parse(CryptoJS.enc.Utf8.stringify(d))}catch(c){console.log("roles decrypt error:",c)}}function c(a,c,d){b(),d=_.extend(d||{}),c||(c="site"),d.id&&(c=c+":"+d.id);var e=_.find(g,function(a){return a.context===c});return e&&e.permissions.indexOf(a)>=0?e.thru&&e.thru[a]?moment().isBefore(e.thru[a]):!0:!1}function d(a,c,d){b(),d=_.extend(d||{}),c||(c="site"),d.id&&(c=c+":"+d.id);var e=_.find(g,function(a){return a.context===c});return e&&e.roles.indexOf(a)>=0?e.thru&&e.thru[a]?moment().isBefore(e.thru[a]):!0:!1}function e(){var a=!1,c=this;return b(),g&&g.forEach(function(b){/^group/.test(b.context)&&c.hasRole("group-member",b.context)&&(a=!0)}),a}function f(a){var c={};return b(),g&&(c=_.find(g,function(b){return b.context===a})),c}var g;a["export"]("trinket.roles",{hasPermission:c,hasRole:d,inGroup:e,getByContext:f})}(window.TrinketIO),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){var b=0,c=Array.prototype.slice;return a.cleanData=function(b){return function(c){var d,e,f;for(f=0;null!=(e=c[f]);f++)try{d=a._data(e,"events"),d&&d.remove&&a(e).triggerHandler("remove")}catch(g){}b(c)}}(a.cleanData),a.widget=function(b,c,d){var e,f,g,h,i={},j=b.split(".")[0];return b=b.split(".")[1],e=j+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][e.toLowerCase()]=function(b){return!!a.data(b,e)},a[j]=a[j]||{},f=a[j][b],g=a[j][b]=function(a,b){return this._createWidget?void(arguments.length&&this._createWidget(a,b)):new g(a,b)},a.extend(g,f,{version:d.version,_proto:a.extend({},d),_childConstructors:[]}),h=new c,h.options=a.widget.extend({},h.options),a.each(d,function(b,d){return a.isFunction(d)?void(i[b]=function(){var a=function(){return c.prototype[b].apply(this,arguments)},e=function(a){return c.prototype[b].apply(this,a)};return function(){var b,c=this._super,f=this._superApply;return this._super=a,this._superApply=e,b=d.apply(this,arguments),this._super=c,this._superApply=f,b}}()):void(i[b]=d)}),g.prototype=a.widget.extend(h,{widgetEventPrefix:f?h.widgetEventPrefix||b:b},i,{constructor:g,namespace:j,widgetName:b,widgetFullName:e}),f?(a.each(f._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,g,c._proto)}),delete f._childConstructors):c._childConstructors.push(g),a.widget.bridge(b,g),g},a.widget.extend=function(b){for(var d,e,f=c.call(arguments,1),g=0,h=f.length;h>g;g++)for(d in f[g])e=f[g][d],f[g].hasOwnProperty(d)&&void 0!==e&&(b[d]=a.isPlainObject(e)?a.isPlainObject(b[d])?a.widget.extend({},b[d],e):a.widget.extend({},e):e);return b},a.widget.bridge=function(b,d){var e=d.prototype.widgetFullName||b;a.fn[b]=function(f){var g="string"==typeof f,h=c.call(arguments,1),i=this;return f=!g&&h.length?a.widget.extend.apply(null,[f].concat(h)):f,g?this.each(function(){var c,d=a.data(this,e);return"instance"===f?(i=d,!1):d?a.isFunction(d[f])&&"_"!==f.charAt(0)?(c=d[f].apply(d,h),c!==d&&void 0!==c?(i=c&&c.jquery?i.pushStack(c.get()):c,!1):void 0):a.error("no such method '"+f+"' for "+b+" widget instance"):a.error("cannot call methods on "+b+" prior to initialization; attempted to call method '"+f+"'")}):this.each(function(){var b=a.data(this,e);b?(b.option(f||{}),b._init&&b._init()):a.data(this,e,new d(f,this))}),i}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(c,d){d=a(d||this.defaultElement||this)[0],this.element=a(d),this.uuid=b++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=a(),this.hoverable=a(),this.focusable=a(),d!==this&&(a.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=a(d.style?d.ownerDocument:d.document||d),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this.options=a.widget.extend({},this.options,this._getCreateOptions(),c),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(b,c){var d,e,f,g=b;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof b)if(g={},d=b.split("."),b=d.shift(),d.length){for(e=g[b]=a.widget.extend({},this.options[b]),f=0;d.length-1>f;f++)e[d[f]]=e[d[f]]||{},e=e[d[f]];if(b=d.pop(),1===arguments.length)return void 0===e[b]?null:e[b];e[b]=c}else{if(1===arguments.length)return void 0===this.options[b]?null:this.options[b];g[b]=c}return this._setOptions(g),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!b),b&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(b,c,d){var e,f=this;"boolean"!=typeof b&&(d=c,c=b,b=!1),d?(c=e=a(c),this.bindings=this.bindings.add(c)):(d=c,c=this.element,e=this.widget()),a.each(d,function(d,g){function h(){return b||f.options.disabled!==!0&&!a(this).hasClass("ui-state-disabled")?("string"==typeof g?f[g]:g).apply(f,arguments):void 0}"string"!=typeof g&&(h.guid=g.guid=g.guid||h.guid||a.guid++);var i=d.match(/^([\w:-]*)\s*(.*)$/),j=i[1]+f.eventNamespace,k=i[2];k?e.delegate(k,j,h):c.bind(j,h)})},_off:function(b,c){c=(c||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,b.unbind(c).undelegate(c),this.bindings=a(this.bindings.not(b).get()),this.focusable=a(this.focusable.not(b).get()),this.hoverable=a(this.hoverable.not(b).get())},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&g.apply(this.element[0],[c].concat(d))===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?e===!0||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}}),a.widget}),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L=function(a,b){return function(){return a.apply(b,arguments)}},M=[].slice;a=jQuery,H=0,I=1,J=2,y=13,E=9,v=46,u=8,A=37,D=39,F=38,w=40,z=36,x=35,C=33,B=34,i="jqconsole-",e=""+i+"cursor",f=""+i+"header",j=""+i+"prompt",h=""+i+"old-prompt",g=""+i+"input",d=""+i+"blurred",s="keypress",p="<span/>",n="<div/>",o=":empty",G="\n",m=">>> ",l="... ",k=2,c=""+i+"ansi-",q="",r=/\[(\d*)(?:;(\d*))*m/,b=function(){function a(){this.stylize=L(this.stylize,this),this._closeSpan=L(this._closeSpan,this),this._openSpan=L(this._openSpan,this),this.getClasses=L(this.getClasses,this),this._style=L(this._style,this),this._color=L(this._color,this),this._remove=L(this._remove,this),this._append=L(this._append,this),this.klasses=[]}return a.prototype.COLORS=["black","red","green","yellow","blue","magenta","cyan","white"],a.prototype._append=function(a){return a=""+c+a,-1===this.klasses.indexOf(a)?this.klasses.push(a):void 0},a.prototype._remove=function(){var a,b,d,e,f,g;for(d=1<=arguments.length?M.call(arguments,0):[],g=[],e=0,f=d.length;f>e;e++)b=d[e],"fonts"===b||"color"===b||"background-color"===b?g.push(this.klasses=function(){var d,e,f,g;for(f=this.klasses,g=[],d=0,e=f.length;e>d;d++)a=f[d],a.indexOf(b)!==c.length&&g.push(a);return g}.call(this)):(b=""+c+b,g.push(this.klasses=function(){var c,d,e,f;for(e=this.klasses,f=[],c=0,d=e.length;d>c;c++)a=e[c],a!==b&&f.push(a);return f}.call(this)));return g},a.prototype._color=function(a){return this.COLORS[a]},a.prototype._style=function(a){if(""===a&&(a=0),a=parseInt(a),!isNaN(a))switch(a){case 0:return this.klasses=[];case 1:return this._append("bold");case 2:return this._append("lighter");case 3:return this._append("italic");case 4:return this._append("underline");case 5:return this._append("blink");case 6:return this._append("blink-rapid");case 8:return this._append("hidden");case 9:return this._append("line-through");case 10:return this._remove("fonts");case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:return this._remove("fonts"),this._append("fonts-"+(a-10));case 20:return this._append("fraktur");case 21:return this._remove("bold","lighter");case 22:return this._remove("bold","lighter");case 23:return this._remove("italic","fraktur");case 24:return this._remove("underline");case 25:return this._remove("blink","blink-rapid");case 28:return this._remove("hidden");case 29:return this._remove("line-through");case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:return this._remove("color"),this._append("color-"+this._color(a-30));case 39:return this._remove("color");case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:return this._remove("background-color"),this._append("background-color-"+this._color(a-40));case 49:return this._remove("background-color");case 51:return this._append("framed");case 53:return this._append("overline");case 54:return this._remove("framed");case 55:return this._remove("overline")}},a.prototype.getClasses=function(){return this.klasses.join(" ")},a.prototype._openSpan=function(a){return'<span class="'+this.getClasses()+'">'+a},a.prototype._closeSpan=function(a){return""+a+"</span>"},a.prototype.stylize=function(a){var b,c,d,e,f,g;for(a=this._openSpan(a),d=0;(d=a.indexOf(q,d))&&-1!==d;)if(c=a.slice(d).match(r)){for(g=c.slice(1),e=0,f=g.length;f>e;e++)b=g[e],this._style(b);a=this._closeSpan(a.slice(0,d))+this._openSpan(a.slice(d+1+c[0].length))}else d++;return this._closeSpan(a)},a}(),K=function(a,b){return'<span class="'+a+'">'+(b||"")+"</span>"},t=function(){function c(c,d,e,g){this._HideComposition=L(this._HideComposition,this),this._ShowComposition=L(this._ShowComposition,this),this._UpdateComposition=L(this._UpdateComposition,this),this._EndComposition=L(this._EndComposition,this),this._StartComposition=L(this._StartComposition,this),this._CheckComposition=L(this._CheckComposition,this),this._ProcessMatch=L(this._ProcessMatch,this),this._HandleKey=L(this._HandleKey,this),this._HandleChar=L(this._HandleChar,this),this.isMobile=!!navigator.userAgent.match(/iPhone|iPad|iPod|Android/i),this.isIos=!!navigator.userAgent.match(/iPhone|iPad|iPod/i),this.isAndroid=!!navigator.userAgent.match(/Android/i),this.$window=a(window),this.header=d||"",this.prompt_label_main="string"==typeof e?e:m,this.prompt_label_continue=g||l,this.indent_width=k,this.state=I,this.input_queue=[],this.input_callback=null,this.multiline_callback=null,this.history=[],this.history_index=0,this.history_new="",this.history_active=!1,this.shortcuts={},this.$container=a("<div/>").appendTo(c),this.$container.css({top:0,left:0,right:0,bottom:0,position:"absolute",overflow:"auto"}),this.$console=a('<pre class="jqconsole"/>').appendTo(this.$container),this.$console.css({margin:0,position:"relative","min-height":"100%","box-sizing":"border-box","-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box"}),this.$console_focused=!0,this.$input_container=a(n).appendTo(this.$container),this.$input_container.css({position:"absolute",width:1,height:0,overflow:"hidden"}),this.$input_source=a(this.isAndroid?"<input/>":"<textarea/>"),this.$input_source.attr({wrap:"off",autocapitalize:"off",autocorrect:"off",spellcheck:"false",autocomplete:"off"}),this.$input_source.css({position:"absolute",width:2}),this.$input_source.appendTo(this.$input_container),this.$composition=a(n),this.$composition.addClass(""+i+"composition"),this.$composition.css({display:"inline",position:"relative"}),this.matchings={openings:{},closings:{},clss:[]},this.ansi=new b,this._InitPrompt(),this._SetupEvents(),this.Write(this.header,f),a(c).data("jqconsole",this)}return c.prototype.ResetHistory=function(){return this.SetHistory([])},c.prototype.ResetShortcuts=function(){return this.shortcuts={}},c.prototype.ResetMatchings=function(){return this.matchings={openings:{},closings:{},clss:[]}},c.prototype.Reset=function(){this.state!==I&&this.ClearPromptText(!0),this.state=I,this.input_queue=[],this.input_callback=null,this.multiline_callback=null,this.ResetHistory(),this.ResetShortcuts(),this.ResetMatchings(),this.$prompt.detach(),this.$input_container.detach(),this.$console.html(""),this.$prompt.appendTo(this.$console),this.$input_container.appendTo(this.$container),this.Write(this.header,f)},c.prototype.GetHistory=function(){return this.history},c.prototype.SetHistory=function(a){return this.history=a.slice(),this.history_index=this.history.length},c.prototype._CheckKeyCode=function(a){if(a=isNaN(a)?a.charCodeAt(0):parseInt(a,10),!(a>0&&256>a)||isNaN(a))throw new Error("Key code must be a number between 0 and 256 exclusive.");return a},c.prototype._LetterCaseHelper=function(a,b){return b(a),a>=65&&90>=a&&b(a+32),a>=97&&122>=a?b(a-32):void 0},c.prototype.RegisterShortcut=function(a,b){var c;if(a=this._CheckKeyCode(a),"function"!=typeof b)throw new Error("Callback must be a function, not "+b+".");c=function(a){return function(c){return c in a.shortcuts||(a.shortcuts[c]=[]),a.shortcuts[c].push(b)}}(this),this._LetterCaseHelper(a,c)},c.prototype.UnRegisterShortcut=function(a,b){var c;a=this._CheckKeyCode(a),c=function(a){return function(c){return c in a.shortcuts?b?a.shortcuts[c].splice(a.shortcuts[c].indexOf(b),1):delete a.shortcuts[c]:void 0}}(this),this._LetterCaseHelper(a,c)},c.prototype.GetColumn=function(){var a;return this.$prompt_right.detach(),this.$prompt_cursor.text(""),a=this.$console.text().split(G),this.$prompt_cursor.html("&nbsp;"),this.$prompt_cursor.after(this.$prompt_right),a[a.length-1].length},c.prototype.GetLine=function(){return this.$console.text().split(G).length-1},c.prototype.ClearPromptText=function(a){if(this.state===I)throw new Error("ClearPromptText() is not allowed in output state.");this.$prompt_before.html(""),this.$prompt_after.html(""),this.$prompt_label.text(a?"":this._SelectPromptLabel(!1)),this.$prompt_left.text(""),this.$prompt_right.text("")},c.prototype.GetPromptText=function(b){var c,d,e,f,g;if(this.state===I)throw new Error("GetPromptText() is not allowed in output state.");return b?(this.$prompt_cursor.text(""),g=this.$prompt.text(),this.$prompt_cursor.html("&nbsp;"),g):(f=function(b){var c;return c=[],b.children().each(function(){return c.push(a(this).children().last().text())}),c.join(G)},d=f(this.$prompt_before),d&&(d+=G),e=this.$prompt_left.text()+this.$prompt_right.text(),c=f(this.$prompt_after),c&&(c=G+c),d+e+c)},c.prototype.SetPromptText=function(a){if(this.state===I)throw new Error("SetPromptText() is not allowed in output state.");this.ClearPromptText(!1),this._AppendPromptText(a),this._ScrollToEnd()},c.prototype.SetPromptLabel=function(b,c){var d;this.prompt_label_main=b,d=">span+span>span:first-child",a("."+j+d).text(b),null!=c&&(this.prompt_label_continue=c)},c.prototype.UpdatePromptLabel=function(){var b,c;return c=">span+span>span:first-child",b="."+j+c,a(b).text(this.prompt_label_main)},c.prototype.Write=function(b,c,d){var e;return null==d&&(d=!0),d&&(b=this.ansi.stylize(a(p).text(b).html())),e=a(p).html(b),null!=c&&e.addClass(c),this.Append(e)},c.prototype.Append=function(b){var c;return c=a(b).insertBefore(this.$prompt),this._ScrollToEnd(),this.$prompt_cursor.detach().insertAfter(this.$prompt_left),c},c.prototype.Input=function(a){var b,c,d,e;if(this.state===J)d=this.input_callback,e=this.multiline_callback,c=this.history_active,b=this.async_multiline,this.AbortPrompt(),this.input_queue.unshift(function(a){return function(){return a.Prompt(c,d,e,b)}}(this));else if(this.state!==I)return void this.input_queue.push(function(b){return function(){return b.Input(a)}}(this));this.history_active=!1,this.input_callback=a,this.multiline_callback=null,this.state=H,this.$prompt.attr("class",g),this.$prompt_label.text(this._SelectPromptLabel(!1)),this.Focus(),this._ScrollToEnd()},c.prototype.Prompt=function(a,b,c,d){return this.state!==I?void this.input_queue.push(function(e){return function(){return e.Prompt(a,b,c,d)}}(this)):(this.history_active=a,this.input_callback=b,this.multiline_callback=c,this.async_multiline=d,this.state=J,this.$prompt.attr("class",j+" "+this.ansi.getClasses()),this.$prompt_label.text(this._SelectPromptLabel(!1)),this.Focus(),void this._ScrollToEnd())},c.prototype.AbortPrompt=function(){if(this.state!==J)throw new Error("Cannot abort prompt when not in prompt state.");this.Write(this.GetPromptText(!0)+G,h),this.ClearPromptText(!0),this.state=I,this.input_callback=this.multiline_callback=null,this._CheckInputQueue()},c.prototype.Focus=function(){this.IsDisabled()||this.$input_source.focus()},c.prototype.SetIndentWidth=function(a){return this.indent_width=a},c.prototype.GetIndentWidth=function(){return this.indent_width},c.prototype.RegisterMatching=function(a,b,c){var d;return d={opening_char:a,closing_char:b,cls:c},this.matchings.clss.push(c),this.matchings.openings[a]=d,this.matchings.closings[b]=d},c.prototype.UnRegisterMatching=function(a,b){var c;return c=this.matchings.openings[a].cls,delete this.matchings.openings[a],delete this.matchings.closings[b],this.matchings.clss.splice(this.matchings.clss.indexOf(c),1)},c.prototype.Dump=function(){var b,c;return b=this.$console.find("."+f).nextUntil("."+j).addBack(),function(){var d,e,f;for(f=[],d=0,e=b.length;e>d;d++)c=b[d],a(c).is("."+h)?f.push(a(c).text().replace(/^\s+/,">>> ")):f.push(a(c).text());return f}().join("")},c.prototype.GetState=function(){return this.state===H?"input":this.state===I?"output":"prompt"},c.prototype.Disable=function(){return this.$input_source.attr("disabled",!0),this.$input_source.blur()},c.prototype.Enable=function(){return this.$input_source.attr("disabled",!1)},c.prototype.IsDisabled=function(){return Boolean(this.$input_source.attr("disabled"))},c.prototype.MoveToStart=function(a){this._MoveTo(a,!0)},c.prototype.MoveToEnd=function(a){this._MoveTo(a,!1)},c.prototype.Clear=function(){return this.$console.find("."+f).nextUntil("."+j).addBack().text(""),this.$prompt_cursor.detach(),this.$prompt_right.before(this.$prompt_cursor)},c.prototype._CheckInputQueue=function(){return this.input_queue.length?this.input_queue.shift()():void 0},c.prototype._InitPrompt=function(){return this.$prompt=a(K(g)).appendTo(this.$console),this.$prompt_before=a(p).appendTo(this.$prompt),this.$prompt_current=a(p).appendTo(this.$prompt),this.$prompt_after=a(p).appendTo(this.$prompt),this.$prompt_label=a(p).appendTo(this.$prompt_current),this.$prompt_left=a(p).appendTo(this.$prompt_current),this.$prompt_right=a(p).appendTo(this.$prompt_current),this.$prompt_right.css({position:"relative"}),this.$prompt_cursor=a(K(e,"&nbsp;")),this.$prompt_cursor.insertBefore(this.$prompt_right),this.$prompt_cursor.css({color:"transparent",display:"inline",zIndex:0}),this.isMobile?void 0:this.$prompt_cursor.css("position","absolute")},c.prototype._SetupEvents=function(){return this.isMobile?this.$console.click(function(a){return function(b){return b.preventDefault(),a.Focus()}}(this)):this.$console.mouseup(function(a){return function(b){var c;return 2===b.which?a.Focus():(c=function(){return window.getSelection().toString()?void 0:(b.preventDefault(),a.Focus())},setTimeout(c,0))}}(this)),this.$input_source.focus(function(a){return function(){var b,c;return a._ScrollToEnd(),a.$console_focused=!0,a.$console.removeClass(d),c=function(){return a.$console_focused?a.$console.removeClass(d):void 0},setTimeout(c,100),b=function(){return a.isIos&&a.$console_focused?a.$input_source.hide():void 0},setTimeout(b,500)}}(this)),this.$input_source.blur(function(a){return function(){var b;return a.$console_focused=!1,a.isIos&&a.$input_source.show(),b=function(){return a.$console_focused?void 0:a.$console.addClass(d)},setTimeout(b,100)}}(this)),this.$input_source.bind("paste",function(a){return function(){var b;return b=function(){return a.in_composition?void 0:(a._AppendPromptText(a.$input_source.val()),a.$input_source.val(""),a.Focus())},setTimeout(b,0)}}(this)),this.$input_source.keypress(this._HandleChar),this.$input_source.keydown(this._HandleKey),this.$input_source.keydown(this._CheckComposition),this.$input_source.bind("compositionstart",this._StartComposition),this.$input_source.bind("compositionend",function(a){return function(b){return setTimeout(function(){return a._EndComposition(b)},0)}}(this)),this.isAndroid?(this.$input_source.bind("input",this._StartComposition),this.$input_source.bind("input",this._UpdateComposition)):this.$input_source.bind("text",this._UpdateComposition)},c.prototype._HandleChar=function(a){var b;return this.state===I||a.metaKey||a.ctrlKey?!0:(b=a.which,8===b||9===b||13===b?!1:(this.$prompt_left.text(this.$prompt_left.text()+String.fromCharCode(b)),this._ScrollToEnd(),!1))},c.prototype._HandleKey=function(b){var c;if(this.state===I)return!0;
if(c=b.keyCode||b.which,setTimeout(a.proxy(this._CheckMatchings,this),0),b.altKey)return!0;if(b.ctrlKey||b.metaKey)return this._HandleCtrlShortcut(c);if(b.shiftKey){switch(c){case y:this._HandleEnter(!0);break;case E:this._Unindent();break;case F:this._MoveUp();break;case w:this._MoveDown();break;case C:this._ScrollPage("up");break;case B:this._ScrollPage("down");break;default:return!0}return!1}switch(c){case y:this._HandleEnter(!1);break;case E:this._Indent();break;case v:this._Delete(!1);break;case u:this._Backspace(!1);break;case A:this._MoveLeft(!1);break;case D:this._MoveRight(!1);break;case F:this._HistoryPrevious();break;case w:this._HistoryNext();break;case z:this.MoveToStart(!1);break;case x:this.MoveToEnd(!1);break;case C:this._ScrollPage("up");break;case B:this._ScrollPage("down");break;default:return!0}return!1},c.prototype._HandleCtrlShortcut=function(a){var b,c,d,e;switch(a){case v:this._Delete(!0);break;case u:this._Backspace(!0);break;case A:this._MoveLeft(!0);break;case D:this._MoveRight(!0);break;case F:this._MoveUp();break;case w:this._MoveDown();break;case x:this.MoveToEnd(!0);break;case z:this.MoveToStart(!0);break;default:if(a in this.shortcuts){for(e=this.shortcuts[a],c=0,d=e.length;d>c;c++)b=e[c],b.call(this);return!1}return!0}return!1},c.prototype._HandleEnter=function(a){var b,c;return this._EndComposition(),a?this._InsertNewLine(!0):(c=this.GetPromptText(),b=function(a){return function(b){var d,e,f,g,h,j;if(b!==!1){for(a.MoveToEnd(!0),a._InsertNewLine(!0),j=[],f=g=0,h=Math.abs(b);h>=0?h>g:g>h;f=h>=0?++g:--g)b>0?j.push(a._Indent()):j.push(a._Unindent());return j}return e=a.state===H?"input":"prompt",a.Write(a.GetPromptText(!0)+G,""+i+"old-"+e),a.ClearPromptText(!0),a.history_active&&(a.history.length&&a.history[a.history.length-1]===c||a.history.push(c),a.history_index=a.history.length),a.state=I,d=a.input_callback,a.input_callback=null,d&&d(c),a._CheckInputQueue()}}(this),this.multiline_callback?this.async_multiline?this.multiline_callback(c,b):b(this.multiline_callback(c)):b(!1))},c.prototype._GetDirectionals=function(b){var c,d,e,f,g,h,i,j;return f=b?this.$prompt_left:this.$prompt_right,c=b?this.$prompt_right:this.$prompt_left,e=b?this.$prompt_before:this.$prompt_after,d=b?this.$prompt_after:this.$prompt_before,h=b?a.proxy(this.MoveToStart,this):a.proxy(this.MoveToEnd,this),g=b?a.proxy(this._MoveLeft,this):a.proxy(this._MoveRight,this),j=b?"last":"first",i=b?"prependTo":"appendTo",{$prompt_which:f,$prompt_opposite:c,$prompt_relative:e,$prompt_rel_opposite:d,MoveToLimit:h,MoveDirection:g,which_end:j,where_append:i}},c.prototype._VerticalMove=function(a){var b,c,d,e,f,g,h,i;return i=this._GetDirectionals(a),d=i.$prompt_which,b=i.$prompt_opposite,c=i.$prompt_relative,f=i.MoveToLimit,e=i.MoveDirection,c.is(o)?void 0:(g=this.$prompt_left.text().length,f(),e(),h=d.text(),b.text(a?h.slice(g):h.slice(0,g)),d.text(a?h.slice(0,g):h.slice(g)))},c.prototype._MoveUp=function(){return this._VerticalMove(!0)},c.prototype._MoveDown=function(){return this._VerticalMove()},c.prototype._HorizontalMove=function(b,c){var d,e,f,g,h,i,j,k,l,m,n,q,r,s;if(s=this._GetDirectionals(c),h=s.$prompt_which,e=s.$prompt_opposite,g=s.$prompt_relative,f=s.$prompt_rel_opposite,q=s.which_end,n=s.where_append,k=c?/\w*\W*$/:/^\w*\W*/,l=h.text()){if(b){if(r=l.match(k),!r)return;return r=r[0],m=e.text(),e.text(c?r+m:m+r),j=r.length,h.text(c?l.slice(0,-j):l.slice(j))}return m=e.text(),e.text(c?l.slice(-1)+m:m+l[0]),h.text(c?l.slice(0,-1):l.slice(1))}return g.is(o)?void 0:(i=a(p)[n](f),i.append(a(p).text(this.$prompt_label.text())),i.append(a(p).text(e.text())),d=g.children()[q]().detach(),this.$prompt_label.text(d.children().first().text()),h.text(d.children().last().text()),e.text(""))},c.prototype._MoveLeft=function(a){return this._HorizontalMove(a,!0)},c.prototype._MoveRight=function(a){return this._HorizontalMove(a)},c.prototype._MoveTo=function(a,b){var c,d,e,f,g,h,i;if(h=this._GetDirectionals(b),e=h.$prompt_which,c=h.$prompt_opposite,d=h.$prompt_relative,g=h.MoveToLimit,f=h.MoveDirection,a){for(i=[];!d.is(o)||""!==e.text();)g(!1),i.push(f(!1));return i}return c.text(this.$prompt_left.text()+this.$prompt_right.text()),e.text("")},c.prototype._Delete=function(a){var b,c,d;if(c=this.$prompt_right.text()){if(a){if(d=c.match(/^\w*\W*/),!d)return;return d=d[0],this.$prompt_right.text(c.slice(d.length))}return this.$prompt_right.text(c.slice(1))}return this.$prompt_after.is(o)?void 0:(b=this.$prompt_after.children().first().detach(),this.$prompt_right.text(b.children().last().text()))},c.prototype._Backspace=function(b){var c,d,e;if(setTimeout(a.proxy(this._ScrollToEnd,this),0),d=this.$prompt_left.text()){if(b){if(e=d.match(/\w*\W*$/),!e)return;return e=e[0],this.$prompt_left.text(d.slice(0,-e.length))}return this.$prompt_left.text(d.slice(0,-1))}return this.$prompt_before.is(o)?void 0:(c=this.$prompt_before.children().last().detach(),this.$prompt_label.text(c.children().first().text()),this.$prompt_left.text(c.children().last().text()))},c.prototype._Indent=function(){var a;return this.$prompt_left.prepend(function(){var b,c,d;for(d=[],a=b=1,c=this.indent_width;c>=1?c>=b:b>=c;a=c>=1?++b:--b)d.push(" ");return d}.call(this).join(""))},c.prototype._Unindent=function(){var a,b,c,d,e;for(a=this.$prompt_left.text()+this.$prompt_right.text(),e=[],b=c=1,d=this.indent_width;(d>=1?d>=c:c>=d)&&/^ /.test(a);b=d>=1?++c:--c)this.$prompt_left.text()?this.$prompt_left.text(this.$prompt_left.text().slice(1)):this.$prompt_right.text(this.$prompt_right.text().slice(1)),e.push(a=a.slice(1));return e},c.prototype._InsertNewLine=function(b){var c,d,e;return null==b&&(b=!1),e=this._SelectPromptLabel(!this.$prompt_before.is(o)),c=a(p).appendTo(this.$prompt_before),c.append(a(p).text(e)),c.append(a(p).text(this.$prompt_left.text())),this.$prompt_label.text(this._SelectPromptLabel(!0)),b&&(d=this.$prompt_left.text().match(/^\s+/))?this.$prompt_left.text(d[0]):this.$prompt_left.text(""),this._ScrollToEnd()},c.prototype._AppendPromptText=function(a){var b,c,d,e,f,g;for(c=a.split(G),this.$prompt_left.text(this.$prompt_left.text()+c[0]),f=c.slice(1),g=[],d=0,e=f.length;e>d;d++)b=f[d],this._InsertNewLine(),g.push(this.$prompt_left.text(b));return g},c.prototype._ScrollPage=function(a){var b;return b=this.$container[0].scrollTop,"up"===a?b-=this.$container.height():b+=this.$container.height(),this.$container.stop().animate({scrollTop:b},"fast")},c.prototype._ScrollToEnd=function(){var a;return this.$container.scrollTop(this.$container[0].scrollHeight),a=this.$prompt_cursor.position(),this.$input_container.css({left:a.left,top:a.top}),setTimeout(this.ScrollWindowToPrompt.bind(this),50)},c.prototype.ScrollWindowToPrompt=function(){var a,b,c,d,e,f;if(b=this.$prompt_cursor.height(),f=this.$window.scrollTop(),e=this.$window.scrollLeft(),a=document.documentElement.clientHeight,d=this.$prompt_cursor.offset(),c=d.top-2*b,this.isMobile&&"undefined"!=typeof orientation&&null!==orientation){if(f<d.top||f>d.top)return this.$window.scrollTop(c)}else{if(f+a<d.top)return this.$window.scrollTop(d.top-a+b);if(f>c)return this.$window.scrollTop(d.top)}},c.prototype._SelectPromptLabel=function(a){return this.state===J?a?" \n"+this.prompt_label_continue:this.prompt_label_main:a?"\n ":" "},c.prototype._Wrap=function(a,b,c){var d,e;return e=a.html(),d=e.slice(0,b)+K(c,e[b])+e.slice(b+1),a.html(d)},c.prototype._WalkCharacters=function(a,b,c,d,e){var f,g,h;for(g=e?a.length:0,a=a.split(""),h=function(){var b,c,d,f;return e?(d=a,a=2<=d.length?M.call(d,0,c=d.length-1):(c=0,[]),b=d[c++]):(f=a,b=f[0],a=2<=f.length?M.call(f,1):[]),b&&(g+=e?-1:1),b};f=h();)if(f===b?d++:f===c&&d--,0===d)return{index:g,current_count:d};return{index:-1,current_count:d}},c.prototype._ProcessMatch=function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p;return n=c?[b.closing_char,b.opening_char]:[b.opening_char,b.closing_char],h=n[0],l=n[1],o=this._GetDirectionals(c),g=o.$prompt_which,f=o.$prompt_relative,i=1,j=!1,m=g.html(),c||(m=m.slice(1)),d&&c&&(m=m.slice(0,-1)),p=this._WalkCharacters(m,h,l,i,c),k=p.index,i=p.current_count,k>-1?(this._Wrap(g,k,b.cls),j=!0):(e=f.children(),e=c?Array.prototype.reverse.call(e):e,e.each(function(d){return function(e,f){var g,n;return g=a(f).children().last(),m=g.html(),n=d._WalkCharacters(m,h,l,i,c),k=n.index,i=n.current_count,k>-1?(c||k--,d._Wrap(g,k,b.cls),j=!0,!1):void 0}}(this))),j},c.prototype._CheckMatchings=function(b){var c,d,e,f,g,h,i;for(e=b?this.$prompt_left.text().slice(this.$prompt_left.text().length-1):this.$prompt_right.text()[0],i=this.matchings.clss,g=0,h=i.length;h>g;g++)c=i[g],a("."+c,this.$console).contents().unwrap();if((d=this.matchings.closings[e])?f=this._ProcessMatch(d,!0,b):(d=this.matchings.openings[e])?f=this._ProcessMatch(d,!1,b):b||this._CheckMatchings(!0),b){if(f)return this._Wrap(this.$prompt_left,this.$prompt_left.html().length-1,d.cls)}else if(f)return this._Wrap(this.$prompt_right,0,d.cls)},c.prototype._HistoryPrevious=function(){return!this.history_active||this.history_index<=0?void 0:(this.history_index===this.history.length&&(this.history_new=this.GetPromptText()),this.SetPromptText(this.history[--this.history_index]))},c.prototype._HistoryNext=function(){return!this.history_active||this.history_index>=this.history.length?void 0:this.history_index===this.history.length-1?(this.history_index++,this.SetPromptText(this.history_new)):this.SetPromptText(this.history[++this.history_index])},c.prototype._CheckComposition=function(a){var b;return b=a.keyCode||a.which,229===b?this.in_composition?this._UpdateComposition():this._StartComposition():void 0},c.prototype._StartComposition=function(){return this.in_composition?void 0:(this.in_composition=!0,this._ShowComposition(),setTimeout(this._UpdateComposition,0))},c.prototype._EndComposition=function(){return this.in_composition?(this._HideComposition(),this.$prompt_left.text(this.$prompt_left.text()+this.$composition.text()),this.$composition.text(""),this.$input_source.val(""),this.in_composition=!1):void 0},c.prototype._UpdateComposition=function(a){var b;return b=function(a){return function(){return a.in_composition?a.$composition.text(a.$input_source.val()):void 0}}(this),setTimeout(b,0)},c.prototype._ShowComposition=function(){return this.$composition.css("height",this.$prompt_cursor.height()),this.$composition.empty(),this.$composition.appendTo(this.$prompt_left)},c.prototype._HideComposition=function(){return this.$composition.detach()},c}(),a.fn.jqconsole=function(a,b,c){return new t(this,a,b,c)},a.fn.jqconsole.JQConsole=t,a.fn.jqconsole.Ansi=b}.call(this);var JsDiff=function(){function a(a){return{newPos:a.newPos,components:a.components.slice(0)}}function b(a){for(var b=[],c=0;c<a.length;c++)a[c]&&b.push(a[c]);return b}function c(a){var b=a;return b=b.replace(/&/g,"&amp;"),b=b.replace(/</g,"&lt;"),b=b.replace(/>/g,"&gt;"),b=b.replace(/"/g,"&quot;")}var d=function(a){this.ignoreWhitespace=a};d.prototype={diff:function(b,c){if(c===b)return[{value:c}];if(!c)return[{value:b,removed:!0}];if(!b)return[{value:c,added:!0}];c=this.tokenize(c),b=this.tokenize(b);var d=c.length,e=b.length,f=d+e,g=[{newPos:-1,components:[]}],h=this.extractCommon(g[0],c,b,0);if(g[0].newPos+1>=d&&h+1>=e)return g[0].components;for(var i=1;f>=i;i++)for(var j=-1*i;i>=j;j+=2){var k,l=g[j-1],m=g[j+1];h=(m?m.newPos:0)-j,l&&(g[j-1]=void 0);var n=l&&l.newPos+1<d,o=m&&h>=0&&e>h;if(n||o){!n||o&&l.newPos<m.newPos?(k=a(m),this.pushComponent(k.components,b[h],void 0,!0)):(k=a(l),k.newPos++,this.pushComponent(k.components,c[k.newPos],!0,void 0));var h=this.extractCommon(k,c,b,j);if(k.newPos+1>=d&&h+1>=e)return k.components;g[j]=k}else g[j]=void 0}},pushComponent:function(a,b,c,d){var e=a[a.length-1];e&&e.added===c&&e.removed===d?a[a.length-1]={value:this.join(e.value,b),added:c,removed:d}:a.push({value:b,added:c,removed:d})},extractCommon:function(a,b,c,d){for(var e=b.length,f=c.length,g=a.newPos,h=g-d;e>g+1&&f>h+1&&this.equals(b[g+1],c[h+1]);)g++,h++,this.pushComponent(a.components,b[g],void 0,void 0);return a.newPos=g,h},equals:function(a,b){var c=/\S/;return!this.ignoreWhitespace||c.test(a)||c.test(b)?a===b:!0},join:function(a,b){return a+b},tokenize:function(a){return a}};var e=new d,f=new d(!0),g=new d;f.tokenize=g.tokenize=function(a){return b(a.split(/(\s+|\b)/))};var h=new d(!0);h.tokenize=function(a){return b(a.split(/([{}:;,]|\s+)/))};var i=new d;return i.tokenize=function(a){for(var b=[],c=a.split(/^/m),d=0;d<c.length;d++){var e=c[d],f=c[d-1];"\n"==e&&f&&"\r"===f[f.length-1]?b[b.length-1]+="\n":e&&b.push(e)}return b},{Diff:d,diffChars:function(a,b){return e.diff(a,b)},diffWords:function(a,b){return f.diff(a,b)},diffWordsWithSpace:function(a,b){return g.diff(a,b)},diffLines:function(a,b){return i.diff(a,b)},diffCss:function(a,b){return h.diff(a,b)},createPatch:function(a,b,c,d,e){function f(a){return a.map(function(a){return" "+a})}function g(a,b,c){var d=j[j.length-2],e=b===j.length-2,f=b===j.length-3&&(c.added!==d.added||c.removed!==d.removed);/\n$/.test(c.value)||!e&&!f||a.push("\\ No newline at end of file")}var h=[];h.push("Index: "+a),h.push("==================================================================="),h.push("--- "+a+("undefined"==typeof d?"":"	"+d)),h.push("+++ "+a+("undefined"==typeof e?"":"	"+e));var j=i.diff(b,c);j[j.length-1].value||j.pop(),j.push({value:"",lines:[]});for(var k=0,l=0,m=[],n=1,o=1,p=0;p<j.length;p++){var q=j[p],r=q.lines||q.value.replace(/\n$/,"").split("\n");if(q.lines=r,q.added||q.removed){if(!k){var s=j[p-1];k=n,l=o,s&&(m=f(s.lines.slice(-4)),k-=m.length,l-=m.length)}m.push.apply(m,r.map(function(a){return(q.added?"+":"-")+a})),g(m,p,q),q.added?o+=r.length:n+=r.length}else{if(k)if(r.length<=8&&p<j.length-2)m.push.apply(m,f(r));else{var t=Math.min(r.length,4);h.push("@@ -"+k+","+(n-k+t)+" +"+l+","+(o-l+t)+" @@"),h.push.apply(h,m),h.push.apply(h,f(r.slice(0,t))),r.length<=4&&g(h,p,q),k=0,l=0,m=[]}n+=r.length,o+=r.length}}return h.join("\n")+"\n"},applyPatch:function(a,b){for(var c=b.split("\n"),d=[],e=!1,f=!1,g="I"===c[0][0]?4:0;g<c.length;g++)if("@"===c[g][0]){var h=c[g].split(/@@ -(\d+),(\d+) \+(\d+),(\d+) @@/);d.unshift({start:h[3],oldlength:h[2],oldlines:[],newlength:h[4],newlines:[]})}else"+"===c[g][0]?d[0].newlines.push(c[g].substr(1)):"-"===c[g][0]?d[0].oldlines.push(c[g].substr(1)):" "===c[g][0]?(d[0].newlines.push(c[g].substr(1)),d[0].oldlines.push(c[g].substr(1))):"\\"===c[g][0]&&("+"===c[g-1][0]?e=!0:"-"===c[g-1][0]&&(f=!0));for(var i=a.split("\n"),g=d.length-1;g>=0;g--){for(var j=d[g],k=0;k<j.oldlength;k++)if(i[j.start-1+k]!==j.oldlines[k])return!1;Array.prototype.splice.apply(i,[j.start-1,+j.oldlength].concat(j.newlines))}if(e)for(;!i[i.length-1];)i.pop();else f&&i.push("");return i.join("\n")},convertChangesToXML:function(a){for(var b=[],d=0;d<a.length;d++){var e=a[d];e.added?b.push("<ins>"):e.removed&&b.push("<del>"),b.push(c(e.value)),e.added?b.push("</ins>"):e.removed&&b.push("</del>")}return b.join("")},convertChangesToDMP:function(a){for(var b,c=[],d=0;d<a.length;d++)b=a[d],c.push([b.added?1:b.removed?-1:0,b.value]);return c}}}();"undefined"!=typeof module&&(module.exports=JsDiff),function(a,b){"use strict";function c(a,b){var c=Date.now();return["xxxxxxxx","xxxx","4xxx","yxxx","xxxxxxxxxxxx"].join("string"==typeof a?a:"-").substr(0,b||36).replace(/[xy]/g,function(a){var b=(c+16*Math.random())%16|0;return c=Math.floor(c/16),("x"==a?b:3&b|8).toString(16)})}b["export"]("utils.guid",c)}(window,window.TrinketIO),$.widget("trinket.assetBrowser",{options:{assets:[],libraryUrl:[],uploadUrl:"",linkAddUrl:"",selectedClass:"selected",templateUrl:trinketConfig.prefix("/js/plugins/asset-browser.html"),eventPrefix:"asset-browser",openClass:"open",assetsHowTo:"",guest:!0},_create:function(){var a=this;a._templates={},$.get(this.options.templateUrl).then(function(b){a._setUpView(b)}),this._onAppEvent("view.addimage.show",$.proxy(a.openAddImageView,a)),this._onAppEvent("view.upload.show",$.proxy(a.openUploadImageView,a)),this._onAppEvent("close",$.proxy(a.hide,a)),this.options.guest&&$(document).on("trinket.account.success",$.proxy(a.allowImageUpload,a))},_onAppEvent:function(a,b,c){$(c||this.element).on(this.options.eventPrefix+"."+a,b)},_setUpView:function(a){var b,c=this,d=$(a);d.find(".template[template-id]").each(function(a,b){var e=$(b).attr("template-id");c._templates[e]=$(b).detach().removeClass("template").removeAttr("template-id"),c.element.empty().append(d)}),this._addTemplateEvents(d),this._templates.addImage.on("modal.init",$.proxy(this._loadLibrary,this)),this.options.assetsHowTo&&(b=$(this.options.assetsHowTo),b.is("script")&&(b=$(b.text())),this.element.find(".howto-message").append(b),this.element.find(".howto-container").show(),this._onAppEvent("view.howto.show",$.proxy(c.openHowToView,c)),$(document).foundation()),this._viewReady=!0,this._dropzoneReady=!1,this._refreshAssets()},_refreshAssets:function(){var a=this,b=a.element.find("#trinket-asset-list");this._viewReady&&($("#asset-list-wrapper").show(),0===this.options.assets.length?b.hide():(b.empty(),b.show()),$.each(this.options.assets,function(c,d){var e=a._templates.imageInfo.clone();a._initLibraryItem(e,d),b.append(e)}))},_initLibraryItem:function(a,b){var c=this;this._addTemplateEvents(a),a.find(".title").text(b.name),a.find(".thumbnail").attr("src",b.thumb||b.url),a.data("asset-id",b.id),b.isDemo&&a.find(".demo").show(),this._onAppEvent("assets.remove",function(){a.find(".controls").hide(),a.find(".confirm-controls").show()},a),this._onAppEvent("assets.confirm",function(){$.each(c.options.assets,function(a,d){return d.id===b.id?(c.options.assets.splice(a,1),c._refreshAssets(),c.element.trigger("assets.change"),!1):void 0})},a),this._onAppEvent("assets.cancel",function(){a.find(".confirm-controls").hide(),a.find(".controls").show()},a),this._onAppEvent("assets.toggle",function(){a.hasClass(c.options.selectedClass)?(a.removeClass(c.options.selectedClass),$.each(c.options.assets,function(a,d){return d.id===b.id?(c.options.assets.splice(a,1),c._refreshAssets(),c.element.trigger("assets.change"),!1):void 0})):(a.addClass(c.options.selectedClass),c._addToAssets(b))},a)},_addTemplateEvents:function(a){var b=this;return a.find("[events]").each(function(a,c){var d,e,f,g=$(c).attr("events").split(/\s*,\s*/);for($(c).off(),e=g.length;--e>=0;)f=!1,$(c).data("if-broadcasting")&&"disable"===$(c).data("if-broadcasting")&&(f=!0),d=g[e].split(/\s*:\s*/),$(c).on(d[0],function(a){f&&void 0!==window.window.TrinketAPI._receiverBroadcastState&&"OFF"!==window.TrinketAPI._receiverBroadcastState?$(".broadcasting-assets-info").show().delay(5e3).fadeOut():$(this).trigger(b.options.eventPrefix+"."+d[1],{originalEvent:a})})}),a},_initUpload:function(){var a=this;new Dropzone(a._templates.addImage.find(".dropzone")[0],{url:"/api/users/assets",acceptedFiles:"image/jpeg,image/png,image/gif,image/jpg",dictDefaultMessage:"",clickable:"#select-to-upload",previewsContainer:"#preview-container",init:function(){this.on("success",function(b,c){a._addToLibrary(c.file,"top"),a._addToAssets(c.file)})}}),a._onAppEvent("view.upload.hide",$.proxy(a.closeUploadImageView,a)),a._dropzoneReady=!0},_markSelected:function(){var a,b=this,c={};for(a=0;a<b.options.assets.length;a++)c[b.options.assets[a].id]=b.options.assets[a];this._templates.addImage.find(".asset").each(function(a){var d=$(this);d.removeClass(b.options.selectedClass),c[d.data("asset-id")]&&d.addClass(b.options.selectedClass)})},_addToAssets:function(a){this.options.assets.push({url:a.url,name:a.name,id:a.id}),this.element.trigger("assets.change")},_addToLibrary:function(a,b){var c=this._templates.addImage,d=c.find("ul#trinket-asset-list"),e=this._templates.libraryImageInfo.clone();return this._initLibraryItem(e,a),"undefined"!=typeof b&&"top"===b?(d.prepend(e),e.addClass(this.options.selectedClass)):d.append(e),e.addClass("clickable"),e},_loadLibrary:function(){var a=this,b=this._templates.addImage,c=b.find("ul#trinket-asset-list");this._addTemplateEvents(this._templates.addImage),c.empty(),$("#loadingContents").show(),$.get(a.options.libraryUrl).then(function(b){var c,d=b.files||[];for(c=0;c<d.length;c++)a._addToLibrary(d[c]);a._markSelected(),a._templates.addImage.on("modal.show",$.proxy(a._markSelected,a)),a._templates.addImage.on("modal.hide",$.proxy(a._refreshAssets,a)),$("#loadingContent").hide()})},_showModal:function(a){var b=this;this._modal&&(this._modal.hide(),this._modal.trigger("modal.hide")),$.contains(document,a[0])||($("#asset-viewer-contents").append(a),a.trigger("modal.init"),a.find(".closer, .addimage-done").click(function(){b._modal&&(b._modal.trigger("modal.hide"),b._modal.hide(),b._modal=void 0)})),this._modal=a,this._modal.show(),this._modal.trigger("modal.show")},assets:function(a){if(void 0!==a){if(!Array.isArray(a))throw new Error("trinket.codeEditor.assets expects an array, but got "+a);this.options.assets=a,this._refreshAssets()}return this.options.assets},show:function(){this.element.addClass(this.options.openClass)},hide:function(){this.element.removeClass(this.options.openClass)},openUploadImageView:function(){var a=this;a.options.guest?($("#upload-guest").fadeIn(),$("#assetLogin").click(function(b){a.element.trigger("trinket.account.login",["#assetAccount",{action:$(b.target).data("action")}])}),$("#assetCreateAccount").click(function(b){a.element.trigger("trinket.account.create",["#assetAccount",{action:$(b.target).data("action")}])})):$("#upload-assets").fadeIn(function(){a._dropzoneReady||a._initUpload()})},openAddImageView:function(){$("#asset-list-wrapper").hide(),this._showModal(this._templates.addImage)},closeUploadImageView:function(){$("#upload-assets").fadeOut()},openHowToView:function(){$("#howto-message").show()},allowImageUpload:function(){this.options.guest=!1,$("#upload-guest").hide(),this._loadLibrary(),this.openUploadImageView()},openLinkView:function(){this._showModal(this._templates.imageLink)}}),function(a,b,c){function d(a,b,c,d){for(var e=100;--e>0&&a.height()-b<=0;)c==d?a.append("<div class='lineno lineselect _lineno_"+c+"_'>"+c+"</div>"):a.append("<div class='lineno _lineno_"+c+"_'>"+c+"</div>"),c++;return c}function e(b,c){var e=1,f=a(b),g=a('<textarea class="lined" autocorrect="off" autocapitalize="off"></textarea>');f.append(g),g.attr("wrap","off"),g.css({resize:"none"}),g.wrap("<div class='linedtextarea'></div>");var h=g.parent().wrap("<div class='linedwrap'></div>"),i=h.parent();i.prepend("<div class='lines'></div>");var j=i.find(".lines");j.append("<div class='codelines' data-filename='"+c.name+"'></div>");var k=j.find(".codelines");if(e=d(k,j.height(),1,c.selectedLine),-1!=c.selectedLine&&!isNaN(c.selectedLine)){var l=parseInt(g.height()/(e-2)),m=parseInt(l*c.selectedLine)-g.height()/2;g[0].scrollTop=m}var n=_.throttle(function(a){var b=g[0],f=b.scrollTop,h=b.clientHeight;k.css({"margin-top":-1*f+"px"}),e=d(k,f+h,e,c.selectedLine)},50);return g.scroll(n),c.onFocus&&g.on("focus",c.onFocus),c.value&&g.val(c.value,-1),a(window).on("resize",n),{registerPlugin:function(a,b){},destroy:function(){i.remove(),g.remove(),f.empty(),a(window).off("resize",n)},addCommand:function(a,b,c){},change:function(a){return g.on("input propertychange",a)},setValue:function(a){g.val(a,-1)},getValue:function(){return g.val()},focus:function(){return g.focus()},blur:function(){return g.blur()},isFocused:function(){return g.is(":focus")},setModeFromName:function(a){},resize:function(){},highlight:function(b){a('.codelines[data-filename="'+c.name+'"]').find("._lineno_"+b+"_").addClass("lineselect"),a("textarea.lined").addClass("attention-error")},addQueueMarkers:function(){}}}function f(b,d){var e=c.require("ace/ext/modelist"),f=e.getModeForPath("foo."+d.ext),g=c.require("ace/range").Range,h=c.edit(b),i=[],j=[];return h.$blockScrolling=1/0,h.setTheme("ace/theme/xcode"),h.getSession().setMode(f?f.mode:"ace/mode/text"),h.getSession().setUseSoftTabs(!0),h.getSession().setTabSize(2),h.setShowPrintMargin(!1),h.setFontSize("inherit"),h._fileName=d.name,h._addErrorBorder=!1,d.value&&h.setValue(d.value,-1),d.onFocus&&h.on("focus",d.onFocus),{registerPlugin:function(a,b){a.initialize(h,b)},destroy:function(){h.destroy(),a(b).empty()},addCommand:function(a,b,c){h.commands.addCommand({name:a,bindKey:b,exec:c})},change:function(a){var b=this;return h.getSession().on("change",function(){b.removeMarkers(),a()})},setValue:function(a){h.setValue(a,-1)},getValue:function(){return h.getValue()},focus:function(a){return 0===a?h.navigateFileStart():-1===a&&h.navigateFileEnd(),h.focus()},blur:function(){h.blur()},isFocused:function(){return h.isFocused()},setModeFromName:function(a){var b=e.getModeForPath(a),c=h._fileName;h._fileName=a,h._emit("file.rename",{oldName:c,newName:a}),h.getSession().setMode(b?b.mode:"ace/mode/text")},resize:function(a){h.resize(a)},highlight:function(b,c){var d=h.getSession().getLine(b-1);if(c)i.push(b),h._addErrorBorder=!0;else{var e=new g(b-1,0,b-1,d.length);j.push(h.getSession().addMarker(e,"highlight-line-error","fullLine")),a(".ace_content").addClass("attention-error")}},addQueueMarkers:function(){for(var b=0;b<i.length;b++)this.highlight(i[b]);i=[],h._addErrorBorder&&(a(".ace_content").addClass("attention-error"),h._addErrorBorder=!1)},removeMarkers:function(){for(var a=0;a<j.length;a++)h.getSession().removeMarker(j[a]);j=[],i=[]},getSession:function(){return h.getSession()},setReadOnly:function(a){h.setReadOnly(a)},scrollToLine:function(a,b,c,d){h.scrollToLine(a,b,c,d)},aceInstance:h,renderer:h.renderer,keyBinding:h.keyBinding}}function g(a,b){var c={value:b.value};return{registerPlugin:function(a,b){},destroy:function(){},addCommand:function(a,b,c){},change:function(a){a()},setValue:function(a){return c.value=a,a},getValue:function(){return c.value},focus:function(){},blur:function(){},isFocused:function(){return!1},setModeFromName:function(a){},resize:function(){},highlight:function(a){}}}function h(b,c){var d,e={value:c.value};return d=a("<img />",{src:c.value}),a(b).html(d),{registerPlugin:function(a,b){},destroy:function(){},addCommand:function(a,b,c){},change:function(a){a()},setValue:function(a){return e.value=a,a},getValue:function(){return e.value},focus:function(){},blur:function(){},isFocused:function(){return!1},setModeFromName:function(a){},resize:function(){},highlight:function(a){},addQueueMarkers:function(){}}}var i=b["import"]("utils.template"),j={},k=a('<div class="code-editor" data-interface="code-editor"><div class="tab-nav"><dl class="left-options"><dd class="tab-button"><a class="tab-scroll-link left-arrow" data-direction="-1"><i class="fa fa-chevron-left"></i></a></dd><dd class="tab-button"><a class="tab-scroll-link right-arrow" data-direction="1"><i class="fa fa-chevron-right"></i></a></dd></dl><dl class="scrollable-content"></dl><dl class="right-options"><dd class="tab-button"><a class="add-file-link menu-button" data-action="file.add"><i class="fa fa-plus"></i></a></dd></dl><div class="clearfix"></div></div><div class="file-content-container"></div><div class="info-area collapsed"><div class="info-quick"></div><div class="scroll-wrap"><div class="info-full"></div></div><a class="expander fa"></a></div></div>'),l=a('<div class="file-content"></div>'),m=a('<div class="tab-options"><ul><li><a class="file-remove-link menu-button" data-action="file.remove"><i class="fa fa-trash"></i></a></li><li><a class="file-rename-link menu-button" data-action="file.rename"><i class="fa fa-pencil"></i></a></li></ul></div>'),n=i.compile('<dd class="tab"><a class="file-tab-link"><span class="file-name">{{name}}</span><span class="tab-options-link menu-button" data-action="file.options"></span></a></dd>'),o=i.compile('<input type="text" class="file-name-input" value="{{name}}" placeholder="file name">'),p=i.compile('<div data-alert class="file-name-error alert-box alert">{{message}}<a class="close">&times;</a></div>'),q=i.compile('<div data-alert class="file-remove-info alert-box info" data-interface="code-editor">The file "{{name}}" has been deleted. <a class="file-restore-link menu-button" data-action="file.restore">Undo</a><a class="close menu-button" data-action="file-undo.close">&times;</a></div>'),r="click.trinket-code-editor.tab-select",s="mousedown.trinket-code-editor.scroll-tabs-start touchstart.trinket-code-editor.scroll-tabs-start",t="mouseup.trinket-code-editor.scroll-tabs-stop touchend.trinket-code-editor.scroll-tabs-stop",u="click.trinket-code-editor.add-file",v="click.trinket-code-editor.view-assets",w="click.trinket-code-editor.tab-options-open",x="mousedown.trinket-code-editor.tab-options-close",y="click.trinket-code-editor.edit-file-name",z="click.trinket-code-editor.remove-file",A="click.trinket-code-editor.hide-file",B=".fa.fa-exclamation-circle.warning",C="fa fa-exclamation-circle warning",D={options:{selectedLine:-1,selectedClass:"lineselect",noEditor:!1,state:"",defaultFileExt:"txt",mainFileName:"main.py",showTabs:!1,showInfo:!1,assets:!1,assetsHowTo:"",onFocus:function(){},lang:"",owner:!1,canHideTabs:!1},_create:function(){var b=this;this._editor,this._commands=[],this._plugins=[],this._files=[],this.element.empty(),this.element.append(k.clone()),this.$tabOptions=m.clone(),this.options.canHideTabs&&this.$tabOptions.find("ul").append('<li><a class="file-hide-link menu-button" data-action="file.hide" title="toggle tab visibility"><i class="fa fa-eye"></i></a></li>'),a("body").append(this.$tabOptions),this.$tabBar=this.element.find(".scrollable-content"),this.$tabBar.on(r,".tab",function(c){if(!a(this).hasClass("active")){var d=a(this).index();return b._files[d].editor.addQueueMarkers(),b._selectTab(d)}}),this.$contentWrapper=this.element.find(".file-content-container"),this.element.find(".tab-scroll-link").on(s,function(){b._scrollTabBar(a(this).data("direction"))}),this.element.find(".add-file-link").parent().on(u,function(){"BROADCASTING"!=window.TrinketAPI._receiverBroadcastState&&(b.addFile(""),b._selectTab(b.$tabBar.children().length-1,!0),b._editFileName())}),this.element.on(w,".tab-options-link",function(c){if(b.$tabOptions.hasClass("open"))b._closeOptionsMenu();else{var d=a(this).offset();b.$tabOptions.css("left",d.left-10+"px"),b.$tabOptions.css("top",d.top+a(this).height()+10+"px"),b.$tabOptions.addClass("open"),b.element.on(x,function(c){a(c.target).hasClass("tab-options-link")||b._closeOptionsMenu()})}}),this.$tabOptions.find(".file-rename-link").on(y,function(){b._closeOptionsMenu(),"BROADCASTING"!=window.TrinketAPI._receiverBroadcastState&&(a(".file-name-input").length||b._editFileName())}),this.$tabOptions.find(".file-remove-link").on(z,function(){b._closeOptionsMenu(),"BROADCASTING"!=window.TrinketAPI._receiverBroadcastState&&b._removeFile({undo:!0})}),this.$tabOptions.find(".file-hide-link").on(A,function(){b._closeOptionsMenu(),b._toggleFile()}),this.options.assets&&(this.$assetBrowser=a('<div class="file-content fixed-right"></div>').assetBrowser({modalParent:".trinket-content-wrapper",libraryUrl:"/api/users/assets?type=image",assets:this.options.assets,openClass:"active",assetsHowTo:this.options.assetsHowTo,guest:this.options.guest}),this.element.find(".right-options").append('<dd class="tab"><a class="file-tab-link add-asset-link" data-action="assets.view" title="View and Add Images"><i class="fa fa-file-image-o"></i></a></dd>'),this.assetBrowser=this.$assetBrowser.data("trinket-assetBrowser"),this.assetBrowser.hide(),this.element.find(".tab-nav").addClass("allow-assets"),this.$contentWrapper.append(this.$assetBrowser),this.element.find(".add-asset-link").parent().on(v,function(){var c=a(this);c.hasClass("active")||(b._selectTab(-1,!0),c.addClass("active"),b.assetBrowser.show())})),this.options.showTabs||b.element.addClass("tabless"),this.options.showInfo&&b.element.addClass("with-info"),this.options.state&&this._loadState(this.options.state),a(document).on("SkfileWrite",function(c){var d,e,g,h,i,j,k;for(e=c.originalEvent.data.split(":"),g=e[0],h=e.slice(1).join(":"),d=0;d<b._files.length;d++)b._files[d].name===g&&(i=b._files[d].editor.getValue(),j=i.length?i+h:h,a('textarea[name="'+b._files[d].name+'"]').val(j),
b.$contentWrapper.children().eq(d).hasClass("active")?b._files[d].editor.setValue(j):(b._files[d].editor.destroy(),k=l.clone(),b._files[d].editor=f(k[0],{onFocus:function(){},ext:b._files[d].name.split(".").pop()||b.options.defaultFileExt}),b._files[d].editor.setValue(j),b.$contentWrapper.children().eq(d).replaceWith(k)))}),a(document).on("SkfileOpen",function(c){var d,e,g=c.originalEvent.data.split(":"),h=g[0],i=g.slice(1).join(":"),j={};b._files.map(function(a,b){j[a.name]=b}),"undefined"==typeof j[i]?b.addFile({name:i}):"w"===h&&(d=j[i],a('textarea[name="'+b._files[d].name+'"]').val("\n"),b.$contentWrapper.children().eq(d).hasClass("active")?b._files[d].editor.setValue(""):(b._files[d].editor.destroy(),e=l.clone(),b._files[d].editor=f(e[0],{onFocus:function(){},ext:b._files[d].name.split(".").pop()||b.options.defaultFileExt}),b.$contentWrapper.children().eq(d).replaceWith(e)))})},_closeOptionsMenu:function(){this.element.off(x),this.$tabOptions.removeClass("open")},_loadState:function(a){var b;try{if(a=JSON.parse(a),!Array.isArray(a))throw new Error}catch(c){a=[{name:this.options.mainFileName,content:a||""}]}for(b=0;b<a.length;b++)this.addFile(a[b]);this._selectTab(0,!0)},_getCurrentVisibleTab:function(){var a=this.$tabBar.find(".tab.active").first(),b=(this.$contentWrapper.find(".file-content.active").first(),a.index()),c=a.find(".file-name").text();return{tabIndex:b,fileName:c}},_selectTab:function(a,b){this.element.find(".tab.active, .file-content.active").removeClass("active"),this._editor&&this._editor.blur(),void 0!==a&&this._files[a]&&(this.$tabBar.children().eq(a).addClass("active"),this.$contentWrapper.children().eq(a).addClass("active"),this._editor=this._files[a].editor,b||this._editor.focus(),this.element.trigger({type:"codeeditor.tabChanged",tabIndex:a}))},_editFileName:function(){if("BROADCASTING"!=window.TrinketAPI._receiverBroadcastState){var b=this,c=b.$tabBar.find(".tab.active"),d=c.find(".file-name"),e=d.text(),f=a(o({name:e})),g=d.outerWidth();d.hide(),f.css("width",g+"px"),d.after(f),f.focus(),f[0].setSelectionRange(0,e.length),f.on("blur",function(g){var h,i=f.val().replace(/^\s|\s$/g,"");return a(".file-name-error").remove(),i.length?(i.length>50?h="File names must be less than 50 characters, please choose a shorter name.":"python"!==b.options.lang&&"python3"!==b.options.lang||!i.match(/\.py$/)||i.match(/^[\w][\w0-9]*(\.[a-z]+)?$/)?i.match(/^\w[\w\.\-]*$/)?a("#"+i).length?h="The name '"+i+"' is reserved, please choose a different name.":i.toLowerCase()!==e.toLowerCase()&&b.$tabBar.find(".file-name").each(function(){return a(this).text().toLowerCase()===i.toLowerCase()?(h='There is already a file named "'+i+'", please choose a different name.',!1):void 0}):h="File names must start with a letter, number, or underscore followed by zero or more letters, numbers, underscores, hyphens, and periods.":h="Python file names must start with a letter or underscore followed by zero or more letters, digits and underscores.",void(h?(b.element.find(".tab-nav").after(p({message:h})),a(document).foundation("alert","reflow"),a(this).focus(),this.setSelectionRange(0,i.length)):(d.text(i),d.show(),a(this).remove(),b._files[c.index()].name=i,b._onChange&&b._onChange(),b._files[c.index()].editor.setModeFromName(i),b.element.trigger({type:"codeeditor.fileRenamed",oldFileName:e,newFileName:i,newFile:b._files[c.index()]})))):void b._removeFile({undo:!1})}),f.on("keydown",function(b){10===b.keyCode||13===b.keyCode?a(this).blur():27===b.keyCode&&(f.val(e),a(this).blur())})}},_removeFile:function(b){var c=this,d=this.$tabBar.find(".tab.active").first(),e=this.$contentWrapper.find(".file-content.active").first(),f=origIndex=d.index(),g=d.find(".file-name").text(),h=a(q({name:g})),i=this._files.splice(origIndex,1)[0],j=origIndex===this._files.length,k=setTimeout(function(){h.find(".close").click()},15e3),l=function(){clearTimeout(k),i=void 0,d=void 0,e=void 0,h&&(h.remove(),h=void 0)};d.detach(),e.detach(),j&&(f-=1),this._selectTab(f),this._onChange&&this._onChange(),(b.undo||i.editor.getValue().length)&&(this.element.find(".tab-nav").after(h),h.find(".close").on("click",function(){i.editor.destroy(),c.element.trigger({type:"codeeditor.fileRemoved",fileName:g})}),a(".file-restore-link").on("click",function(){c._files.splice(origIndex,0,i),j?(c.$tabBar.append(d),c.$contentWrapper.children().eq(f).after(e)):(c.$tabBar.children().eq(f).before(d),c.$contentWrapper.children().eq(f).before(e)),c._selectTab(origIndex),l(),this._onChange&&this._onChange()}),a(document).one("close.fndtn.alert-box",function(a){l()}),a(".file-name-error").length&&a(".file-name-error").remove(),a(document).foundation("alert","reflow"))},_toggleFile:function(){var b=this,c=b.$tabBar.find(".tab.active");"undefined"==typeof b._files[c.index()].hidden?b._files[c.index()].hidden=!0:b._files[c.index()].hidden=!b._files[c.index()].hidden,b._files[c.index()].hidden?(c.find(".file-name").addClass("hidden-file-indicator"),a('<i class="fa fa-eye-slash file-icon"></i>').insertBefore(c.find(".file-name"))):(c.find(".file-name").removeClass("hidden-file-indicator"),c.find(".file-name").prev("i").remove()),b._onChange&&b._onChange()},_scrollTabBar:function(b){var c,d,e=this,f=300,g=50,h="swing",i=!1,j=e.$tabBar.children();0>b&&(j=a(j.get().reverse())),a(document).one(t,function(){i=!0,clearTimeout(c)}),(d=function(){var k=!0;j.each(function(){var j=a(this).position().left;return b>0&&(j+=a(this).outerWidth()),(b>0&&j>10||0>b&&-10>j)&&(e.$tabBar.animate({scrollLeft:"+="+j},200,h,function(){i||(f=Math.max(0,f-g),f||(h="linear"),c=setTimeout(d,f))}),k=!1),k})})()},resize:function(a){for(var b=0;b<this._files.length;b++)this._files[b].editor.resize(a)},assets:function(a){return this.options.assets?this.assetBrowser.assets(a):[]},addFile:function(b,d){var i,j,k,m,o,p,q,r,s,t=this,u="",v="",w=this._files.length,x=!0,y=d&&d.override?d.override:!1;if("undefined"!=typeof jQueryXDomainRequest&&jQueryXDomainRequest&&(x=!1),"string"==typeof b&&(b={name:b}),i=b.name,v=b.type||i.split(".").pop(),u=b.content||"",q=b.hidden,j=a(n({name:i})),k=l.clone(),t.$tabBar.find(".file-name").each(function(b){a(this).text().toLowerCase()===i.toLowerCase()&&(s=!0,w=b)}),s&&y)return a('textarea[name="'+t._files[w].name+'"]').val(u),t.$contentWrapper.children().eq(w).hasClass("active")?t._files[w].editor.setValue(u):(t._files[w].editor.destroy(),t._files[w].editor=f(k[0],{onFocus:function(){},ext:t._files[w].name.split(".").pop()||t.options.defaultFileExt}),t._files[w].editor.setValue(u),t.$contentWrapper.children().eq(w).replaceWith(k)),this._files[w];for(q&&(t.options.owner&&t.options.canHideTabs?(j.find(".file-name").addClass("hidden-file-indicator"),a('<i class="fa fa-eye-slash file-icon"></i>').insertBefore(j.find(".file-name"))):j.hide()),m=this.options.noEditor?g(k[0],{value:u}):b.image?h(k[0],{name:i,value:u}):x&&c?f(k[0],{onFocus:this.options.onFocus,ext:v||this.options.defaultFileExt,name:i,value:u}):e(k[0],{onFocus:this.options.onFocus,selectedLine:this.options.selectedLine,value:u,name:i}),o=0;o<this._commands.length;o++)m.addCommand.apply(m,this._commands[o]);for(o=0;o<this._plugins.length;o++)m.registerPlugin(this._plugins[o],this);this._onChange&&m.change(this._onChange),j.data({index:w}),this.$tabBar.append(j);var p=this.$contentWrapper.find(".fixed-right").first();return p.length?p.before(k):this.$contentWrapper.append(k),0===w&&j.addClass("permanent"),a(".info-area .expander").click(function(){a(".info-area").hasClass("expanded")?a(".info-area").removeClass("expanded").addClass("collapsed"):a(".info-area").removeClass("collapsed").addClass("expanded")}),r={name:i,type:v,$tab:j,$content:k,editor:m},"undefined"!=typeof q&&(r.hidden=q),this._files.push(r),this.element.trigger({type:"codeeditor.fileAdded",fileName:i,newFile:this._files[this._files.length-1]}),this._files[this._files.length-1]},hasFile:function(a){var b;for(b=0;b<this._files.length;b++)if(this._files[b].name===a)return!0;return!1},getFile:function(a){var b;for(b=0;b<this._files.length;b++)if(this._files[b].name===a)return this._files[b].editor.getValue();return""},selectFile:function(a){var b,c;for(c=0;c<this._files.length;c++)if(this._files[c].name===a){b=this._files[c].$tab;break}b||(b=this.addFile(a).$tab,c=this._files.length-1),this._selectTab(c)},serialize:function(){var a,b,c,d=[];for(b=0;b<this._files.length;b++)a=this._files[b],c={name:a.name,content:a.editor.getValue()},"undefined"!=typeof a.hidden&&(c.hidden=a.hidden),d.push(c);return 1===d.length?d[0].content:JSON.stringify(d)},getAllFiles:function(a){var b,c,d={};a&&"object"==typeof a?(b=a.filter||!1,c=void 0===a.values?!0:a.values):(b=!1,c=!0),b&&"regexp"!=typeof b&&(b=new RegExp(b));for(var e=0;e<this._files.length;e++)b&&!b.test(this._files[e].name)||(d[this._files[e].name]=c?this._files[e].editor.getValue():1);return d},getAllVisibleFiles:function(){var a,b={};for(a=0;a<this._files.length;a++)this._files[a].hidden||(b[this._files[a].name]=this._files[a].editor.getValue());return b},addCommand:function(a,b,c){this._commands.push([a,b,c]);for(var d=0;d<this._files.length;d++)this._files[d].editor.addCommand(a,b,c)},updateInfo:function(b){this.options.showInfo&&(this._currentInfo=b,a(".info-area .expander").hide(),b?(a(".info-area").removeClass("empty").find(".info-quick").html(this._currentInfo.title),this.loadFullInfo(this._currentInfo)):a(".info-area").removeClass("expanded").addClass("collapsed empty"))},loadFullInfo:function(b){var c;if(b&&b.url){if(c=j[b.url],void 0!==c)return void("string"==typeof c?c.length&&(a(".info-area .info-full").html(j[b.url]),a(".info-area .expander").show()):c._cancelled=!1);this.lastInfoRequest&&(this.lastInfoRequest._cancelled=!0),this.lastInfoRequest=j[b.url]=function(){var c=a.get(b.url,"","html");return c.done(function(d){j[b.url]=d||"",d&&!c._cancelled&&(a(".info-area .info-full").html(d),a(".info-area .expander").show())}),c}()}},registerPlugin:function(a){var b=this;a.on&&a.on("info.token",function(a,c){b.updateInfo(c)}),this._plugins.push(a);for(var c=0;c<this._files.length;c++)this._files[c].editor.registerPlugin(a,this)},change:function(a){this._onChange=a;for(var b=0;b<this._files.length;b++)this._files[b].editor.change(a)},reset:function(a){for(var b;b=this._files.pop();)b.editor.destroy(),b.$content.remove(),b.$tab.remove();this._loadState(a)},highlight:function(a,b){for(var c=-1,d=0;d<this._files.length;d++)if(this._files[d].name===a){c=d;break}if(c>=0){var e=!this._files[c].$tab.hasClass("active");this._files[c].editor.highlight(b,e),this._files[c].$tab.has(B).length||this._files[c].$tab.append(" <i class='"+C+"'></i>")}},clearTabMarkers:function(){for(var b=0;b<this._files.length;b++)this._files[b].$tab.has(B).length&&this._files[b].$tab.find(B).remove();a(".ace_content").removeClass("attention-error"),a("textarea.lined").removeClass("attention-error"),a(".lineno").removeClass("lineselect")},gotoLine:function(a){this._editor&&this._editor.aceInstance&&this._editor.aceInstance.gotoLine(a)}};!function(a){for(var b="setValue getValue focus isFocused".split(" "),c=function(b){a[b]=function(){var a=Array.prototype.slice.call(arguments);return this._editor[b].apply(this._editor,a)}},d=0;d<b.length;d++)c(b[d])}(D),a.widget("trinket.codeEditor",D)}(window.jQuery,window.TrinketIO,window.ace),function(a,b,c){function d(a){this.isAuthenticated()===!0?this.startBroadcasting():this.auth(function(a){a&&this.startBroadcasting()}.bind(this))}function e(a){this.isAuthenticated()===!0?this.join():this.auth(function(a){a&&this.join()}.bind(this))}function f(b,c){a(document).on("trinket.broadcasting.start",function(){void 0===g&&(g=new q(b,c)),a(".broadcast-start-control").find("i").removeClass().addClass("fa fa-circle-o-notch fa-spin"),a(".broadcast-status").html("Creating room..."),g.connect(d)}),a(document).on("trinket.broadcasting.join",function(){void 0===g&&(g=new r(b,c)),a(".broadcast-join-control").find("i").removeClass().addClass("fa fa-circle-o-notch fa-spin"),a(".broadcast-status").html("Joining Room..."),g.connect(e)}),a(document).on("trinket.broadcasting.control-room trinket.broadcasting.join-info",function(b){a("#broadcastReceiverInfo").removeClass("hide"),a("#left-broadcast-reason").empty(),a("#keepBroadcastSessionButtons").addClass("hide"),a("#controlRoomModal").foundation("reveal","open"),"broadcasting.join-info"!==b.namespace||void 0!==g&&g.session.state!==m||a.get(i+"/broadcastsession/"+c.trinketIdentifier).done(function(b){b&&b.isActive?(a(".broadcast-status").html("Broadcast session is active."),a(".broadcast-join-control").removeClass("disabled")):(a(".broadcast-join-control").addClass("disabled"),a(".broadcast-status").html("Broadcast session is not active. Check back later."))}).fail(function(b,c,d){a(".broadcast-status").html("Broadcast session is not active. Check back later.")})})}var g,h=(b["import"]("utils.template"),null!=trinketConfig.get("broadcastPort")&&""!==trinketConfig.get("broadcastPort")?":"+trinketConfig.get("broadcastPort"):""),i=trinketConfig.get("broadcastProtocol")+"://"+trinketConfig.get("broadcastHostname")+h,j=i+"/broadcast",k={reconnection:!0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,reconnectionAttempts:5},l=0,m="OFF",n="BROADCASTING",o="OFF",p="BROADCASTING",q=function(b,c){this.session={hasChangeListenersAttached:!1,state:o,needReconnect:!1},this.socket=io.connect(j,k),this.codeEditor=b,this.trinketIdentifier=c.trinketIdentifier,this.userIdentifier=c.userIdentifier,this.token=window.trinketBroadcast.token,this.connectCallback=function(){},this.socket.on("connect",this.onConnect.bind(this)),this.socket.on("reconnect",this.onReconnect.bind(this)),this.socket.on("disconnect",this.onDisconnect.bind(this)),this.socket.on("reconnect_failed",this.onReconnectFailed.bind(this)),this.socket.on("connect_timeout",this.onConnectionTimeout.bind(this)),this.socket.on("sync",this.onSync.bind(this)),this.socket.on("userUpdate",this.onUserUpdate.bind(this)),a(document).on("trinket.broadcasting.stop",this.onBroadcastingStop.bind(this))};q.prototype.updateUI=function(b,c){switch(b){case"stop":a(".broadcast-it").addClass("broadcasting"),a(".broadcast-start-control").find("i").removeClass().addClass("fa fa-play"),a(".broadcast-start-control").addClass("disabled"),a(".broadcast-stop-control").removeClass("disabled"),a(".broadcast-it").prop("title","On Air"),a(".broadcast-status").html(c||'On Air! <a class="close-control-room button radius tiny">Close Control Room <i class="fa fa-times-circle"></i></a>'),a(".close-control-room").click(function(){a("#controlRoomModal").foundation("reveal","close")});break;case"start":a(".broadcast-it").removeClass("broadcasting"),a(".broadcast-start-control").find("i").removeClass().addClass("fa fa-play"),a(".broadcast-start-control").removeClass("disabled"),a(".broadcast-stop-control").addClass("disabled"),a(".broadcast-it").prop("title","Start Broadcasting"),a(".broadcast-status").html(c||"Not Broadcasting")}},q.prototype.connect=function(a){this.isConnected()===!0?a.call(this,this.socket.connected):(this.connectCallback=a,this.socket.connect())},q.prototype.isConnected=function(){return this.socket.connected},q.prototype.onConnect=function(){console.log("Broadcaster connected",this.socket.id),void 0!==this.connectCallback&&this.connectCallback.call(this,this.socket.connected)},q.prototype.onConnectionTimeout=function(){console.log("Broadcaster.onConnectionTimeout",this.session),this.updateUI("start","Connection timed out. Check your internet connection then try again.")},q.prototype.auth=function(a){this.socket.emit("auth",{token:this.token},this.onAuthResponse.bind(this,a))},q.prototype.isAuthenticated=function(){return this.session.isAuthenticated},q.prototype.onAuthResponse=function(a,b){b.error||!b.success?(console.log("An error has occured while authentificating: "+b.error),this.session.isAuthenticated=!1,this.updateUI("start","There was a problem creating your broadcasting room. Try refreshing the page and let us know if the problem continues.")):(this.session.isAuthenticated=!0,console.log("Authenticated successfully")),a.call(this,this.session.isAuthenticated)},q.prototype.startBroadcasting=function(a){var b,c=a||!1;this.session.state!==o&&c===!1||(b={user:this.userIdentifier,trinketId:this.trinketIdentifier},this.socket.emit("startBroadcasting",b,this.onStartBroadcastingResponse.bind(this)))},q.prototype.onStartBroadcastingResponse=function(a){"STARTED"===a.status||"RESTARTED"===a.status?(this.initChangeListeners(),"RESTARTED"===a.status?(this.session.state=a.state,this.onSync({},this.sendBroadcastChange.bind(this))):this.session.state=p,this.updateUI("stop")):(console.log("Could not start a broadcasting session",a),this.updateUI("start","There was a problem creating your broadcasting room. Try refreshing the page and let us know if the problem continues."))},q.prototype.getLoadStateMessage=function(){var a=this.codeEditor.serialize(),b={};return b.state=a,b.type="codeeditor.loadState",b},q.prototype.getAssetChangeMessage=function(){return{assets:this.codeEditor.assetBrowser.options.assets,type:"assets.change"}},q.prototype.onSync=function(a,b){if(this.isConnected()&&this.isAuthenticated()&&this.session.state!==o){var c,d,e=[];e.push(this.getLoadStateMessage()),d=this.codeEditor._getCurrentVisibleTab(),c={},c.tab=d.tabIndex,c.type="codeeditor.tabChanged",e.push(this.getAssetChangeMessage()),b(e)}},q.prototype.onUserUpdate=function(b){b.count&&a("#broadcast-receiving-count").text(b.count-1)},q.prototype.onReconnect=function(){this.session.state!==o&&(a("#broadcastMessage").html("Reconnected!").fadeOut("slow",function(){a("#broadcastMessage").empty(),a("#broadcastMessage").parent().addClass("hide")}),this.session.needReconnect=!0,this.auth(function(a){a&&this.startBroadcasting(!0)}.bind(this)))},q.prototype.onReconnectFailed=function(){this.session.state=o,a("#broadcastMessage").empty(),a("#broadcastMessage").parent().addClass("hide"),a("#controlRoomModal").hasClass("open")||a("a.broadcast-it").trigger("click"),this.updateUI("start","There was a problem connecting to your room. Try refreshing the page and let us know if the problem continues.")},q.prototype.onDisconnect=function(){this.session.isAuthenticated=!1,console.log("disconnect from socket: state:",this.session.state),this.session.state!==o&&(a("#broadcastMessage").parent().removeClass("hide"),a("#broadcastMessage").html("Reconnecting..."))},q.prototype._handle=function(a,b){if(this.session.state===p){var c=a.name,d={};switch(b&&b.action&&(b.type="change"),b.type){case"changeCursor":d=a.editor.getSession().selection.getCursor();break;case"change":d=b;break;case"changeSelection":d=a.editor.getSession().selection.getRange();break;case"changeMode":d={mode:a.editor.getSession().getMode().$id};break;case"blur":d.blur="blur";break;case"focus":d.blur="blur"}d.fileName=c,d.trinketId=this.session.id,d.type="document."+b.type,this.sendBroadcastChange(d)}},q.prototype.sendBroadcastChange=function(a){this.isConnected()&&this.isAuthenticated()&&this.session.state===p&&(a.trinketId=this.trinketIdentifier,this.socket.emit("broadcastChange",a),console.log("broadcastChange",a.type))},q.prototype.initChangeListeners=function(){this.session.hasChangeListenersAttached===!1&&(this.codeEditor.element.on("codeeditor.fileRenamed",this._onFileRenamed.bind(this)),this.codeEditor.element.on("codeeditor.fileRemoved",this._onFileRemoved.bind(this)),this.codeEditor.element.on("codeeditor.fileAdded",this._onFileAdded.bind(this)),this.codeEditor.element.on("codeeditor.tabChanged",this._onTabChanged.bind(this)),a(document).on("trinket.code.run",this._onTrinketRun.bind(this)),a(document).on("sk.system.clear",this._onTrinketClear.bind(this)),a("#reset-output").on("click",this._onTrinketClear.bind(this)),a(document).on("assets.change",this._onAssetsChange.bind(this)),a(document).on("trinket.resetted",this._onTrinketReset.bind(this)),this.session.hasChangeListenersAttached=!0),this.codeEditor._files.forEach(function(a,b){this.addEditorHandlers(a)}.bind(this))},q.prototype._onTrinketReset=function(){this.sendBroadcastChange(this.getLoadStateMessage()),this.sendBroadcastChange(this.getAssetChangeMessage())},q.prototype.onBroadcastingStop=function(){this.socket.emit("stopBroadcasting",{trinketId:this.trinketIdentifier}),this.session.state=o,this.updateUI("start","Broadcasting stopped."),a("#broadcast-receiving-count").empty()},q.prototype._onTabChanged=function(a){var b,c={};return b=this.codeEditor._files[a.tabIndex],void 0===b||""===b.name?void console.log("Broadcaster._onTabChanged: skipped due to missing tab name!"):(c.tabIndex=a.tabIndex,c.type="codeeditor.tabChanged",void this.sendBroadcastChange(c))},q.prototype._onTrinketRun=function(a){console.log("trinket.code.run");var b={};b.trinketId=this.session.id,b.type="codeeditor.run",this.sendBroadcastChange(b)},q.prototype._onTrinketClear=function(a){console.log("sk.system.clear");var b={};b.trinketId=this.session.id,b.type="codeeditor.clear",this.sendBroadcastChange(b)},q.prototype._onAssetsChange=function(a){console.log("assets.change");var b={};b.trinketId=this.session.id,b.type="assets.change",b.assets=this.codeEditor.assetBrowser.options.assets,this.sendBroadcastChange(b)},q.prototype._onFileAdded=function(a){var b=a.fileName||"",c=a.newFile;c._fileID=l++,this.addEditorHandlers(c);var d={};d.fileName=b,d.fileID=c._fileID,d.trinketId=this.session.id,d.type="codeeditor.fileAdded"},q.prototype._onFileRenamed=function(a){var b=a.newFile,c={};c.newFileName=a.newFileName,c.oldFileName=a.oldFileName,c.fileID=b._fileID,c.trinketId=this.session.id,c.type="codeeditor.fileRenamed",this.sendBroadcastChange(c)},q.prototype._onFileRemoved=function(a){var b=a.fileName;console.log("fileRemoved",b);var c={};c.fileName=b,c.trinketId=this.session.id,c.type="codeeditor.fileRemoved",this.sendBroadcastChange(c)},q.prototype.addEditorHandlers=function(a){if(void 0===a._addedEditorHandlers||a._addedEditorHandlers===!1){var b=a.editor.getSession();b.on("change",this._handle.bind(this,a)),b.selection.on("changeCursor",this._handle.bind(this,a)),b.selection.on("changeSelection",this._handle.bind(this,a)),a._addedEditorHandlers=!0}};var r=function(b,c){this.session={state:m,needReconnect:!1,lastDraft:void 0,lastAssets:void 0},this.socket=io.connect(j,k),this.codeEditor=b,this.trinketIdentifier=c.trinketIdentifier,this.userIdentifier=c.userIdentifier,this.token=window.trinketBroadcast.token,this.connectCallback=function(){},this.socket.on("connect",this.onConnect.bind(this)),this.socket.on("connect_timeout",this.onConnectionTimeout.bind(this)),this.socket.on("disconnect",this.onDisconnect.bind(this)),this.socket.on("reconnect",this.onReconnect.bind(this)),this.socket.on("reconnect_failed",this.onReconnectFailed.bind(this)),this.socket.on("broadcastConnectionProblem",this.onBroadcastConnectionProblem.bind(this)),this.socket.on("broadcasterReconnected",this.onBroadcasterReconnected.bind(this)),this.socket.on("broadcastUpdate",this.onBroadcastChange.bind(this)),this.socket.on("leave",this.onServerLeave.bind(this)),a(document).on("trinket.broadcast.confirm-keep",this.saveBroadcastSession.bind(this)),a(document).on("trinket.broadcast.cancel-keep",this.resetBroadcastSession.bind(this)),a(document).on("trinket.broadcasting.leave",this.leave.bind(this))};r.prototype.connect=function(a){this.isConnected()===!0?a.call(this,this.socket.connected):(this.connectCallback=a,this.socket.connect())},r.prototype.isConnected=function(){return this.socket.connected},r.prototype.onConnect=function(){console.log("Receiver connected",this.socket.id),void 0!==this.connectCallback&&(this.connectCallback.call(this,this.socket.connected),this.connectCallback=function(){})},r.prototype.onReconnect=function(){this.session.state!==m&&(a("#broadcastMessage").parent().removeClass("hide"),a("#broadcastMessage").html("Reconnected!").fadeOut("slow",function(){a("#broadcastMessage").empty(),a("#broadcastMessage").parent().addClass("hide")}),this.session.needReconnect=!0,this.auth(function(a){a&&this.join(!0)}.bind(this)))},r.prototype.auth=function(a){this.socket.emit("auth",{token:this.token},this.onAuthResponse.bind(this,a))},r.prototype.isAuthenticated=function(){return this.session.isAuthenticated},r.prototype.onAuthResponse=function(a,b){b.error||!b.success?(console.log("An error has occured while authentificating: "+b.error),this.session.isAuthenticated=!1,this.updateUI("join","There was a problem connecting to the room. Try refreshing the page and let us know if the problem continues.")):(this.session.isAuthenticated=!0,console.log("Authenticated successfully")),a.call(this,this.session.isAuthenticated)},r.prototype.initReceiving=function(){this.codeEditor._files.forEach(function(a){a.editor.renderer.textarea.readOnly=!0,a.editor.setReadOnly(!0),a.editor.aceInstance.on("blur",function(){a.editor.renderer.$cursorLayer.setBlinking(!0),a.editor.renderer.$cursorLayer.showCursor()})}),this.setGlobalReceiverState(n)},r.prototype.uninitReceiving=function(){this.codeEditor._files.forEach(function(a){a.editor.renderer.textarea.readOnly=!1,a.editor.setReadOnly(!1)})},r.prototype.requestSync=function(){this.socket.emit("sync",{trinketId:this.trinketIdentifier},function(a){a.error&&console.log("Sync request failed: ",a)})},r.prototype.onReconnectFailed=function(b){a("#broadcastMessage").empty(),a("#broadcastMessage").parent().addClass("hide"),this.updateUI("join"),this.session.state=m,this.uninitReceiving(),this.saveBroadcastOrDraft("reconnectFailed")},r.prototype.onConnectionTimeout=function(){console.log("Receiver.onConnectionTimeout",this.session),this.updateUI("join","Connection timed out. Check your internet connection then try again.")},r.prototype.onDisconnect=function(){this.session.isAuthenticated=!1,console.log("Receiver.disconnect from socket: state:",this.session.state),this.session.state!==m&&(a("#broadcastMessage").parent().removeClass("hide"),a("#broadcastMessage").html("Reconnecting..."))},r.prototype.onBroadcastConnectionProblem=function(){a("#broadcastMessage").parent().removeClass("hide"),a("#broadcastMessage").html("Reconnecting...")},r.prototype.onBroadcasterReconnected=function(){a("#broadcastMessage").parent().removeClass("hide"),a("#broadcastMessage").html("Reconnected!").fadeOut("slow",function(){a("#broadcastMessage").empty(),a("#broadcastMessage").parent().addClass("hide")}),this.requestSync()},r.prototype.join=function(a){var b,c=a||!1;return console.log("Receiver.join force: "+a,this.session),this.session.state!==m&&c===!1?void console.log("Receiver.join cannot join twice",this.session.state):(b={user:this.userIdentifier,trinketId:this.trinketIdentifier},void this.socket.emit("join",b,this.onJoinResponse.bind(this)))},r.prototype.onJoinResponse=function(a){return console.log("Receiver.onJoinResponse ",a),a.error?(this.session.state=m,void this.updateUI("join","There was a problem connecting to the room. Try refreshing the page and let us know if the problem continues.")):(this.session.trinketId=a.trinketId,this.session.state=a.state,this.session.lastDraft=this.codeEditor.serialize(),this.session.lastAssets=this.codeEditor.assetBrowser.options.assets.slice(),this.requestSync(),this.initReceiving(),void this.updateUI("leave"))},r.prototype.onServerLeave=function(a){console.log("Receiver.onServerLeave",a),this.isConnected()!==!1&&this.isAuthenticated()!==!1&&this.session.state!==m&&(this.updateUI("join"),this.session.state=m,this.uninitReceiving(),this.saveBroadcastOrDraft("serverLeave"))},r.prototype.saveBroadcastOrDraft=function(b){switch(console.log("saveBroadcastOrDraft event:",b),a("#controlRoomModal").hasClass("open")||a("a.broadcast-it").trigger("click"),a("#broadcastReceiverInfo").addClass("hide"),b){case"leave":a("#left-broadcast-reason").empty();break;case"reconnectFailed":a("#left-broadcast-reason").html("Could not reconnect to broadcast session.");break;case"serverLeave":a("#left-broadcast-reason").html("The broadcast session has ended.");break;default:a("#left-broadcast-reason").empty()}a("#keepBroadcastSessionButtons").removeClass("hide"),a("#broadcastMessage").empty(),a("#broadcastMessage").parent().addClass("hide")},r.prototype.setGlobalReceiverState=function(a){window.TrinketAPI._receiverBroadcastState=a},r.prototype.saveBroadcastSession=function(){this.setGlobalReceiverState(m),a(document).trigger("trinket.code.change"),a("#controlRoomModal").foundation("reveal","close")},r.prototype.resetBroadcastSession=function(){this.setGlobalReceiverState(m),this.codeEditor.reset(this.session.lastDraft),this.codeEditor.assetBrowser.assets(this.session.lastAssets),a("#controlRoomModal").foundation("reveal","close")},r.prototype.leave=function(){console.log("Receiver.leave"),this.isConnected()&&this.isAuthenticated()&&this.session.state!==m&&(this.socket.emit("leave",{trinketId:this.trinketIdentifier},function(a){console.log("Receiver.leave.callback",a)}),this.updateUI("join"),this.session.state=m,this.uninitReceiving(),this.saveBroadcastOrDraft("leave"))},r.prototype.updateUI=function(b,c){switch(b){case"leave":a(".broadcast-it").addClass("broadcasting"),a(".broadcast-join-control").removeClass("success").addClass("warning"),a(".broadcast-join-control").find("i").removeClass().addClass("fa fa-leave"),a(".broadcast-join-control").data("action","broadcasting.leave"),a(".broadcast-join-control").find("span").text("Leave Room"),a(".broadcast-it").prop("title","Receiving Broadcast"),a(".broadcast-status").html(c||'Receiving broadcast! <a class="close-control-room button radius tiny">Close Control Room <i class="fa fa-times-circle"></i></a>'),a(".close-control-room").click(function(){a("#controlRoomModal").foundation("reveal","close")}),a(".save-it").addClass("disabled"),a("#version-toggle").attr("disabled",!0),a(".right-menu-link").addClass("disabled");break;case"join":a(".broadcast-it").removeClass("broadcasting"),a(".broadcast-it").prop("title","Join Broadcasting"),a(".broadcast-join-control").removeClass("warning").addClass("success"),a(".broadcast-join-control").data("action","broadcasting.join"),a(".broadcast-join-control").find("i").removeClass().addClass("fa fa-enter"),a(".broadcast-join-control").find("span").text("Join Room"),a(".broadcast-it").prop("title","Join Broadcasting"),a(".broadcast-status").html(c||"Not Joined"),a(".save-it").removeClass("disabled"),a("#version-toggle").removeAttr("disabled"),a(".right-menu-link").removeClass("disabled")}},r.prototype.onBroadcastChange=function(b){if(this.isAuthenticated()===!1||this.isConnected()===!1||this.session.state!==n)return void console.log("Receiver.onBroadcastChange dismiss event",b);var c;for(Array.isArray(b)||(b=[b]),c=0;c<b.length;c++){var d=b[c].type,e=b[c];switch(d){case"codeeditor.fileRemoved":this.removeFile(e.fileName);break;case"codeeditor.fileAdded":this.addFile(e.name,e.fileID,e.content);break;case"codeeditor.fileRenamed":this.renameFile(e.oldFileName,e.newFileName,e.fileID);break;case"document.changeSelection":this.changeSelection(e.fileName,e);break;case"document.changeCursor":this.changeCursor(e.fileName,e);break;case"document.change":var f=e.fileName;this.applyChangeOnFile(f,e);break;case"document.blur":break;case"document.focus":break;case"document.changeMode":break;case"codeeditor.tabChanged":this._changeTab(e.tabIndex);break;case"codeeditor.run":a("#editor").trigger("trinket.code.run",{action:"code.run"});break;case"codeeditor.clear":a(document).trigger("sk.system.clear");break;case"assets.change":this.changeAssets(e.assets);break;case"codeeditor.loadState":this.codeEditor.reset(e.state),this.initReceiving()}}},r.prototype.changeAssets=function(a){var b=this.codeEditor.assetBrowser;b.assets(a)},r.prototype._changeTab=function(a){this.codeEditor._selectTab(a,!1)},r.prototype.changeCursor=function(a,b){var c=this.getFileFromName(a);console.log(a,b),null!=c&&(c.editor.scrollToLine(b.row,!0,!0,function(){}),c.editor.getSession().selection.moveCursorTo(b.row,b.column))},r.prototype.changeSelection=function(a,b){
var c=this.getFileFromName(a);null!=c&&(c.editor.getSession().selection.setSelectionRange(b),c.editor.scrollToLine(b.end.row,!0,!0,function(){}))},r.prototype.removeFile=function(a){var b;b=this.getFileFromName(a),null!=b?(b.$tab.detach(),b.$content.detach(),b.editor.destroy()):this.requestSync()},r.prototype.addFile=function(a,b,c){var d,e={};return e.name=a||"",e.content=c||"",e.hidden=!1,this.codeEditor.hasFile(a)===!0&&this.removeFile(a),d=this.codeEditor.addFile(e),d._fileID=b,d.editor.setReadOnly(!0),d.editor.renderer.textarea.readOnly=!0,d.editor.aceEditor.showCursor(),d.editor.renderer.$cursorLayer.isVisible=!0,d.editor.renderer.$cursorLayer.restartTimer(),d.editor.aceInstance.on("blur",function(){d.editor.renderer.$cursorLayer.setBlinking(!0),d.editor.renderer.$cursorLayer.showCursor()}),d},r.prototype.renameFile=function(a,b,c){var d,e;d=this.getFileFromName(a),null==d?(d=this.addFile(b),this.codeEditor.selectFile(b)):(d.editor.setModeFromName(b),d.name=b,e=d.$tab.find(".file-name"),e.text(b))},r.prototype.applyChangeOnFile=function(a,b){var c=this.getFileFromName(a);null!==c&&(c.editor.getSession().getDocument().applyDeltas([b]),c.editor.scrollToLine(b.end.row,!0,!0,function(){}))},r.prototype.getFileFromName=function(a){var b;for(b=0;b<this.codeEditor._files.length;b++)if(this.codeEditor._files[b].name===a)return this.codeEditor._files[b];return null},r.prototype.getFileById=function(a){var b;for(b=0;b<this.codeEditor._files.length;b++)if(this.codeEditor._files[b]._fileID===a)return this.codeEditor._files[b];return null},window.TrinketIO["export"]("trinket.broadcast.connection",{initialize:f})}(window.jQuery,window.TrinketIO,window.ace),function(){"use strict";function a(a,b){c(function(){g.send(a+","+("object"==typeof b?JSON.stringify(b):b))})}function b(b,c){switch(b){case"reload":u[c]=j.getFile(c).replace(/[^\x00-\x7F]/g,""),a("file",{name:c,contents:u[c]});break;case"completions":if(editor.completer&&editor.completer.detach(),!i)return;var d=JSON.parse(c);if(d.id.toString()===i.id.toString()){var e=Date.now()-i.when;window.ga&&!r&&window.ga("send","event","Embedded Python Interface","Autocomplete","Timing",e),d=d.list||[];for(var f=0;f<d.length;f++)d[f]={caption:d[f].desc,docs:d[f].docs,value:d[f].name,score:500-f,meta:d[f].type,type:d[f].type};if(i.inImport){var g=j.getAllFiles({filter:"^.*\\.py$",values:!1});for(var h in g){var k=h.replace(/\.py$/,"");d.push({caption:k,value:k,type:"import",meta:"import",score:500})}}i.cb(null,d),i=void 0}}}function c(a){return n?a():h?void(a&&p.push(a)):(h=!0,g=new SockJS(t),g.onopen=function(){var a={id:o};g.send("session,"+JSON.stringify(a))},g.onmessage=function(c){var d=c.data.split(/,(.+)?/);if("session_ready"===d[0]){for(n=!0,h=!1;p.length;)p.shift()();a&&a()}else n&&b(d[0],d[1])},void(g.onclose=function(){g=void 0,h=!1,n=!1}))}function d(b){q||(q=!0,j=b,f=new diff_match_patch,f.Diff_Timeout=1,f.Diff_EditCost=5,ace.require("ace/ext/language_tools").setCompleters([{identifierRegexps:[/[.a-zA-Z_0-9\$\-\u00A2-\uFFFF]/],getCompletions:function(b,c,d,e,f){var g,h,j=c.getTokenAt(d.row,d.column);return"string"===j.type||"comment"===j.type?f(null,[]):(i&&(b.completer&&b.completer.detach(),i.cb(null,[])),i={id:++l,cb:f},g=v(b,d,i),h={id:String(i.id),line:d.row+1,column:d.column,file:b._fileName},g&&(h.patch=g),i.when=Date.now(),void a("autocomplete",h))},getDocTooltip:function(a){if("function"==a.type&&a.docs.length){var b=a.docs.split("\n",1)[0],c=a.docs.split(/\-{2,}\s*/)[1];a.docHTML="<b>"+b+"</b>",c&&(a.docHTML+="<hr></hr>"+c)}}}]))}function e(b,c){function e(b){u[b.newName]=u[b.oldName],delete u[b.oldName],a("file_rename",{oldName:b.oldName,newName:b.newName})}function f(b){delete u[b._fileName],a("file_remove",{fileName:b._fileName})}function g(){/python/.test(b.session.getMode().$id)?(a("file",{name:b._fileName,contents:b.getValue()}),u[b._fileName]=b.getValue(),b.on("file.rename",e),b.on("destroy",f),b.on("blur",function(){i=void 0,b.completer&&b.completer.detach()}),b.setOptions({enableBasicAutocompletion:!0,enableLiveAutocompletion:!0})):(b.off("file.rename",e),b.off("file.remove",f),b.setOptions({enableBasicAutocompletion:!1,enableLiveAutocompletion:!1}))}window.ace&&(d(c),b.on("changeMode",function(){g()}),g())}var f,g,h,i,j,k=$({}),l=0,m=TrinketIO["import"]("utils.guid"),n=!1,o="s"+m("",16),p=[],q=!1,r=!1,s=window.trinketSocketConfig,t=s.protocol+"://"+s.hostname+":"+s.port+s.autocompletePath,u={},v=function(a,b,c){var d,e,g,h=a.getValue(),i=void 0===u[a._fileName]?h:u[a._fileName],k=a.session.doc.positionToIndex(b,0);return h=h.replace(/[^\x00-\x7F]/g,""),h=h.replace(/(((?:^|;)[^\S\n\r]*)(from|import)((?:[^\S\r\n]+|\\[\r\n])+))((?:[\w.,*]+(?:[^\S\n\r]*\\[\r\n])*[^\S\n\r]*)*)(?:;|$)/gm,function(a,d,e,f,g,h,i){return h="from"===f?h.replace(/^[\w.]*/,function(e,f){var g=i+d.length+f,h=e.split("."),l=j.hasFile(e+".py")?"sessions."+o+".":"modules.";return k>=g&&k<=i+a.length&&(b.column+=l.length,k<=g+h[0].length&&(c.inImport=!0)),l+e}):h.replace(/[^,]*/g,function(a,e){if(e&&!a)return a;var f=i+d.length+e,g=a.match(/[\w.]+/g)||[a],h=g[0],l=j.hasFile(h+".py")?"sessions."+o+".":"modules.",m=1===g.length&&h.match(/[\w.]/)?" as "+h:"";return k>=f&&k<=f+a.length&&(k<=f+a.indexOf(h)+h.length?(b.column+=l.length,k<=f+a.split(".")[0].length&&(c.inImport=!0)):b.column+=l.length+h.length+m.length),a.replace(h,l+h+m)}),d+h}),h!==i?(u[a._fileName]=h,d=f.diff_main(i,h,!0),d.length>2&&f.diff_cleanupEfficiency(d),e=f.patch_make(i,h,d),g=f.patch_toText(e)):void 0};window.TrinketIO["export"]("python.editor.autocomplete",{initialize:e,on:function(){return k.on.apply(k,arguments)},off:function(){return k.off.apply(k,arguments)},setInLibrary:function(a){r=a}})}(),function(){"use strict";function a(){g.__initialized||(g.__initialized=!0,$("body").append(g))}function b(b){function i(){x&&(j(v),b.session.lineWidgets&&b.session.lineWidgets.forEach(function(a,c){b.session.widgetManager.removeLineWidget(a)}),x=!1)}function j(a){var c,d,e;if(a&&a.length)for(;a.length;){for(c=a.pop(),d=w[c.range.start.row][c.range.start.column],e=0;e<d.length;e++)if(d[e].id===c.id){d.splice(e,1);break}b.getSession().removeMarker(c.id)}}function k(a,c,e,f){var g=c.line-1,h=new d(g,c.start,g,c.end),i={id:b.getSession().addMarker(h,e||"variable-undefined"),data:f,range:h};a.push(i),x=!0,w[g]||(w[g]=[]),w[g][c.start]||(w[g][c.start]=[]),w[g][c.start].push(i)}function l(a,b){var c,d,e,f=a&&a._astname;if(f){if(b[f]&&b[f].enter&&b[f].enter(a),a._fields)for(c=0;c<a._fields.length;c+=2)if(e=a._fields[c+1](a))if(e._astname)l(e,b);else if(e.constructor===Array&&e.length&&e[0]&&e[0]._astname)for(d=0;d<e.length;d++)l(e[d],b);b[f]&&b[f].leave&&b[f].leave(a)}}function m(){var a,c,d,e,g,h,j="main.py",m=b.getValue();if(i(),!window.__experiment_name_errors_hints_off&&!/import\s+\*/.test(m)){try{c=Sk.parse(j,m),d=Sk.astFromParse(c,j),e=Sk.symboltable(d,j)}catch(n){return}g=[],h=e.top,a={enter:function(a){g.push(h),h=e.getStsForAst(a)},leave:function(a){h=g.pop()}},l(d,{FunctionDef:a,ClassDef:a,Name:{enter:function(a){var b=a.id.v,c=h.lookup(b);!c.is_global()||Sk.builtins.hasOwnProperty(b)||f.hasOwnProperty(b)||e.global.hasOwnProperty(b)&&(e.top.lookup(b).is_assigned()||e.top.lookup(b).is_imported())||k(v,{line:a.lineno,start:a.col_offset,end:a.col_offset+b.length},!1,{message:"<code>"+b+"</code> is not defined. Did you mean something else?"})}}})}}function n(a,c){var d=b.session.getTokenAt(a,c);return(!d||"text"===d.type&&/^\s+$/.test(d.value))&&(d=b.session.getTokenAt(a,c+1)),d&&(d.row=a,w[a]&&w[a][d.start]&&(d.marker=w[a][d.start][0])),d}function o(){i(),u&&clearTimeout(u),u=setTimeout(m,883)}function p(a){var b,c;y&&(g.hide(),y=!1),x&&(b=a.getDocumentPosition(),c=n(b.row,b.column),c&&c.marker&&c.marker.data&&c.marker.data.message&&(y=!0,g.css({left:a.domEvent.pageX,top:a.domEvent.pageY+10}).html(c.marker.data.message).show()))}function q(a,b){var c=b.getCursor(),d=n(c.row,c.column);!d||A.row===d.row&&A.start===d.start||("keyword"===d.type&&h[d.value]?e.trigger("info.token",{token:d,title:h[d.value],url:trinketConfig.prefix("/partials/python-docs/keywords/"+d.value+".html")}):d.marker?e.trigger("info.token",{token:d,title:d.marker.data.message}):e.trigger("info.token",void 0),A=d)}function r(){z||(z=!0,c||(c=ace.require("ace/line_widgets").LineWidgets,d=ace.require("ace/range").Range),b.on("change",o),b.on("mousemove",p),b.session.selection.on("changeCursor",q),m())}function s(){z&&(z=!1,b.off("change",o),b.off("mousemove",p),b.session.selection.off("changeCursor",q))}function t(){/python/.test(b.session.getMode().$id)?r():s()}var u,v=[],w=[],x=!1,y=!1,z=!1,A={};a(),b.on("changeMode",function(){t()}),t()}var c,d,e=$({}),f={True:1,False:1,None:1,NotImplemented:1,Ellipsis:1,__debug__:1,"float":1,"int":1,"long":1},g=$('<div class="editor-tooltip"></div>').hide(),h={and:"The boolean <code>and</code> operator.",as:"Module aliasing: <code>import random as rnd</code>.",assert:"Use <code>assert</code> to test assumptions.","break":"Use <code>break</code> to stop the (loop) cycle.","class":"Use <code>class</code> to create new user defined modules.","continue":"Use <code>continue</code> to skip to the next (loop) cycle.",def:"A <code>def</code> defines a function.",del:"Use <code>del</code> to delete an object.",elif:"Use <code>elif</code> for else-if conditionals.","else":"<code>else</code> is executed unless <code>if</code> is true.",except:"Use <code>except</code> to catch an exception.",exec:"<code>exec</code> is not yet implemented.","finally":"<code>finally</code> blocks are always executed.","for":"<code>for</code> iterates over a list in order.",from:"Use <code>from</code> to import a specific part of a module.",global:"<code>global</code> accesses variables defined outside functions","if":"Use <code>if</code> to conditionally execute statements.","import":"Use <code>import</code> to use external modules.","in":"<code>in</code> tests if a sequence contains a value.",is:"<code>is</code> tests for object identity.",lambda:"<code>lambda</code> creates a new anonymous function",not:"The boolean <code>not</code> operator.",or:"The boolean <code>or</code> operator.",pass:"<code>pass</code> does nothing at all, seriously.",print:"Use <code>print</code> to write output.",raise:"Use <code>raise</code> to create an exception.","return":"Use <code>return</code> to exit a function.","try":"Use <code>try</code> to capture exceptions.","while":"Use <code>while</code> to loop until a condition is false.","with":"<code>with</code> simplifies exception handling.","yield":"<code>yield</code> exits a generator with a value."};window.TrinketIO["export"]("python.editor.hints",{initialize:b,on:function(){return e.on.apply(e,arguments)},off:function(){return e.off.apply(e,arguments)}})}(),function(){function a(){}function b(a){h=a,$("#test-totals").html(i+" out of "+h+" tests passed")}function c(a,b,c){g+=1,i+=1;var d=j("unittest-pass",{testNumber:g,shortDescription:b,description:c});$("#unittest-accordion").append($(d)),$("#test-totals").html(i+" out of "+h+" tests passed"),$(document).foundation()}function d(a,b,c,d){g+=1;var d=d.replace("\n","<br>"),e=j("unittest-fail",{testNumber:g,shortDescription:b,description:c,reason:d});$("#unittest-accordion").append($(e)),$(document).foundation()}function e(a,b){g+=1;var b=b.replace("\n","<br>"),c=j("unittest-error",{testNumber:g,shortDescription:a,reason:b});$("#unittest-accordion").append($(c)),$(document).foundation()}function f(){return g}var g,h,i,j=window.TrinketIO["import"]("utils.template");window.TrinketIO["export"]("python.editor.unittests",{initializePlugin:function(){g=0,h=0,i=0,$("li.accordion-navigation").remove(),$("#unittest-accordion").on("toggled",function(a,b){var c=$(".open-close-indicator.fa-angle-down");if(c.addClass("fa-angle-right"),c.removeClass("fa-angle-down"),$(".content.active").length){var d=$(b).parent().find(".open-close-indicator");d.removeClass("fa-angle-right"),d.addClass("fa-angle-down")}})},addTest:a,addSuccess:c,addFailure:d,addError:e,setNumberOfTests:b,getNumberOfTestsRun:f})}(),function(a){a["export"]("sendSignalToSkulpt",function(a){null!=Sk.signals&&null!=Sk.signals.signal&&Sk.signals.signal(a)})}(window.TrinketIO),function(a){function b(){this._eventListeners,this._eventQueue=[],this._threadHandler=null,this._isDownDict={},this._signal=g}function c(a){var c,d,f;i[a.which]?(a.preventDefault(),c="",f=e(a.which),d=i[f].keyword,$("#"+h).hide(),$("#"+i[f].state).show(),h=i[f].state,Sk.sense_hat.sensestick.isKeyDown(d)?c=b.STATE_HOLD:Sk.sense_hat.sensestick.addKeyDownEventToDict(d),window.sense_hat.sensestick.push(i[f].key,c||b.STATE_PRESS)):a.ctrlKey&&"c"===String.fromCharCode(a.which).toLowerCase()&&$(document).trigger("trinket.code.stop")}function d(a){var c,d;i[a.which]&&(a.preventDefault(),d=e(a.which),c=i[d].keyword,$("#"+h).hide(),$("#_sense_hat_joystick_rest_").show(),h="_sense_hat_joystick_rest_",Sk.sense_hat.sensestick.removeKeyDownEventFromDict(c),window.sense_hat.sensestick.push(i[d].key,b.STATE_RELEASE))}function e(a){var b;return"Enter"===i[a].keyword?a:(b=Math.abs($("#sense_hat_angle").val()),b&&(a+=b/90,a>40&&(a-=4)),a)}function f(){$("#_sense_hat_joystick_enter_").hide(),$("#_sense_hat_joystick_up_").hide(),$("#_sense_hat_joystick_down_").hide(),$("#_sense_hat_joystick_left_").hide(),$("#_sense_hat_joystick_right_").hide(),$("#_sense_hat_joystick_rest_").show(),$(document).on("keydown","#sense-hat-listener",c),$(document).on("keyup","#sense-hat-listener",d)}!function(a){a.eventEmitter={_JQInit:function(){this._JQ=a(this)},emit:function(a,b){!this._JQ&&this._JQInit(),this._JQ.trigger(a,b)},once:function(a,b){!this._JQ&&this._JQInit(),this._JQ.one(a,b)},on:function(a,b){!this._JQ&&this._JQInit(),this._JQ.bind(a,b)},off:function(a,b){!this._JQ&&this._JQInit(),this._JQ.unbind(a,b)}}}($);var g=a["import"]("sendSignalToSkulpt");$.extend(b.prototype,jQuery.eventEmitter),b.prototype.triggerKeyboardInterrupt=function(){this.emit("sensestick.input",{type:"keyboardinterrupt"})},b.prototype.addKeyDownEventToDict=function(a){this._isDownDict[a]=!0},b.prototype.removeKeyDownEventFromDict=function(a){delete this._isDownDict[a]},b.prototype.isKeyDown=function(a){return this._isDownDict[a]===!0},b.prototype.push=function(a,c,d){var e={type:null!=d?parseInt(d):b.EV_KEY,key:parseInt(a),state:parseInt(c),timestamp:Date.now()};this._eventQueue.push(e),this.emit("sensestick.input",e)},b.prototype.destroy=function(){this._threadHandler&&this.off("sensestick.input",this._threadHandler),$(document).off("keydown","#sense-hat-listener",c),$(document).off("keyup","#sense-hat-listener",d),this._isDownDict={},this._eventQueue=[]},b.EV_KEY=1,b.STATE_RELEASE=0,b.STATE_PRESS=1,b.STATE_HOLD=2,b.KEY_UP=103,b.KEY_LEFT=105,b.KEY_RIGHT=106,b.KEY_DOWN=108,b.KEY_ENTER=28;var h="_sense_hat_joystick_rest_",i={13:{state:"_sense_hat_joystick_enter_",key:b.KEY_ENTER,keyword:"Enter"},37:{state:"_sense_hat_joystick_left_",key:b.KEY_LEFT,keyword:"ArrowLeft"},38:{state:"_sense_hat_joystick_up_",key:b.KEY_UP,keyword:"ArrowUp"},39:{state:"_sense_hat_joystick_right_",key:b.KEY_RIGHT,keyword:"ArrowRight"},40:{state:"_sense_hat_joystick_down_",key:b.KEY_DOWN,keyword:"ArrowDown"}};a["export"]("python.sense-stick",{initJoystick:f,SenseStickDevice:b})}(window.TrinketIO),function(){function a(){var a;w.forEach(function(a){var b="sense_hat_"+a;"undefined"!=typeof TrinketIO.runtime(b)&&($("#"+b).val(TrinketIO.runtime(b)),TrinketIO.runtime(b,void 0)),x[a]={$slider:$("#"+b+"[data-rangeslider]")},x[a].$slider.rangeslider({polyfill:!1,onInit:function(){h(this.value,{sensor:a})},onSlideEnd:function(){m()}}).on("input",function(){h(this.value,{sensor:a})})}),"undefined"!=typeof TrinketIO.runtime("sense_hat_angle")?(q=TrinketIO.runtime("sense_hat_angle"),TrinketIO.runtime("sense_hat_angle",void 0)):"undefined"==typeof q&&(q=0),a=Math.abs(q%360),$("#_sense_hat_").css("transform","rotate(-"+Math.abs(q)+"deg)"),$("#sense_hat_angle").data("skip-trigger",!0),$("#sense-hat-display-angle").html(a+"&deg;"),270===a&&$("#_sense_hat_").css("margin-top","10%"),q>0&&(q*=-1),$("#sense_hat_angle").val(q).trigger("change")}function b(a){var b,c,d;w.forEach(function(e){b="sense_hat_"+e,d=!!$("#"+b).length,d&&$("#"+b).data("skip-trigger",!0),"undefined"!=typeof a[b]?c=a[b]:d&&(c=$("#"+b).prop("defaultValue")),x[e]&&x[e].$slider.val(c).change()})}function c(){w.forEach(function(a){x[a].$slider.rangeslider("update",!1,!1)})}function d(){w.forEach(function(a){x[a].$slider.rangeslider("destroy")})}function e(a){var b=!1;return _.map(a,function(a,c){/\.py$/.test(c)&&(/import\s*sense_hat/.test(a)||/from\s*sense_hat\s*import/.test(a))&&(b=!0)}),b}function f(){TrinketIO.runtime("downloadExtra",o)}function g(){c()}function h(a,b){var c,d,e=!isNaN(parseFloat(a))&&isFinite(a);if(e){switch(a=Number(parseFloat(a).toFixed(2)),b.sensor){case"temperature":c="&deg; C",d=2;break;case"pressure":c="hPa",d=.1;break;case"humidity":c="%",d=a>=20&&80>=a?3.5:5}window.sense_hat.rtimu[b.sensor]=[1,l(a,d)],$(".sense-hat-"+b.sensor).html(a+c)}else window.sense_hat.rtimu[b.sensor]=[0,-1];Sk.sense_hat&&Sk.sense_hat.rtimu&&(Sk.sense_hat.rtimu[b.sensor]=window.sense_hat.rtimu[b.sensor]),m()}function i(a){return 2===a.toString().length?a:"0"+a}function j(){if(this.haveNextNextGaussian)return this.haveNextNextGaussian=!1,this.nextNextGaussian;var a,b,c;do a=2*Math.random()-1,b=2*Math.random()-1,c=a*a+b*b;while(c>=1||0===c);var d=Math.sqrt(-2*Math.log(c)/c);return this.nextNextGaussian=b*d,this.haveNextNextGaussian=!0,a*d}function k(a,b,c){return a>c?c:b>a?b:a}function l(a,b){var c=k(j()),d=a+c*Math.sqrt(b),e=a+b,f=a-b;return Math.min(Math.max(f,d),e)}function m(a){if("undefined"!=typeof a&&(p=a),p){var b=$("#graphic-wrap").scrollTop();$("#sense-hat-listener").focus(),b&&$("#graphic-wrap").scrollTop(b)}}Modernizr.addTest("mixblendmode",function(){return Modernizr.testProp("mixBlendMode")});var n=TrinketIO["import"]("python.sense-stick"),o="https://trinket-app-assets.trinket.io/sense-hat/v2.2.0.zip",p=!1;window.sense_hat={rtimu:{temperature:[1,$("#sense_hat_temperature").val()],humidity:[1,$("#sense_hat_humidity").val()],pressure:[1,$("#sense_hat_pressure").val()],gyro:[0,0,0],accel:[0,0,1],compass:[0,0,0],fusionPose:[0,0,0]},sensestick:new n.SenseStickDevice},window.Sk_interrupt=!1;var q,r,s=8,t=47,u=t,v=function(a,b){var c,d,e,f=.4,g=180,h=255,j=0,k=0,l=0,m=1,n=1;if(a&&"setpixel"===a)if(c=b,d=window.sense_hat.pixels[c],e=$("#_sense_hat_led_"+i(c)+"_"),window.sense_hat.pixels[c]=[-8&d[0],-4&d[1],-8&d[2]],d[0]>u||d[1]>u||d[2]>u?(j=d[0]>u?(d[0]/255*(h-g)+g)/255:f,k=d[1]>u?(d[1]/255*(h-g)+g)/255:f,l=d[2]>u?(d[2]/255*(h-g)+g)/255:f,m=0,n=1):e.attr("filter",""),Modernizr.mixblendmode&&"linux"!==Detectizr.os.name)e.children(".rled").css({opacity:j}),e.children(".gled").css({opacity:k}),e.children(".bled").css({opacity:l}),e.children(".oled").css({opacity:m}),e.children(".kled").css({opacity:n});else{var o,p,q,r,v,w;o=parseInt(255*j),p=parseInt(255*k),q=parseInt(255*l),r=1,v=0,o+p+q===0&&(r=0,v=1),w="rgb("+[o,p,q].join(",")+")",e.children(".rled").css({opacity:0}),e.children(".gled").css({opacity:0}),e.children(".bled").css({opacity:0}),e.children(".oled").css({opacity:v}),e.children(".kled").css({opacity:r}),e.children(".kled").attr("fill",w)}else a&&"changeLowlight"===a&&(u=b===!0?s:t)},w=["temperature","pressure","humidity"],x={},y=!1;window.onresize=function(){TrinketIO.runtime("usingSenseHat")&&(clearTimeout(r),r=setTimeout(g,1e3))},$(document).on("click",".exit-off-canvas",function(){TrinketIO.runtime("usingSenseHat")&&setTimeout(function(){c()},500)}),$(document).on("click.sense-hat-focus","#graphic",function(){m(!0)}),$(document).on("click","#sense-hat-info-button",function(a){a.preventDefault(),$("#sense-hat-info-button").addClass("hide"),$("#sense-hat-info").removeClass("hide"),$("#sense-hat-rotate-container").addClass("hide")}),$(document).on("click","#sense-hat-info-close",function(a){a.preventDefault(),$("#sense-hat-info").addClass("hide"),$("#sense-hat-info-button").removeClass("hide"),$("#sense-hat-rotate-container").removeClass("hide")}),$(document).on("click","#sense-hat-rotate-button",function(a){if(!y){var b=q-90,c=Math.abs(b%360),d=0;y=!0,$({deg:q}).animate({deg:b},{duration:350,step:function(a){$("#_sense_hat_").css({transform:"rotate("+a+"deg)"})},complete:function(){q=b,$("#sense_hat_angle").val(c).trigger("change"),$("#sense-hat-display-angle").html(c+"&deg;"),y=!1,270===c&&(d="10%"),$("#_sense_hat_").css("margin-top",d)}})}}),$("#graphic-wrap").scroll(function(){if(TrinketIO.runtime("usingSenseHat")){var a=$(this).scrollTop(),b=-a+"px";$("#sense-hat-info-button").css({bottom:b}),$("#sense-hat-info").css({bottom:b}),$("#sense-hat-rotate-container").css({bottom:b})}}),window.TrinketIO["export"]("python.sense-hat",{sense_hat_emit:v,focus:m,initSensors:a,destroySliders:d,updateSliders:c,resetSensors:b,usingSenseHat:e,addSrc:f})}(),function(a,b){function c(a,c){x[a]||b.ajax({async:!1,type:"GET",url:a,dataType:c&&c.dataType?c.dataType:"script",success:function(b,d){x[a]=!0,c&&c.success&&c.success(b)}})}function d(a){var c=b("#console-output");c.removeClass("hide"),c.html(c.html()+a)}function e(a,c){var d,e="code-error";if(c&&"validation"===c.type&&(e="info",a=c.message),!(c&&"interrupt"===c.message||a&&/KeyboardInterrupt/.test(a))){var d=l("statusMessageTemplate",{type:e,message:a}),f=b(d);b("body").append(f),b("body").addClass("has-status-bar"),f.parent().foundation().trigger("open.fndtn.alert")}}function f(a,b,c){var d=c[a]||b[a];if(void 0===d)throw"File not found: '"+a+"'";return d}function g(a){var b=document.createEvent("Event");b.data=a.mode.v+":"+a.name,b.initEvent("SkfileOpen",!0,!0),document.dispatchEvent(b)}function h(a,b){var c=document.createEvent("Event");c.data=a.name+":"+b.v,c.initEvent("SkfileWrite",!0,!0),document.dispatchEvent(c)}function i(a){return a.replace(/[&<>]/g,function(a){return p[a]||a})}var j,k,l=a["import"]("utils.template"),m=a["import"]("python.sense-hat"),n=a["import"]("python.sense-stick"),o=function(a){a.html(j),function c(){0===b("#sense-hat-sensor-controls-container").width()?setTimeout(c,100):m.initSensors()}()},p={"&":"&amp;","<":"&lt;",">":"&gt;"},q="evaluationresult = ",r=/^\s*print\b/,s=/^\s*(from\s+\w+\s+)?import\b/,t=/(def|class|for|while|del)\b.*/,u=/^\s*$/,v=/[^!=<>]=[^=]/,w=/^\s*#/,x={},y=/^(turtle|pygal|processing|matplotlib\.pyplot|image|sense_hat)$/i,z={sense_hat:["image"],image:["sense_hat"]},A={turtle:function(a,b){"function"==typeof k&&k();var c=a.graphicsWidth(),d=a.graphicsHeight(),e=Math.min(c,d);return Sk.TurtleGraphics||(Sk.TurtleGraphics={}),Sk.TurtleGraphics.width=e,Sk.TurtleGraphics.height=e,Sk.TurtleGraphics.worldWidth=400,Sk.TurtleGraphics.worldHeight=400,Sk.TurtleGraphics.target=b[0],Sk.TurtleGraphics.assets=function(b){if(a.userAssets)for(var c=0;c<a.userAssets.length;c++)if(a.userAssets[c].name===b)return a.userAssets[c].url},b.data("graphicMode","turtle"),b.empty()},pygal:function(a,b){return"function"==typeof k&&k(),b.data("graphicMode","pygal"),b.empty()},image:function(a,b){return"function"==typeof k&&k(),Sk.canvas="graphic","undefined"!=typeof ImageMod&&(ImageMod.canvasLib=[]),Sk.imageProxy=function(b){if(!a.userAssets)return b;for(var c=0;c<a.userAssets.length;c++)if(a.userAssets[c].name===b)return a.userAssets[c].url;return b},b.empty()},processing:function(a,b){"function"==typeof k&&k();var d=Sk.canvas="processingCanvas";return c("/components/processing/processing.min.js"),b.data("graphicMode","processing"),b.html('<canvas style="display:none" id="'+d+'" width="400" height="400"></canvas>')},"matplotlib.pyplot":function(a,b){"function"==typeof k&&k();var c=Sk.canvas="matplotlibCanvas";return b.data("graphicMode","matplot"),b.html('<div id="'+c+'"></div>')},sense_hat:function(a,d){if(Sk.sense_hat||(Sk.sense_hat=a.sense_hat),Sk.sense_hat_emit||(Sk.sense_hat_emit=a.sense_hat_emit),j)0===b("#sense-hat-sensor-controls-container").length&&o(d);else{var e=trinketConfig.prefix("/partials/sense-hat.html");c(e,{dataType:"html",success:function(a){j=a,o(d)}})}n.initJoystick(),k=function(){m.destroySliders(),k=void 0}}},B={pygal:{path:trinketConfig.prefix("/components/pygal.js/__init__.js"),dependencies:[trinketConfig.prefix("/js/vendor/highcharts/highcharts.js"),trinketConfig.prefix("/js/vendor/highcharts/highcharts-more.js")]},numpy:{path:trinketConfig.prefix("/components/skulpt_numpy/dist/numpy/__init__.js")},"numpy.random":{path:trinketConfig.prefix("/components/skulpt_numpy/dist/numpy/random/__init__.js")},matplotlib:{path:trinketConfig.prefix("/components/skulpt_matplotlib/matplotlib/__init__.js")},"matplotlib.pyplot":{path:trinketConfig.prefix("/components/skulpt_matplotlib/matplotlib/pyplot/__init__.js"),dependencies:[trinketConfig.prefix("/components/d3/d3.min.js")]},json:{path:trinketConfig.prefix("/components/json.sk/__init__.js"),dependencies:[trinketConfig.prefix("/components/json.sk/stringify.js")]},xml:{path:trinketConfig.prefix("/components/xml.sk/__init__.js")},"xml.etree":{path:trinketConfig.prefix("/components/xml.sk/etree/__init__.js")},"xml.etree.ElementTree":{path:trinketConfig.prefix("/components/xml.sk/etree/ElementTree.js")},itertools:{path:trinketConfig.prefix("/js/skulpt/itertools.js")},os:{path:trinketConfig.prefix("/js/skulpt/os.js")},"trinket.checks":{path:trinketConfig.prefix("/js/skulpt/trinket/checks.js")},"trinket.tester":{path:trinketConfig.prefix("/js/skulpt/trinket/tester/__init__.py")},"trinket.ast":{path:trinketConfig.prefix("/js/skulpt/trinket/ast/__init__.py")},_ast:{path:trinketConfig.prefix("/js/skulpt/trinket/ast/_ast.js")},trinket:{path:trinketConfig.prefix("/js/skulpt/trinket/__init__.js")}};a["export"]("Skulpt",function(a){var c={evalMode:"main",allowGraphics:!0,autoEscape:!1,read:f,write:d,error:e,graphicsSetup:A,includeFileInErrors:!1,graphicsWidth:function(){return b(a.graphicsTarget()).parent().width()},graphicsHeight:function(){return b(a.graphicsTarget()).parent().height()},externalLibraries:B};a=b.extend({},c,a),a.allowGraphics&&(a.graphicsSetup=b.extend({},A,a.graphicsSetup),a.graphicsTarget=a.graphicsTarget||function(){return b("#graphic")});var j,k=function(b){a.autoEscape&&(b=i(b)),a.write(b)},l="__abort_code__",m=function(b,c,d,e,f,g){var h={complete:!1};"repl"!==a.evalMode&&Sk.TurtleGraphics&&Sk.TurtleGraphics.reset&&Sk.TurtleGraphics.reset();return Sk.misceval.asyncToPromise(function(){return Sk.importMainWithBody(a.evalMode,!1,b,!0)},{"*":function(){if(window.Sk_interrupt===!0)throw new Error("interrupt");return null}}).then(function(a){h.complete=!0,e&&"function"==typeof e&&e(),Sk.sense_hat&&Sk.sense_hat.sensestick.destroy()},function(a){return a===l?void(g&&"function"==typeof g&&g()):(h.complete=!0,f(a),void(Sk.sense_hat&&Sk.sense_hat.sensestick.destroy()))}),h};return function(c,d,e,f){var l,n,o,p;if(j&&!j.complete&&(j.stop=!0),!c||/^\s*$/.test(c))return d();var x={print_function:!1,division:!0,absolute_import:null,unicode_literals:!0,set_repr:!0,class_repr:!0,inherit_from_object:!0},A={print_function:!1,division:!1,absolute_import:null,unicode_literals:!1,set_repr:!1,class_repr:!1,inherit_from_object:!1},B={print_function:!0,division:!0,absolute_import:null,unicode_literals:!0,set_repr:!0,class_repr:!0,inherit_from_object:!0},C=c.match(/^\s*#!.*?python(\d)/i),D=c.match(/^\s*#\s*python\s*[=:]?\s*(\d)/i);D?Sk.__future__="2"===D[1]?A:x:C?Sk.__future__="3"===C[1]?B:A:Sk.__future__=x;var E=function(b){var c,d=i(b.toString());if(b.traceback&&b.traceback.length){for(c=0;c<b.traceback.length;c++)"undefined"!=typeof a.userFiles[b.traceback[c].filename]&&(b.filename=b.traceback[c].filename,b.lineno=b.traceback[c].lineno);"undefined"==typeof b.filename&&(b.filename=b.traceback[b.traceback.length-1].filename,b.lineno=b.traceback[b.traceback.length-1].lineno)}if(a.includeFileInErrors&&b.filename&&(d=d.replace(/on line \d+/,"on line "+b.lineno),d=d+" in "+b.filename.replace(/^\.\//,"")),/^ImportError: No module named/.test(d)&&(d+=". You can find a list of available modules at <a href='/docs/python' class='text-link' target='_blank'>docs/python</a>."),"repl"===a.evalMode){d+="\n";var f=-1;-1!==(f=b.toString().indexOf("on line"))&&(f=parseInt(b.toString().substr(f+8),10));var g=0;d+=n?"1>: "+o[0].substr(q.length):o.map(function(a){return++g+(f===g?">":" ")+": "+a}).join("\n")}a.error(d,b),e&&"function"==typeof e&&e(d,b)};if(Sk.configure({inputfun:a.inputfun,__future__:Sk.__future__,retainglobals:"repl"===a.evalMode,output:k,read:function(b){return a.read(b,Sk.builtinFiles.files||{},a.userFiles||{})},write:function(){},nonreadopen:!0,fileopen:g,filewrite:h,imageProxy:a.imageProxy||"",uncaughtException:E,signals:!0,killableWhile:"midori"!==Detectizr.browser.name&&"iceweasel"!==Detectizr.browser.name&&"epiphany"!==Detectizr.browser.name}),Sk.externalLibraries=a.externalLibraries,a.allowGraphics&&(Sk.availableWidth=a.graphicsWidth(),Sk.availableHeight=a.graphicsHeight()),Sk.domOutput=function(c){return b(a.graphicsTarget()).append(c).children().last()},Sk.onBeforeImport=function(c){if(y.test(c)){if(!a.allowGraphics)return"Graphics libraries are not allowed";if(l){if(l!==c&&(!z[l]||z[l].indexOf(c)<0))return"You may only use a single graphics library at a time and the "+l+" library is already in use."}else"function"==typeof a.onGraphicsInit&&a.onGraphicsInit(),a.graphicsSetup[c](a,b(a.graphicsTarget())),l=c}return a.onBeforeImport?a.onBeforeImport(c):void 0},a.onAfterImport&&(Sk.onAfterImport=a.onAfterImport),"repl"===a.evalMode){if(o=c.split("\n").filter(function(a){return!u.test(a)}),n=1===o.length||/"""/.test(o[0])&&/"""/.test(o[o.length-1]),n&&!v.test(o[0])&&!t.test(o[0])&&!s.test(o[0])&&o[0].length>0&&(r.test(o[0])||w.test(o[0])||(o.unshift(q+o.shift()),o.push("if not evaluationresult == None: print evaluationresult"))),o=o.filter(function(a){return!u.test(a)}),0===o.length)return;c=o.join("\n")}return j=m(c,n,o,d,E,f),!p}})}(window.TrinketIO,window.jQuery),function(a){function b(a){this._pollInterval=void 0,this._analytics=a,this._events={},$(window).on("blur",$.proxy(this.poll,this))}b.POLL_INTERVAL=3e4,b.prototype.poll=function(){if(this._pollInterval){for(var a in this._events)this._events[a]&&this._analytics(a,this._events[a]),this._events[a]=0;clearTimeout(this._pollInterval),this._pollInterval=void 0}},b.prototype.logEvent=function(a){var c=this;c._events[a]=(c._events[a]||0)+1,this._pollInterval||(this._pollInterval=setTimeout($.proxy(this.poll,this),b.POLL_INTERVAL))},a["export"]("embed.analytics.activity",b)}(window.TrinketIO),function(a,b){function c(a){var b=a.toString().match(/^(.*?)[:;]\s*(.*?)(?:on\sline\s(\d+).*)?$/i);return b&&b[1]&&b[2]?{error:b[0],type:b[1],message:b[2],line:b[3]?parseInt(b[3]):-1}:!1}function d(){M||(M=!0,$("#console-wrap").removeClass("hide"),N?e():$("#console-wrap").css("height","100%"),C=$("#console-output").jqconsole(),C.Write('Powered by <img src="'+trinketConfig.prefix("/img/trinket-logo.png")+'">\n',"jqconsole-header",!1))}function e(){if($("#output-dragbar").hasClass("hide")){$("#output-dragbar").removeClass("hide");var a=$("#outputTabs").height(),b=$(".trinket-content-wrapper").height()-a,c=$("#output-dragbar").height(),d=.8*b-c/2,e=b-d-c/2;$("#graphic-wrap").css("height",d),$("#console-wrap").css("height",e)}}function f(){$("#unittest-wrap").removeClass("hide").css("height","100%")}function g(a){switch(a){case"turtle":I=!0,"run"===A&&i(!0);break;case"urllib.request":if($("#proxy").val()){var c={},d=Sk.sysmodules.mp$subscript(a);d.$d.urlopen.func_code=function(a,b,e){if(void 0===c[a.v]){var f=$("#proxy").val()+"?url="+encodeURIComponent(a.v),g=new XMLHttpRequest;g.open("GET",f,!1),g.send(null),c[a.v]=g.responseText}return Sk.misceval.callsim(d.$d.Response,{responseText:c[a.v]})}}break;case"sense_hat":b.runtime("usingSenseHat",!0),U.addSrc()}"function"==typeof v.afterImport&&v.afterImport(a)}function h(){return y||(y=$('<div class="turtle-overlay hide" data-action="graphic.focus" data-interface="output"></div>'),y.insertAfter("#graphic"),y.on("click",function(){
i(!0)})),y}function i(a){return I?(void 0!==a&&(a=!!a,a?(h().addClass("hide"),$("#graphic").focus(),$(document).on("keydown.turtle-focus",function(a){a.preventDefault()}),v.sendInterfaceAnalytics(h()),$(document).on("mousedown.turtle-focus",function(a){$("#graphic-wrap").is(":hover")||i(!1)})):($(document).off("keydown.turtle-focus"),$(document).off("mousedown.turtle-focus"),h().removeClass("hide"))),Sk.TurtleGraphics.focus(a)):void 0}function j(a){w.clearTabMarkers(),C&&(C.Write("[0m"),C.Reset(),C.Write('Powered by <img src="'+trinketConfig.prefix("/img/trinket-logo.png")+'">\n',"jqconsole-header",!1)),a||b.runtime("usingSenseHat")||($("#graphic").empty(),$("#graphic").removeData("graphicMode"))}function k(){var a=w.assets();$("#imageAssets").empty(),ea=a.length,fa=0,ea&&(da=!0),a.forEach(function(a){var b=/^data:image/.test(a.url)?a.url:l(a.url),c=new Image;c.id=a.name,c.className="hide",c.onload=function(){$("#imageAssets").append(c),fa++,fa>=ea&&(da=!1)},c.src=b})}function l(a){var b=$("#proxy").val(),c=new RegExp(b+"/","g");return a=a.replace(c,""),a=b+"/"+a}function m(a,b){var c,d,e;for(d in O)delete O[d];$(".hidden-file").remove();for(d in a)d===b?c=a[d]:(d.match(/\.py$/)&&(O["./"+d]=a[d]+"\n"),$("#"+d).length||(e=$("<textarea>",{id:d,text:a[d]+"\n",name:d,"class":"hide hidden-file"}),$("body").append(e)));return P.length=0,P.push.apply(P,w.assets()),$("#proxy").val()&&P.forEach(function(a){/^data:image/.test(a.url)||(a.url=l(a.url))}),c}function n(){$(".reveal-modal").foundation("reveal","close"),null==G&&(G=J(ca));var a,b=($("#graphic"),v.getValue());a=m(w.getAllFiles(),R),$("#statusMessages").children().length&&$("#statusMessages").trigger("close.fndtn.alert").remove(),"function"==typeof v.beforeRun&&(a=v.beforeRun(a)),I=!1,h().addClass("hide");var c=document.activeElement;G(a,function(){B=!1,K=void 0,"function"==typeof v.afterRun&&v.afterRun(a),v.collectErrorData(b)},function(c){B=!0,K=void 0,"function"==typeof v.afterRun&&v.afterRun(a),v.collectErrorData(b,c);var d=/on line (\d+) in (.+)$/,e=c.match(d);e&&v.highlightLine(e[2],e[1])},function(){}),I?$("#graphic").focus():K||c!==document.activeElement||("none"!=$("#editor").css("display")?v.focus():w.options.noEditor||$("#honeypot").focus()),v.updateMetric("runs",b),!H[b]&&v.isModified()&&v.sendAnalytics("Interaction",{action:"Modify",label:"Code"}),v.markCodeAsRun(b)}function o(){if($(".reveal-modal").foundation("reveal","close"),D="run",W)p(),setTimeout(o,250);else if(da)setTimeout(o,500);else{null==E&&(E=J(aa)),a.Sk_interrupt=!1;var c,d=v.getValue();c=m(w.getAllFiles(),Q),j(),$("#console-output").removeClass("console-mode"),$("#statusMessages").children().length&&$("#statusMessages").trigger("close.fndtn.alert").remove(),"function"==typeof v.beforeRun&&(c=v.beforeRun(c)),I=!1,h().addClass("hide");var e=b.runtime("usingSenseHat");b.runtime("usingSenseHat",!1),b.runtime("downloadExtra",void 0);var f=document.activeElement;W=!0;var g=setTimeout(function(){W&&b.runtime("usingSenseHat")&&v.changeRunOption("stop")},500);E(c,function(){B=!1,K=void 0,"function"==typeof v.afterRun&&v.afterRun(c),v.collectErrorData(d),q(g)},function(a){if(B=!0,K=void 0,"function"==typeof v.afterRun&&v.afterRun(c),!/KeyboardInterrupt/.test(a)){v.collectErrorData(d,a);var f=/on line (\d+) in (\S+)/,h=a.match(f);if(h){var i=h[2].replace(/\.$/,"");v.highlightLine(i,h[1])}}b.runtime("usingSenseHat",e),q(g)},function(){b.runtime("usingSenseHat",e),q(g)}),I?$("#graphic").focus():b.runtime("usingSenseHat")?U.focus(!0):K||f!==document.activeElement||("none"!=$("#editor").css("display")?v.focus():w.options.noEditor||$("#honeypot").focus()),v.updateMetric("runs",d),!H[d]&&v.isModified()&&v.sendAnalytics("Interaction",{action:"Modify",label:"Code"}),v.markCodeAsRun(d)}}function p(){a.Sk_interrupt=!0,X(0),a.sense_hat.sensestick.triggerKeyboardInterrupt()}function q(a){a&&clearTimeout(a),W=!1,v.changeRunOption(D)}function r(){if($(".reveal-modal").foundation("reveal","close"),D="console",W)p(),setTimeout(r,250);else if(da)setTimeout(r,500);else{Sk.globals&&(Sk.globals={__name__:Sk.globals.__name__}),d(),$("#console-output").addClass("console-mode"),null==F&&(F=J(ba));var a,b=($("#graphic"),v.getValue(),[]);a=m(w.getAllFiles(),Q),j(),$("#statusMessages").children().length&&$("#statusMessages").trigger("close.fndtn.alert").remove(),"function"==typeof v.beforeRun&&(a=v.beforeRun(a)),a&&(b=a.split("\n")),I=!1,h().addClass("hide"),s({history:b})}}function s(c){var d=!1;C.Prompt(!0,function(d){if(/^\s*$/.test(d))s(c);else{a.Sk_interrupt=!1,W=!0;var e=setTimeout(function(){W&&b.runtime("usingSenseHat")&&v.changeRunOption("stop")},500);F(d,function(){s(c),q(e)},function(a,d){b.runtime("usingSenseHat")&&/interrupt/i.test(d.toString())||C.Write(u(d.toString()),"jqconsole-error",!1),s(c),q(e)},function(){q(e)}),v.sendAnalytics("Interaction",{action:"Modify",label:"Code"})}},function(a){var b,c,e;return e=a.split("\n"),0===e.length?0:(c=e[e.length-1],b=c.match(/^\s*/)[0],c=e[e.length-1].replace(/\s+$/,""),/"""/.test(c)&&!/""".*"""/.test(c)&&(d=!d),C._enteringHistory?b.length?-b.length:0:d?0:/^\s*#/.test(c)||":"!==c[c.length-1]?b.length&&c&&0!==c[c.length-1].length?0:/^\s*#/.test(c)?0:!1:1)}),C.Focus(),t(c.history)}function t(a){var b,c,d,e;if(a.length)for(C._enteringHistory=!0;a.length;){for(b=a.shift(),c=b.split(""),d=0;d<c.length;d++)e=$.Event("keypress"),e.which=c[d].charCodeAt(0),C.$input_source.trigger(e);a.length||(C._enteringHistory=!1),e=$.Event("keydown"),e.which="\r".charCodeAt(0),C.$input_source.trigger(e)}}function u(a){var b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return a.replace(/[&<>"']/g,function(a){return b[a]})}var v,w,x,y,z,A,B,C,D,E,F,G,H={},I=!1,J=b["import"]("Skulpt"),K=void 0,L=!1,M=!1,N=!1,O={},P=[],Q="main.py",R="tests.py",S=b["import"]("utils.guid"),T=b["import"]("utils.template"),U=b["import"]("python.sense-hat"),V=b["import"]("embed.analytics.activity"),W=!1,X=b["import"]("sendSignalToSkulpt"),Y=function(a){d(),a=a.replace(/\0(33)\[/g,"["),C.Write(a)},Z=function(a){return d(),new Promise(function(b,c){var d=document.activeElement;C.Write(a),$("#console-output").addClass("console-active"),C.Input(function(a){$("#console-output").removeClass("console-active"),v.activityLog&&v.activityLog.logEvent("Text Input"),b(a),d&&$(d).focus()}),K||C.Focus()})},_=function(){N||(N=!0,$("#graphic-wrap").removeClass("hide"),M?e():$("#graphic-wrap").css("height","100%"))},aa={evalMode:"main",onAfterImport:g,userFiles:O,userAssets:P,includeFileInErrors:!0,imageProxy:$("#proxy").val(),write:Y,inputfun:Z,onGraphicsInit:_,sense_hat:a.sense_hat,sense_hat_emit:U.sense_hat_emit},ba={evalMode:"repl",onAfterImport:g,userFiles:O,userAssets:P,includeFileInErrors:!1,imageProxy:$("#proxy").val(),write:Y,inputfun:Z,onGraphicsInit:_,sense_hat:a.sense_hat,sense_hat_emit:U.sense_hat_emit,error:function(a,b){}},ca={evalMode:"tests",userFiles:O,userAssets:P,includeFileInErrors:!0,write:function(a){f()},inputfun:function(a){return f(),new Promise(function(a,b){a()})}},da=!1,ea=0,fa=0;!function(){var a=/^(input|text|password|file|email|search|date)$/i;$(document).bind("keydown",function(b){var c,d=!0;8===b.keyCode&&(c=b.srcElement||b.target,("textarea"===c.tagName.toLowerCase()||"input"===c.tagName.toLowerCase()&&c.type.match(a))&&(d=c.readOnly||c.disabled),d&&b.preventDefault())})}(),a.TrinketAPI={initialize:function(c){v=this,z=$("#start-value").val(),A=$("#runOption-value").val(),v.runMode=$("#runMode-value").val(),K="result"===z&&!$("body").hasClass("has-status-bar"),w=$("#editor").codeEditor({showTabs:!this._queryString.outputOnly,noEditor:!!this._queryString.outputOnly,mainFileName:Q,showInfo:!0,assets:c.assets?c.assets.slice():[],guest:"guest"===v.getUIType(),owner:"owner"===v.getUIType(),canHideTabs:v.hasPermission("hide-trinket-files"),lang:"python",onFocus:function(){i(!1)},assetsHowTo:"#assets-howto-message"}).data("trinket-codeEditor");var d={trinketIdentifier:v.getTrinketIdentifierOrNull(),userIdentifier:v.getUserId()};a.trinketBroadcast&&a.trinketBroadcast.connection&&a.trinketBroadcast.connection.initialize(w,d),k();var e=v.save;v.save=function(a,b){e.call(v,a,function(a,c){"function"==typeof b&&b(a,c)})},$(document).on("sk.system.clear",function(){j(!0)}),$("#reset-output").click(function(){j(!0)}),$(document).on("assets.change",function(){k(),v.triggerChange()}),$(document).on("open.fndtn.alert",function(){w.resize()}),$(document).on("close.fndtn.alert",function(){w.resize(),b.runtime("usingSenseHat")&&U.updateSliders()}),w.addCommand("run",{win:"Ctrl-Enter",mac:"Command-Enter"},function(a){$("#editor").trigger("trinket.code.run",{action:"code.run"})}),w.addCommand("test",{win:"Shift-Ctrl-Enter",mac:"Shift-Command-Enter"},function(a){$("#editor").trigger("trinket.code.check",{action:"code.check"})});try{x=b["import"]("python.editor.hints"),AutoCompletePlugin=b["import"]("python.editor.autocomplete"),v._queryString&&v._queryString.inLibrary&&AutoCompletePlugin.setInLibrary(!0),w.registerPlugin(x),w.registerPlugin(AutoCompletePlugin)}catch(f){}this._errorGroup=0,this._sessionId=S(),this._previousError=void 0,$(document).on("trinket.code.edit",$.proxy(this.showCode,this)),$(document).on("trinket.code.run",$.proxy(this.showResult,this)),$(document).on("trinket.code.stop",$.proxy(this.stopExecution,this)),$(document).on("trinket.code.check",$.proxy(this.showTestResult,this)),$(document).on("trinket.code.console",$.proxy(this.consoleResult,this)),$(document).on("trinket.output.view",$.proxy(v.showOutput,v)),$(document).on("trinket.instructions.view",$.proxy(v.showInstructions,v)),this.viewer="#codeOutput",$(document).on("trinket.code.modules",$.proxy(this.toggleModules,this)),$("#honeypot").on("keydown",$.proxy(this.showCode,this)),$("#menu").on("trinket.sharing.share trinket.sharing.embed trinket.sharing.email",function(a){v.isModified()&&!H[v.getValue()]&&($("#runFirstModal").foundation("reveal","open"),a.preventDefault())}),$('.menu-toolbar .menu-button[data-action="code.run"]').on("mousedown",function(a){w&&w.isFocused()&&a.preventDefault()}),$('.menu-toolbar .menu-button[data-action="code.check"]').on("mousedown",function(a){w&&w.isFocused()&&a.preventDefault()}),$("#modalRun").click(function(){sendInterfaceAnalytics(this),$("#runFirstModal").foundation("reveal","close"),o()}),c.settings&&c.settings.testsEnabled&&$(".check-it").hasClass("hide")&&$(".check-it").removeClass("hide"),v.reset(c,!0),w.change(function(){v.triggerChange()}),v.draggable(function(){b.runtime("usingSenseHat")&&U.updateSliders()}),$("#output-dragbar").mousedown(function(a){a.preventDefault();var b=$("#outputTabs").height(),c=$(".trinket-content-wrapper").height()-b,d=$(".trinket-content-wrapper").offset().top+b,e=$("#output-dragbar").height();$(document).on("mousemove.output-dragbar",function(a){var b=a.pageY-d-e/2,f=c-b-e/2;b>=20&&f>=20&&($("#graphic-wrap").css("height",b),$("#console-wrap").css("height",f))}),$(document).on("mouseup.output-dragbar",function(a){$(document).off("mousemove.output-dragbar mouseup.output-dragbar")}),v.sendInterfaceAnalytics(this)}),v.activityLog=new V(function(a,b){var c=a.replace(/[a-zA-Z0-9](?:[^\s\-\._]*)/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1)});v.sendAnalytics("Output",{action:c,label:v.getTrinketIdentifier(),value:b})}),$(document).keydown(function(a){var b=$("#graphic").data("graphicMode");/turtle/i.test(b)&&$(".turtle-overlay").hasClass("hide")&&v.activityLog.logEvent(b+" Key")}),$(document).on("mousedown","#graphic-wrap",function(){var a=$("#graphic").data("graphicMode");a?v.activityLog.logEvent(a+" Click"):v.activityLog.logEvent("Output Click")})},collectErrorData:function(b,d){var e,f,g=d&&c(d),h=this._previousError;h&&(h.attempt+=1,f=a.JsDiff.createPatch("attempt"+h.attempt,h.code,b),e={session:this._sessionId,error:h.error,group:h.group,type:h.type,message:h.message,line:h.line,code:h.code,elapsed:Date.now()-h.time,totalElapsed:Date.now()-h.firstTime,delta:f.substr(f.indexOf("@")),attempt:h.attempt},g&&(e.introduced=g.error),g&&h.message===g.message?(e.state="repeated",this.logError(e),h.time=Date.now(),g=void 0):(e.state="resolved",this.logError(e),g||(this._previousError=void 0))),g&&(g.group=++this._errorGroup,g.code=b,g.time=g.firstTime=Date.now(),g.attempt=0,this.logError({state:"encountered",session:this._sessionId,group:g.group,error:g.error,type:g.type,message:g.message,line:g.line,attempt:g.attempt,code:b}),this._previousError=g)},highlightLine:function(a,b){w.highlight(a,b)},getTour:function(){var a=this.getUIType(),b=[];return"owner"!==a&&("none"!==$(".mode-toolbar .show-for-small-only").css("display")?($("#editor").hasClass("hide")||b.push({el:".run-it",event:"code.run"}),b.push({el:".edit-it",event:"code.edit"},{el:".ace_content",event:"code.change"},{el:".run-it",event:"code.run"})):"result"!==$("#start-value").val()&&this._trinket.code?b.push([{el:".run-it",event:"code.run"},{el:".ace_content",event:"code.change"}]):b.push({el:".ace_content",event:"code.change"},{el:".run-it",event:"code.run"}),b.push({el:".left-menu-toggle",event:"menu.options"},{el:".share-it",event:"sharing.share"}),"guest"===a&&b.push({el:".right-menu-toggle",event:"menu.user"}),b.push({el:".save-it",event:"library.add"})),b},getEditor:function(){return w},getType:function(){return"python"},getValue:function(){return w.serialize()},getMainFile:function(){return Q},isDirty:function(){if(!this._trinket)return!1;if(this.getValue()!==(this._original.code||""))return!0;var a=w.assets();return a.length!==(this._original.assets||[]).length?!0:JSON.stringify(a)!==JSON.stringify(this._original.assets)?!0:JSON.stringify(this._trinket.settings)!==JSON.stringify(this._original.settings)},getAnalyticsCategory:function(){return"Python"},serialize:function(){return{code:this.getValue(),consoleOutput:$("#console-output").text(),hasError:B,assets:w.assets().slice(),settings:this._trinket.settings}},showMessage:function(a,b){var c=T("statusMessageTemplate",{type:a,message:b}),d=$(c);$("body").addClass("has-status-bar").append(d),d.parent().foundation().trigger("open.fndtn.alert")},showCode:function(a){$("#codeOutput").addClass("hide"),$("#editor").removeClass("hide"),v.closeOverlay("#modules"),v.focus(),i(!1)},showResult:function(a){"run"!==A&&a&&"run"===$(a.target).data("button")&&v.changeRunOption("run"),v.runMode="",v.triggerRunModeChange(),$("#codeOutput").removeClass("hide"),$("#editor").addClass("hide"),$("#unittest-wrap").addClass("hide"),v.closeOverlay("#modules"),$("#instructionsContainer").addClass("hide"),$("#outputContainer").removeClass("hide"),$("#codeOutputTab").addClass("active"),$("#instructionsTab").removeClass("active"),o(),a&&v.sendAnalytics("Interaction",{action:"Click",label:"Run"})},stopExecution:function(a){p()},showTestResult:function(a){$("#codeOutput").removeClass("hide"),$("#editor").addClass("hide"),$("#console-wrap").addClass("hide"),M=!1,$("#graphic-wrap").addClass("hide"),N=!1,$("#unittest-wrap").removeClass("hide"),$("#output-dragbar").addClass("hide"),$("#instructionsContainer").addClass("hide"),$("#outputContainer").removeClass("hide"),v.closeOverlay("#modules"),n(),a&&v.sendAnalytics("Interaction",{action:"Click",label:"Check"})},consoleResult:function(a){"console"!==A&&a&&"console"===$(a.target).data("button")&&v.changeRunOption("console"),v.runMode="console",v.triggerRunModeChange(),$("#codeOutput").removeClass("hide"),$("#editor").addClass("hide"),$("#unittest-wrap").addClass("hide"),v.closeOverlay("#modules"),$("#instructionsContainer").addClass("hide"),$("#outputContainer").removeClass("hide"),$("#codeOutputTab").addClass("active"),$("#instructionsTab").removeClass("active"),r(),a&&v.sendAnalytics("Interaction",{action:"Click",label:"Console"})},toggleModules:function(){L?v.toggleOverlay("#modules"):$.get("/api/docs/python",function(a){$("#modules").prepend(a),$(document).foundation(),v.toggleOverlay("#modules"),L=!0,v.sendAnalytics("Interaction",{action:"Click",label:"Documentation"})})},hideAll:function(){this.toggleModules()},onOpenOverlay:function(){$("#codeOutput").addClass("hide"),$("#editor").addClass("hide")},onCloseOverlay:function(){$("#codeOutput").removeClass("hide"),$("#editor").removeClass("hide"),v.focus(),i(!1)},reset:function(a,b){w.reset(a.code),w.assets(a.assets?a.assets.slice():[]),b||k(),"console"===A||"console"===v.runMode?this.consoleResult():a.code&&"result"===z&&K!==!1?this.showResult():(this.showCode(),j())},replaceMain:function(a,b){w.setValue(a.code),w.assets(a.assets?a.assets.slice():[]),b||k()},focus:function(){$("body").data("is-mobile")||w.focus(),i(!1)},markCodeAsRun:function(a){H[a]=!0},downloadable:function(){var a,c,d,e="owner"===this.getUIType();return this._trinket&&this._trinket._origin_id&&(a=this._trinket._origin_id),c=e&&!a?w.getAllFiles():w.getAllVisibleFiles(),d=w.assets(),b.runtime("usingSenseHat")||U.usingSenseHat(c)&&U.addSrc(),{files:c,assets:d}},toggleCheckButton:function(){$(".check-it").hasClass("hide")?$(".check-it").removeClass("hide"):$(".check-it").addClass("hide")},changeRunOption:function(a){var b={run:"fa fa-play",console:"fa fa-terminal",stop:"fa fa-stop"},c={run:"View the result.",console:"Run code interactively.",stop:"Stop program."},d={run:"Run",console:"Console",stop:"Stop"};$(".run-it").data("action","code."+a),$(".run-it").attr("title",c[a]),$(".run-it").find("label").text(d[a]),$(".run-it").find("i").removeClass().addClass(b[a]),A=a},saveClientSnapshot:function(){return b.runtime("usingSenseHat")},captureAndSaveSnapshot:function(b){var c=document.querySelector("svg"),d=document.createElement("div"),e=c.cloneNode(!0);$(e).css("transform","rotate(0deg)"),e.setAttribute("width",320),e.setAttribute("height",320),d.appendChild(e);var f='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">',g=f+d.innerHTML;g=encodeURIComponent(g),g=g.replace(/%([0-9A-F]{2})/g,function(a,b){var c=String.fromCharCode("0x"+b);return"%"===c?"%25":c}),g=decodeURIComponent(g);var h="data:image/svg+xml;base64,"+a.btoa(g),i=new Image;i.onload=function(){var a=document.createElement("canvas");a.width=320,a.height=320;var c=a.getContext("2d");c.drawImage(i,0,20,320,300,0,0,320,320);var d;document.createElement("a");try{d=a.toDataURL("image/png")}catch(e){if("undefined"!=typeof SecurityError&&e instanceof SecurityError||"SecurityError"==e.name)return void console.error("Rendered SVG images cannot be downloaded in this browser.");throw e}b(d)},i.src=h},discardDraftSettings:function(){if(this._trinket.settings.testsEnabled!==this._predraft.settings.testsEnabled){var a=new MouseEvent("click",{bubbles:!0});try{$("#testsEnabled").data("skip-trigger",!0),$("#testsEnabled")[0].dispatchEvent(a)}catch(c){console.log("testsEnabled click err:",c)}}b.runtime("usingSenseHat")&&U.resetSensors(this._predraft.settings)}}}(window,window.TrinketIO);